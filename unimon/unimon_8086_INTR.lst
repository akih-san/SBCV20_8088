 AS V1.42 Beta [Bld 227] - Source File unimon_8086_INTR.asm - Page 1 - 1/10/2024 10:36:18


       1/       0 :                     	page 0
       2/       0 :                     ;;;
       3/       0 :                     ;;; Universal Monitor 8086
       4/       0 :                     ;;;   Copyright (C) 2020 Haruo Asano
       5/       0 :                     ;;;
       6/       0 :                     
       7/       0 :                     	CPU	8086
       8/       0 :                     
       9/       0 : ="8088"              TARGET:	EQU	"8088"
      10/       0 :                     
      11/       0 :                     ;;;
      12/       0 :                     ;;; Memory
      13/       0 :                     ;;;
      14/       0 :                     
      15/       0 : =0H                  ROMSEG:	EQU	00000H		; CSEG
      16/       0 : =8000H               ROM_B:	EQU	08000H
      17/       0 :                     
      18/       0 : =0H                  RAMSEG:	EQU	0000H		; DSEG & SSEG
      19/       0 :                     
      20/       0 : =400H                WORK_B:	EQU	400H	; unimon work area 400h - 500h
      21/       0 : =600H                STACK:	EQU	600H	; unimon stack area 600h - 680h
      22/       0 : =700H                U_STACK	EQU	STACK+100H	; 700H
      23/       0 : =18H                 BUFLEN:	EQU	24
      24/       0 : =100H                VECSIZ:	EQU	256		; Number of vectors to be initialized
      25/       0 :                     
      26/       0 : =84H                 int21vec:	equ	21H * 4 ; INT 21H Vector table offset
      27/       0 : =3FCH                intFFvec:	equ	0ffH *4 ; 8251 Vector table offset
      28/       0 :                     ;;;
      29/       0 :                     ;;; Options
      30/       0 :                     ;;;
      31/       0 :                     
      32/       0 : =1H                  USE_IDENT = 1			; CPU Identification
      33/       0 :                     	
      34/       0 :                     ;;;
      35/       0 :                     ;;; Intel 8251
      36/       0 :                     ;;;
      37/       0 :                     
      38/       0 : =0H                  USARTD:	EQU	00H
      39/       0 : =1H                  USARTC:	EQU	01H
      40/       0 :                     	
      41/       0 :                     ;;; Constants
      42/       0 : =0DH                 CR:	EQU	0DH
      43/       0 : =0AH                 LF:	EQU	0AH
      44/       0 : =8H                  BS:	EQU	08H
      45/       0 : =7FH                 DEL:	EQU	7FH
      46/       0 :                     
      47/       0 : =11H                 XON  	equ	11h		; code DC1
      48/       0 : =13H                 XOFF	equ	13h		; code DC3
      49/       0 : =0F0H                BUFSIZ	equ	240
      50/       0 : =30H                 FULSIZ	equ	BUFSIZ-192	;Buffer almost full
      51/       0 : =0AH                 RBLOW	equ	10
      52/       0 :                     
      53/       0 : =10H                 F_bitSize	equ	16
      54/       0 : =0FD5H               f_msk_bit	equ	0000111111010101b
      55/       0 :                     
      56/       0 : =100H                Tbit_ON_	equ	0000000100000000b
      57/       0 : =0ED5H               Tbit_OFF	equ	0000111011010101b
      58/       0 :                     
      59/       0 : =200H                INIT_FL_	equ	0000001000000000b		; init user FL value
      60/       0 : =0DD5H               IBIT_OFF	equ	0000110111010101b
      61/       0 :                     
      62/       0 :                     	ASSUME	CS:CODE, DS:DATA, SS:DATA, ES:NOTHING
      63/       0 :                     
      64/       0 :                     ;;;
      65/       0 :                     ;;; ROM area
      66/       0 :                     ;;;
      67/       0 :                     
      68/       0 :                     	SEGMENT	CODE
      69/       0 :                     	
      70/    8000 :                     	ORG	ROM_B
      71/    8000 :                     
      72/    8000 :                     CSTART:
      73/    8000 : B8 00 00            	MOV	AX,RAMSEG
      74/    8003 : 8E D8               	MOV	DS,AX
      75/    8005 : 8E D0               	MOV	SS,AX
      76/    8007 : BC 00 06            	MOV	SP,STACK
      77/    800A :                     
      78/    800A :                     	;; 
      79/    800A :                     	
      80/    800A : E8 8F 0A            	CALL	INIT
      81/    800D :                     
      82/    800D : B8 00 00            	MOV	AX,RAMSEG
      83/    8010 : A3 11 05            	MOV	[CURSEG],AX
      84/    8013 : =>TRUE               	IF RAMSEG = 0
      85/    8013 : B8 00 04            	MOV	AX,VECSIZ*4
      86/    8016 : =>FALSE              	ELSE
      87/    8016 :                     	XOR	AX,AX
      88/    8016 : [84]                 	ENDIF
      89/    8016 : A3 13 05            	MOV	[DSADDR],AX
      90/    8019 : A3 18 05            	MOV	[GADDR],AX
      91/    801C : A3 1A 05            	MOV	[SADDR],AX
      92/    801F : B0 49               	MOV	AL,'I'
      93/    8021 : A2 1C 05            	MOV	[HEXMOD],AL
      94/    8024 : 32 C0               	XOR	AL,AL
      95/    8026 : A2 1D 05            	MOV	[PSPEC],AL
      96/    8029 :                     
      97/    8029 :                     	; init break point
      98/    8029 : A2 3C 05            	mov	[bflg], al	; clear break flag
      99/    802C : 90                  	nop
     100/    802D :                     	;; Initialize register value
     101/    802D : 33 C0               	XOR	AX,AX
     102/    802F : BB 20 05            	MOV	BX,REG_B
     103/    8032 : B9 0E 00            	MOV	CX,(REG_E - REG_B)/2
     104/    8035 :                     IR0:
     105/    8035 : 89 07               	MOV	[BX],AX
     106/    8037 : 43                  	INC	BX
     107/    8038 : 43                  	INC	BX
     108/    8039 : 49                  	DEC	CX
     109/    803A : 75 F9               	JNE	IR0
     110/    803C :                     
     111/    803C : B8 00 00            	mov	ax, ROMSEG
     112/    803F : A3 34 05            	mov	[REGCS], ax
     113/    8042 :                     	; init break point segment
     114/    8042 : A3 3E 05            	mov	[brkcs], ax
     115/    8045 :                     
     116/    8045 : B8 00 07            	mov	ax, U_STACK
     117/    8048 : A3 32 05            	mov	[REGIP], ax
     118/    804B :                     	; init break point ip
     119/    804B : A3 40 05            	mov	[brkip], ax
     120/    804E :                     
     121/    804E : B8 00 00            	MOV	AX,RAMSEG
     122/    8051 : A3 36 05            	MOV	[REGDS],AX
     123/    8054 : A3 38 05            	MOV	[REGSS],AX
     124/    8057 : B8 00 07            	MOV	AX,U_STACK
     125/    805A : A3 2A 05            	MOV	[REGSP],AX
     126/    805D :                     
     127/    805D :                     	; init user FL : set interrupt (sti)
     128/    805D : B8 00 02            	mov	ax, INIT_FL_
     129/    8060 : A3 28 05            	mov	[REGF], ax
     130/    8063 :                     
     131/    8063 :                     	;; Initialize vector
     132/    8063 : 33 C0               	XOR	AX,AX
     133/    8065 : 8E C0               	MOV	ES,AX
     134/    8067 : BE 5D 88            	MOV	SI,INIVEC
     135/    806A : 8B F8               	MOV	DI,AX
     136/    806C : B9 00 02            	MOV	CX,VECSIZ*2
     137/    806F :                     INI0:	
     138/    806F : 2E 8B 04            	MOV	AX,CS:[SI]
     139/    8072 : 46                  	INC	SI
     140/    8073 : 46                  	INC	SI
     141/    8074 : 26 89 05            	MOV	ES:[DI],AX
     142/    8077 : 47                  	INC	DI
     143/    8078 : 47                  	INC	DI
     144/    8079 : 49                  	DEC	CX
     145/    807A : 74 1A               	JZ	INI2
     146/    807C : 81 FE 71 88         	CMP	SI,INIVECE
     147/    8080 : 75 ED               	JNZ	INI0
     148/    8082 : B8 E2 87            	MOV	AX,INTDMY
     149/    8085 : BB 00 00            	MOV	BX,ROMSEG
     150/    8088 :                     INI1:
     151/    8088 : 26 89 05            	MOV	ES:[DI],AX
     152/    808B : 47                  	INC	DI
     153/    808C : 47                  	INC	DI
     154/    808D : 26 89 1D            	MOV	ES:[DI],BX
     155/    8090 : 47                  	INC	DI
     156/    8091 : 47                  	INC	DI
     157/    8092 : 49                  	DEC	CX
     158/    8093 : 49                  	DEC	CX
     159/    8094 : 75 F2               	JNZ	INI1
     160/    8096 :                     INI2:
     161/    8096 :                     	; init INT 21H
     162/    8096 : BF 84 00            	mov	di, int21vec
     163/    8099 : B8 EE 86            	mov	ax, INTFNC
     164/    809C : 89 05               	mov	[di], ax
     165/    809E :                     
     166/    809E :                     	
     167/    809E :                     	; init INT FFH (8251 RXD)
     168/    809E :                     
     169/    809E : BF FC 03            	mov	di, intFFvec
     170/    80A1 : B8 53 8B            	mov	ax, intsr
     171/    80A4 : 89 05               	mov	[di], ax
     172/    80A6 :                     
     173/    80A6 : C6 06 01 04 30      	mov	byte ptr [tsh], FULSIZ
     174/    80AB : FB                  	sti	; enable interrupt
     175/    80AC :                     
     176/    80AC :                     	;; Opening message
     177/    80AC : BB E3 87            	MOV	BX,OPNMSG
     178/    80AF : E8 36 05            	CALL	MSGOUT
     179/    80B2 :                     
     180/    80B2 : =>TRUE               	IF USE_IDENT
     181/    80B2 :                     
     182/    80B2 : 9C                  	PUSHF			; Begin: (from Application Note 485)
     183/    80B3 : 58                  	POP	AX
     184/    80B4 : 8B C8               	MOV	CX,AX
     185/    80B6 : 25 FF 0F            	AND	AX,0FFFH
     186/    80B9 : 50                  	PUSH	AX
     187/    80BA : 9D                  	POPF
     188/    80BB : 9C                  	PUSHF
     189/    80BC : 58                  	POP	AX
     190/    80BD : 25 00 F0            	AND	AX,0F000H
     191/    80C0 : 3D 00 F0            	CMP	AX,0F000H
     192/    80C3 : 75 1D               	JNE	ID_286
     193/    80C5 :                     
     194/    80C5 : 54                  	PUSH	SP
     195/    80C6 : 5A                  	POP	DX
     196/    80C7 : 3B D4               	CMP	DX,SP
     197/    80C9 : 74 32               	JE	ID_UNK		; End:
     198/    80CB :                     
     199/    80CB : B8 00 01            	MOV	AX,0100H
     200/    80CE : D5 00               	DB	0D5H,00H	; AAD 00H
     201/    80D0 : 0A C0               	OR	AL,AL
     202/    80D2 : 75 07               	JNE	ID_V30
     203/    80D4 :                     	;; 8086/80186
     204/    80D4 : B0 11               	MOV	AL,11H
     205/    80D6 : BB 78 88            	MOV	BX,IM86
     206/    80D9 : EB 27               	JMP	IDE
     207/    80DB :                     ID_V30:
     208/    80DB :                     	;; V30
     209/    80DB : B0 14               	MOV	AL,14H
     210/    80DD : BB 92 88            	MOV	BX,IMV30
     211/    80E0 : EB 20               	JMP	IDE
     212/    80E2 :                     ID_286:
     213/    80E2 : 81 C9 00 F0         	OR	CX,0F000H	; Begin: (from Application Note 485)
     214/    80E6 : 51                  	PUSH	CX
     215/    80E7 : 9D                  	POPF
     216/    80E8 : 9C                  	PUSHF
     217/    80E9 : 58                  	POP	AX
     218/    80EA : 25 00 F0            	AND	AX,0F000H
     219/    80ED : 75 07               	JNE	ID_386		; End
     220/    80EF :                     	;; 80286
     221/    80EF : B0 31               	MOV	AL,31H
     222/    80F1 : BB 9C 88            	MOV	BX,IM286
     223/    80F4 : EB 0C               	JMP	IDE
     224/    80F6 :                     ID_386:
     225/    80F6 :                     	;; 80386
     226/    80F6 : B0 71               	MOV	AL,71H
     227/    80F8 : BB A4 88            	MOV	BX,IM386
     228/    80FB : EB 05               	JMP	IDE
     229/    80FD :                     	;; Unknown
     230/    80FD :                     ID_UNK:
     231/    80FD : 32 C0               	XOR	AL,AL
     232/    80FF : BB AC 88            	MOV	BX,IMUNK
     233/    8102 :                     IDE:
     234/    8102 : A2 1D 05            	MOV	[PSPEC],AL
     235/    8105 : 53                  	push	bx
     236/    8106 : BB 71 88            	mov	bx, cpum
     237/    8109 : E8 DC 04            	CALL	MSGOUT
     238/    810C : 5B                  	pop	bx
     239/    810D : E8 D8 04            	CALL	MSGOUT
     240/    8110 :                     	
     241/    8110 : [180]                	ENDIF
     242/    8110 :                     	
     243/    8110 :                     WSTART:
     244/    8110 : BB 16 88            	MOV	BX,PROMPT
     245/    8113 : E8 D2 04            	CALL	MSGOUT
     246/    8116 : E8 41 05            	CALL	GETLIN
     247/    8119 : BB F9 04            	MOV	BX,INBUF
     248/    811C : E8 8A 05            	CALL	SKIPSP
     249/    811F : E8 91 05            	CALL	UPPER
     250/    8122 : 22 C0               	AND	AL,AL
     251/    8124 : 74 EA               	JZ	WSTART
     252/    8126 :                     
     253/    8126 : 3C 44               	CMP	AL,'D'
     254/    8128 : 75 02               	JNE	M00
     255/    812A : EB 2B               	JMP	DUMP
     256/    812C :                     M00:	
     257/    812C : 3C 47               	CMP	AL,'G'
     258/    812E : 75 03               	JNE	M01
     259/    8130 : E9 3F 01            	JMP	GO
     260/    8133 :                     M01:
     261/    8133 : 3C 53               	CMP	AL,'S'
     262/    8135 : 75 03               	JNE	M02
     263/    8137 : E9 E8 01            	JMP	SETM
     264/    813A :                     
     265/    813A :                     M02:	
     266/    813A : 3C 4C               	CMP	AL,'L'
     267/    813C : 75 03               	JNE	M03
     268/    813E : E9 6B 02            	JMP	LOADH
     269/    8141 :                     M03:
     270/    8141 :                     
     271/    8141 : 3C 52               	CMP	AL,'R'
     272/    8143 : 75 03               	JNE	M05
     273/    8145 : E9 60 03            	JMP	REG
     274/    8148 :                     
     275/    8148 :                     M05:
     276/    8148 : 3C 54               	CMP	AL,'T'
     277/    814A : 75 03               	JNE	M06
     278/    814C : E9 34 04            	JMP	Trace
     279/    814F :                     
     280/    814F :                     M06:
     281/    814F :                     ERR:
     282/    814F : BB 33 88            	MOV	BX,ERRMSG
     283/    8152 : E8 93 04            	CALL	MSGOUT
     284/    8155 : EB B9               	JMP	WSTART
     285/    8157 :                     
     286/    8157 :                     ;;;
     287/    8157 :                     ;;; DUMP memory
     288/    8157 :                     ;;;
     289/    8157 :                     
     290/    8157 :                     DUMP:
     291/    8157 : 43                  	INC	BX
     292/    8158 : E8 63 05            	CALL	RDHEX
     293/    815B : 0A C9               	OR	CL,CL
     294/    815D : 75 15               	JNZ	DP0
     295/    815F :                     	;; No arg.
     296/    815F : E8 47 05            	CALL	SKIPSP
     297/    8162 : 0A C0               	OR	AL,AL
     298/    8164 : 75 E9               	JNZ	ERR
     299/    8166 :                     
     300/    8166 : 8B 16 13 05         	MOV	DX,[DSADDR]
     301/    816A : 81 C2 80 00         	ADD	DX,128
     302/    816E : 89 16 15 05         	MOV	[DEADDR],DX
     303/    8172 : EB 40               	JMP	DPM
     304/    8174 :                     
     305/    8174 :                     	;; 1st arg. found
     306/    8174 :                     DP0:
     307/    8174 : 8A 07               	MOV	AL,[BX]
     308/    8176 : 3C 3A               	CMP	AL,':'
     309/    8178 : 75 0C               	JNZ	DP01
     310/    817A : 89 16 11 05         	MOV	[CURSEG],DX
     311/    817E : 43                  	INC	BX
     312/    817F : E8 3C 05            	CALL	RDHEX
     313/    8182 : 0A C9               	OR	CL,CL
     314/    8184 : 74 C9               	JZ	ERR
     315/    8186 :                     DP01:	
     316/    8186 : 89 16 13 05         	MOV	[DSADDR],DX
     317/    818A : 8A 07               	MOV	AL,[BX]
     318/    818C : 3C 2C               	CMP	AL,','
     319/    818E : 74 0E               	JZ	DP1
     320/    8190 : 0A C0               	OR	AL,AL
     321/    8192 : 75 BB               	JNZ	ERR
     322/    8194 :                     	;; No 2nd arg.
     323/    8194 : 81 C2 80 00         	ADD	DX,128
     324/    8198 : 89 16 15 05         	MOV	[DEADDR],DX
     325/    819C : EB 16               	JMP	DPM
     326/    819E :                     DP1:
     327/    819E : 43                  	INC	BX
     328/    819F : E8 1C 05            	CALL	RDHEX
     329/    81A2 : E8 04 05            	CALL	SKIPSP
     330/    81A5 : 0A C9               	OR	CL,CL
     331/    81A7 : 74 A6               	JZ	ERR
     332/    81A9 : 8A 07               	MOV	AL,[BX]
     333/    81AB : 0A C0               	OR	AL,AL
     334/    81AD : 75 A0               	JNZ	ERR
     335/    81AF : 42                  	INC	DX
     336/    81B0 : 89 16 15 05         	MOV	[DEADDR],DX
     337/    81B4 :                     DPM:
     338/    81B4 :                     	;; DUMP main
     339/    81B4 : 8E 06 11 05         	MOV	ES,[CURSEG]
     340/    81B8 : 8B 36 13 05         	MOV	SI,[DSADDR]
     341/    81BC : 83 E6 F0            	AND	SI,0FFF0H
     342/    81BF : 32 C0               	XOR	AL,AL
     343/    81C1 : A2 17 05            	MOV	[DSTATE],AL
     344/    81C4 :                     DPM0:
     345/    81C4 : E8 21 00            	CALL	DPL
     346/    81C7 : E8 6F 09            	CALL	CONST
     347/    81CA : 75 12               	JNZ	DPM1
     348/    81CC : A0 17 05            	MOV	AL,[DSTATE]
     349/    81CF : 3C 02               	CMP	AL,2
     350/    81D1 : 72 F1               	JC	DPM0
     351/    81D3 : 8B 1E 15 05         	MOV	BX,[DEADDR]
     352/    81D7 : 89 1E 13 05         	MOV	[DSADDR],BX
     353/    81DB : E9 32 FF            	JMP	WSTART
     354/    81DE :                     DPM1:
     355/    81DE : 89 36 13 05         	MOV	[DSADDR],SI
     356/    81E2 : E8 F4 08            	CALL	CONIN
     357/    81E5 : E9 28 FF            	JMP	WSTART
     358/    81E8 :                     
     359/    81E8 :                     DPL:
     360/    81E8 :                     	;; DUMP	line
     361/    81E8 : A1 11 05            	MOV	AX,[CURSEG]
     362/    81EB : E8 15 04            	CALL	HEXOUT4
     363/    81EE : B0 3A               	MOV	AL,':'
     364/    81F0 : E8 4C 09            	CALL	CONOUT
     365/    81F3 : 8B C6               	MOV	AX,SI
     366/    81F5 : E8 0B 04            	CALL	HEXOUT4
     367/    81F8 : BB 3B 88            	MOV	BX,DSEP0
     368/    81FB : E8 EA 03            	CALL	MSGOUT
     369/    81FE : BF F9 04            	MOV	DI,INBUF
     370/    8201 : B9 10 00            	MOV	CX,16
     371/    8204 :                     DPL0:
     372/    8204 : E8 28 00            	CALL	DPB
     373/    8207 : E2 FB               	LOOP	DPL0
     374/    8209 :                     
     375/    8209 : BB 3E 88            	MOV	BX,DSEP1
     376/    820C : E8 D9 03            	CALL	MSGOUT
     377/    820F :                     
     378/    820F : BF F9 04            	MOV	DI,INBUF
     379/    8212 : B9 10 00            	MOV	CX,16
     380/    8215 :                     DPL1:
     381/    8215 : 8A 05               	MOV	AL,[DI]
     382/    8217 : 47                  	INC	DI
     383/    8218 : 3C 20               	CMP	AL,' '
     384/    821A : 72 09               	JC	DPL2
     385/    821C : 3C 7F               	CMP	AL,7FH
     386/    821E : 73 05               	JNC	DPL2
     387/    8220 : E8 1C 09            	CALL	CONOUT
     388/    8223 : EB 05               	JMP	DPL3
     389/    8225 :                     DPL2:
     390/    8225 : B0 2E               	MOV	AL,'.'
     391/    8227 : E8 15 09            	CALL	CONOUT
     392/    822A :                     DPL3:
     393/    822A : E2 E9               	LOOP	DPL1
     394/    822C : E9 21 04            	JMP	CRLF
     395/    822F :                     
     396/    822F :                     DPB:
     397/    822F :                     	;; DUMP byte
     398/    822F : B0 20               	MOV	AL,' '
     399/    8231 : E8 0B 09            	CALL	CONOUT
     400/    8234 : A0 17 05            	MOV	AL,[DSTATE]
     401/    8237 : 0A C0               	OR	AL,AL
     402/    8239 : 75 1A               	JNZ	DPB2
     403/    823B :                     	;; State 0
     404/    823B : 3B 36 13 05         	CMP	SI,[DSADDR]
     405/    823F : 74 0F               	JZ	DPB1
     406/    8241 :                     DPB0:
     407/    8241 :                     	;; Still 0 or 2
     408/    8241 : B0 20               	MOV	AL,' '
     409/    8243 : 88 05               	MOV	[DI],AL
     410/    8245 : E8 F7 08            	CALL	CONOUT
     411/    8248 : B0 20               	MOV	AL,' '
     412/    824A : E8 F2 08            	CALL	CONOUT
     413/    824D : 46                  	INC	SI
     414/    824E : 47                  	INC	DI
     415/    824F : C3                  	RET
     416/    8250 :                     DPB1:
     417/    8250 :                     	;; Found start address
     418/    8250 : B0 01               	MOV	AL,1
     419/    8252 : A2 17 05            	MOV	[DSTATE],AL
     420/    8255 :                     DPB2:
     421/    8255 : A0 17 05            	MOV	AL,[DSTATE]
     422/    8258 : 3C 01               	CMP	AL,1
     423/    825A : 75 E5               	JNZ	DPB0		; state 2
     424/    825C :                     	;; DUMP state 1
     425/    825C : 26 8A 04            	MOV	AL,ES:[SI]
     426/    825F : 88 05               	MOV	[DI],AL
     427/    8261 : E8 A6 03            	CALL	HEXOUT2
     428/    8264 : 46                  	INC	SI
     429/    8265 : 47                  	INC	DI
     430/    8266 :                     
     431/    8266 : 3B 36 15 05         	CMP	SI,[DEADDR]
     432/    826A : 75 05               	JNZ	DPB3
     433/    826C :                     	;; Found end address
     434/    826C : B0 02               	MOV	AL,2
     435/    826E : A2 17 05            	MOV	[DSTATE],AL
     436/    8271 :                     DPB3:
     437/    8271 : C3                  	RET
     438/    8272 :                     
     439/    8272 :                     ;;;
     440/    8272 :                     ;;; GO address
     441/    8272 :                     ;;; 
     442/    8272 :                     
     443/    8272 :                     GO:
     444/    8272 : 32 C0               	xor 	al, al
     445/    8274 : A2 3C 05            	mov	[bflg], al
     446/    8277 :                     
     447/    8277 : 43                  	INC	BX
     448/    8278 : E8 43 04            	CALL	RDHEX
     449/    827B : 0A C9               	OR	CL,CL
     450/    827D : 74 19               	JZ	G1
     451/    827F : 8A 07               	MOV	AL,[BX]
     452/    8281 : 3C 3A               	CMP	AL,':'
     453/    8283 : 75 0C               	JNE	G0
     454/    8285 :                     
     455/    8285 : 89 16 34 05         	MOV	[REGCS],DX
     456/    8289 : 43                  	INC	BX
     457/    828A : E8 31 04            	CALL	RDHEX
     458/    828D : 0A C9               	OR	CL,CL
     459/    828F : 74 19               	JZ	GE
     460/    8291 :                     G0:
     461/    8291 : 89 16 32 05         	MOV	[REGIP],DX
     462/    8295 : E8 11 04            	CALL	SKIPSP
     463/    8298 :                     G1:
     464/    8298 : 8A 07               	MOV	AL,[BX]
     465/    829A : 0A C0               	or	al, al
     466/    829C : 74 31               	je	go_go
     467/    829E :                     
     468/    829E : 3C 2C               	CMP	AL,','
     469/    82A0 : 75 08               	JNZ	GE
     470/    82A2 :                     
     471/    82A2 : 43                  	INC	BX
     472/    82A3 : E8 18 04            	CALL	RDHEX
     473/    82A6 : 0A C9               	OR	CL,CL
     474/    82A8 : 75 03               	jnz	g2
     475/    82AA :                     GE:
     476/    82AA : E9 A2 FE            	JMP	ERR
     477/    82AD :                     
     478/    82AD :                     g2:
     479/    82AD : 8A 07               	MOV	AL,[BX]
     480/    82AF : 3C 3A               	CMP	AL,':'
     481/    82B1 : 75 0C               	JNE	G0_0
     482/    82B3 :                     
     483/    82B3 : 89 16 3E 05         	MOV	[brkcs],DX
     484/    82B7 : 43                  	INC	BX
     485/    82B8 : E8 03 04            	CALL	RDHEX
     486/    82BB : 0A C9               	OR	CL,CL
     487/    82BD : 74 EB               	JZ	GE
     488/    82BF :                     
     489/    82BF :                     G0_0:
     490/    82BF : 89 16 40 05         	MOV	[brkip],DX
     491/    82C3 : E8 E3 03            	CALL	SKIPSP
     492/    82C6 : 0A C0               	OR	AL,AL
     493/    82C8 : 75 E0               	JNZ	GE
     494/    82CA :                     
     495/    82CA : B0 01               	mov	al, 1
     496/    82CC : A2 3C 05            	mov	[bflg], al
     497/    82CF :                     
     498/    82CF :                     go_go:
     499/    82CF : A0 3C 05            	mov	al, [bflg]
     500/    82D2 : 0A C0               	or	al, al
     501/    82D4 : 74 14               	je	go_anywhere
     502/    82D6 :                     
     503/    82D6 :                     ; set break point
     504/    82D6 :                     
     505/    82D6 : A1 3E 05            	mov	ax, [brkcs]
     506/    82D9 : 8E C0               	mov	es, ax
     507/    82DB : 8B 36 40 05         	mov	si, [brkip]
     508/    82DF : 26 8A 04            	mov	al, es:[si]	; get a code at break point
     509/    82E2 : A2 3D 05            	mov	[bp_code], al
     510/    82E5 : B0 CC               	mov	al, 0CCH	; int 03h code
     511/    82E7 : 26 88 04            	mov	es:[si], al	; set break point
     512/    82EA :                     
     513/    82EA :                     go_anywhere:
     514/    82EA : 8E 16 38 05         	MOV	SS,[REGSS]
     515/    82EE : 8B 26 2A 05         	MOV	SP,[REGSP]
     516/    82F2 :                     	
     517/    82F2 : A1 28 05            	MOV	AX,[REGF]
     518/    82F5 : 50                  	PUSH	AX
     519/    82F6 : A1 34 05            	MOV	AX,[REGCS]
     520/    82F9 : 50                  	PUSH	AX
     521/    82FA : A1 32 05            	MOV	AX,[REGIP]
     522/    82FD : 50                  	PUSH	AX
     523/    82FE :                     
     524/    82FE : A1 20 05            	MOV	AX,[REGAX]
     525/    8301 : 8B 1E 22 05         	MOV	BX,[REGBX]
     526/    8305 : 8B 0E 24 05         	MOV	CX,[REGCX]
     527/    8309 : 8B 16 26 05         	MOV	DX,[REGDX]
     528/    830D : 8B 2E 2C 05         	MOV	BP,[REGBP]
     529/    8311 : 8B 36 2E 05         	MOV	SI,[REGSI]
     530/    8315 : 8B 3E 30 05         	MOV	DI,[REGDI]
     531/    8319 : 8E 06 3A 05         	MOV	ES,[REGES]
     532/    831D : 8E 1E 36 05         	MOV	DS,[REGDS]
     533/    8321 : CF                  	IRET
     534/    8322 :                     
     535/    8322 :                     ;;;
     536/    8322 :                     ;;; SET memory
     537/    8322 :                     ;;;
     538/    8322 :                     
     539/    8322 :                     SETM:
     540/    8322 : 43                  	INC	BX
     541/    8323 : E8 98 03            	CALL	RDHEX
     542/    8326 : 0A C9               	OR	CL,CL
     543/    8328 : 74 1F               	JZ	SM1
     544/    832A : 8A 07               	MOV	AL,[BX]
     545/    832C : 3C 3A               	CMP	AL,':'
     546/    832E : 75 0C               	JNE	SM0
     547/    8330 : 89 16 11 05         	MOV	[CURSEG],DX
     548/    8334 : 43                  	INC	BX
     549/    8335 : E8 86 03            	CALL	RDHEX
     550/    8338 : 0A C9               	OR	CL,CL
     551/    833A : 74 6D               	JZ	SME
     552/    833C :                     SM0:
     553/    833C : 89 16 1A 05         	MOV	[SADDR],DX
     554/    8340 : E8 66 03            	CALL	SKIPSP
     555/    8343 : 8A 07               	MOV	AL,[BX]
     556/    8345 : 0A C0               	OR	AL,AL
     557/    8347 : 75 60               	JNZ	SME
     558/    8349 :                     SM1:
     559/    8349 : A1 11 05            	MOV	AX,[CURSEG]
     560/    834C : 8E C0               	MOV	ES,AX
     561/    834E : E8 B2 02            	CALL	HEXOUT4
     562/    8351 : B0 3A               	MOV	AL,':'
     563/    8353 : E8 E9 07            	CALL	CONOUT
     564/    8356 : 8B 36 1A 05         	MOV	SI,[SADDR]
     565/    835A : 8B C6               	MOV	AX,SI
     566/    835C : E8 A4 02            	CALL	HEXOUT4
     567/    835F : BB 3E 88            	MOV	BX,DSEP1
     568/    8362 : E8 83 02            	CALL	MSGOUT
     569/    8365 : 26 8A 04            	MOV	AL,ES:[SI]
     570/    8368 : E8 9F 02            	CALL	HEXOUT2
     571/    836B : B0 20               	MOV	AL,' '
     572/    836D : E8 CF 07            	CALL	CONOUT
     573/    8370 : E8 E7 02            	CALL	GETLIN
     574/    8373 : BB F9 04            	MOV	BX,INBUF
     575/    8376 : E8 30 03            	CALL	SKIPSP
     576/    8379 : 8A 07               	MOV	AL,[BX]
     577/    837B : 0A C0               	OR	AL,AL
     578/    837D : 75 07               	JNZ	SM2
     579/    837F :                     	;; Empty (Increment address)
     580/    837F : 46                  	INC	SI
     581/    8380 : 89 36 1A 05         	MOV	[SADDR],SI
     582/    8384 : EB C3               	JMP	SM1
     583/    8386 :                     SM2:
     584/    8386 : 3C 2D               	CMP	AL,'-'
     585/    8388 : 75 07               	JNZ	SM3
     586/    838A :                     	;; '-' (Decrement address)
     587/    838A : 4E                  	DEC	SI
     588/    838B : 89 36 1A 05         	MOV	[SADDR],SI
     589/    838F : EB B8               	JMP	SM1
     590/    8391 :                     SM3:
     591/    8391 : 3C 2E               	CMP	AL,'.'
     592/    8393 : 75 03               	JNZ	SM4
     593/    8395 :                     	;; '.' (Quit)
     594/    8395 : E9 78 FD            	JMP	WSTART
     595/    8398 :                     SM4:
     596/    8398 : E8 23 03            	CALL	RDHEX
     597/    839B : 0A C9               	OR	CL,CL
     598/    839D : 74 0A               	JZ	SME
     599/    839F : 26 88 14            	MOV	ES:[SI],DL
     600/    83A2 : 46                  	INC	SI
     601/    83A3 : 89 36 1A 05         	MOV	[SADDR],SI
     602/    83A7 : EB A0               	JMP	SM1
     603/    83A9 :                     SME:
     604/    83A9 : E9 A3 FD            	JMP	ERR
     605/    83AC :                     
     606/    83AC :                     ;;;
     607/    83AC :                     ;;; LOAD HEX file
     608/    83AC :                     ;;;
     609/    83AC :                     
     610/    83AC :                     LOADH:
     611/    83AC : 43                  	INC	BX
     612/    83AD : E8 0E 03            	CALL	RDHEX
     613/    83B0 : 0A C9               	OR	CL,CL
     614/    83B2 : 74 14               	JZ	LH0
     615/    83B4 : 8A 07               	MOV	AL,[BX]
     616/    83B6 : 3C 3A               	CMP	AL,':'
     617/    83B8 : 75 10               	JNE	LH1
     618/    83BA : 89 16 11 05         	MOV	[CURSEG],DX
     619/    83BE : 43                  	INC	BX
     620/    83BF : E8 FC 02            	CALL	RDHEX
     621/    83C2 : 0A C9               	OR	CL,CL
     622/    83C4 : 74 30               	JZ	LHE
     623/    83C6 : EB 02               	JMP	LH1
     624/    83C8 :                     LH0:
     625/    83C8 : 33 D2               	XOR	DX,DX
     626/    83CA :                     LH1:
     627/    83CA : 8A 07               	MOV	AL,[BX]
     628/    83CC : 0A C0               	OR	AL,AL
     629/    83CE : 75 26               	JNZ	LHE
     630/    83D0 : 8B F2               	MOV	SI,DX
     631/    83D2 : 8E 06 11 05         	MOV	ES,[CURSEG]
     632/    83D6 :                     
     633/    83D6 :                     LH2:	
     634/    83D6 : B0 2E               	mov	al, '.'
     635/    83D8 : E8 64 07            	call	CONOUT
     636/    83DB :                     	
     637/    83DB : E8 FB 06            	CALL	CONIN
     638/    83DE : E8 D2 02            	CALL	UPPER
     639/    83E1 : 3C 53               	CMP	AL,'S'
     640/    83E3 : 74 6B               	JE	LHS0
     641/    83E5 : 3C 3A               	CMP	AL,':'
     642/    83E7 : 74 10               	JE	LHI0
     643/    83E9 :                     LH3:
     644/    83E9 :                     	;; Skip to EOL
     645/    83E9 : 3C 0D               	CMP	AL,CR
     646/    83EB : 74 E9               	JE	LH2
     647/    83ED : 3C 0A               	CMP	AL,LF
     648/    83EF : 74 E5               	JE	LH2
     649/    83F1 : E8 E5 06            	CALL	CONIN
     650/    83F4 : EB F3               	JMP	LH3
     651/    83F6 :                     LHE:
     652/    83F6 : E9 56 FD            	JMP	ERR
     653/    83F9 :                     
     654/    83F9 :                     LHI0:
     655/    83F9 : E8 28 02            	CALL	HEXIN
     656/    83FC : 8A C8               	MOV	CL,AL		; Checksum
     657/    83FE : 8A D8               	MOV	BL,AL		; Length
     658/    8400 :                     
     659/    8400 : E8 21 02            	CALL	HEXIN
     660/    8403 : 8A F0               	MOV	DH,AL		; Address H
     661/    8405 : 02 C8               	ADD	CL,AL		; Checksum
     662/    8407 :                     
     663/    8407 : E8 1A 02            	CALL	HEXIN
     664/    840A : 8A D0               	MOV	DL,AL		; Address L
     665/    840C : 02 C8               	ADD	CL,AL		; Checksum
     666/    840E :                     
     667/    840E : 8B FA               	MOV	DI,DX
     668/    8410 : 03 FE               	ADD	DI,SI		; Add offset
     669/    8412 :                     
     670/    8412 : E8 0F 02            	CALL	HEXIN
     671/    8415 : A2 1E 05            	MOV	[RECTYP],AL	; Record Type
     672/    8418 : 02 C8               	ADD	CL,AL		; Checksum
     673/    841A :                     
     674/    841A : 0A DB               	OR	BL,BL		; Check length
     675/    841C : 74 15               	JZ	LHI3
     676/    841E :                     LHI1:
     677/    841E : E8 03 02            	CALL	HEXIN
     678/    8421 : 02 C8               	ADD	CL,AL		; Checksum
     679/    8423 :                     
     680/    8423 : 8A 3E 1E 05         	MOV	BH,[RECTYP]
     681/    8427 : 0A FF               	OR	BH,BH
     682/    8429 : 75 04               	JNZ	LHI2
     683/    842B :                     
     684/    842B : 26 88 05            	MOV	ES:[DI],AL
     685/    842E : 47                  	INC	DI
     686/    842F :                     LHI2:
     687/    842F : FE CB               	DEC	BL
     688/    8431 : 75 EB               	JNZ	LHI1
     689/    8433 :                     LHI3:
     690/    8433 : E8 EE 01            	CALL	HEXIN
     691/    8436 : 02 C1               	ADD	AL,CL
     692/    8438 : 75 0D               	JNZ	LHIE		; Checksum error
     693/    843A : A0 1E 05            	MOV	AL,[RECTYP]
     694/    843D : 0A C0               	OR	AL,AL
     695/    843F : 74 A8               	JZ	LH3
     696/    8441 :                     
     697/    8441 :                     LHSR:
     698/    8441 : E8 0C 02            	call	CRLF
     699/    8444 : E9 C9 FC            	JMP	WSTART
     700/    8447 :                     LHIE:
     701/    8447 : BB 19 88            	MOV	BX,IHEMSG
     702/    844A : E8 9B 01            	CALL	MSGOUT
     703/    844D : E9 C0 FC            	JMP	WSTART
     704/    8450 :                     
     705/    8450 :                     LHS0:
     706/    8450 : E8 86 06            	CALL	CONIN
     707/    8453 : A2 1E 05            	MOV	[RECTYP],AL
     708/    8456 :                     
     709/    8456 : E8 CB 01            	CALL	HEXIN
     710/    8459 : 8A D8               	MOV	BL,AL		; Length+3
     711/    845B : 8A C8               	MOV	CL,AL		; Checksum
     712/    845D :                     
     713/    845D : E8 C4 01            	CALL	HEXIN
     714/    8460 : 8A F0               	MOV	DH,AL		; Address H
     715/    8462 : 02 C8               	ADD	CL,AL		; Checksum
     716/    8464 :                     	
     717/    8464 : E8 BD 01            	CALL	HEXIN
     718/    8467 : 8A D0               	MOV	DL,AL		; Address L
     719/    8469 : 02 C8               	ADD	CL,AL		; Checksum
     720/    846B :                     
     721/    846B : 8B FA               	MOV	DI,DX
     722/    846D : 03 FE               	ADD	DI,SI		; Add offset
     723/    846F :                     
     724/    846F : 80 EB 03            	SUB	BL,3
     725/    8472 : 72 2B               	JC	LHSE		; Length error
     726/    8474 : 74 16               	JZ	LHS3
     727/    8476 :                     LHS1:
     728/    8476 : E8 AB 01            	CALL	HEXIN
     729/    8479 : 02 C8               	ADD	CL,AL		; Checksum
     730/    847B :                     
     731/    847B : 8A 3E 1E 05         	MOV	BH,[RECTYP]
     732/    847F : 80 FF 31            	CMP	BH,'1'
     733/    8482 : 75 04               	JNZ	LHS2
     734/    8484 :                     
     735/    8484 : 26 88 05            	MOV	ES:[DI],AL
     736/    8487 : 47                  	INC	DI
     737/    8488 :                     LHS2:
     738/    8488 : FE CB               	DEC	BL
     739/    848A : 75 EA               	JNZ	LHS1
     740/    848C :                     LHS3:
     741/    848C : E8 95 01            	CALL	HEXIN
     742/    848F : 02 C1               	ADD	AL,CL
     743/    8491 : 3C FF               	CMP	AL,0FFH
     744/    8493 : 75 0A               	JNE	LHSE		; Checksum error
     745/    8495 :                     
     746/    8495 : A0 1E 05            	MOV	AL,[RECTYP]
     747/    8498 : 3C 39               	CMP	AL,'9'
     748/    849A : 74 A5               	JZ	LHSR
     749/    849C : E9 4A FF            	JMP	LH3
     750/    849F :                     LHSE:
     751/    849F : BB 26 88            	MOV	BX,SHEMSG
     752/    84A2 : E8 43 01            	CALL	MSGOUT
     753/    84A5 : E9 68 FC            	JMP	WSTART
     754/    84A8 :                     
     755/    84A8 :                     ;;;
     756/    84A8 :                     ;;; Register
     757/    84A8 :                     ;;; 
     758/    84A8 :                     REG:
     759/    84A8 : 43                  	INC	BX
     760/    84A9 : E8 FD 01            	CALL	SKIPSP
     761/    84AC : E8 04 02            	CALL	UPPER
     762/    84AF : 0A C0               	OR	AL,AL
     763/    84B1 : 75 06               	JNE	RG0
     764/    84B3 : E8 7F 00            	CALL	RDUMP
     765/    84B6 : E9 57 FC            	JMP	WSTART
     766/    84B9 :                     RG0:
     767/    84B9 : BE 7D 89            	MOV	SI,RNTAB
     768/    84BC :                     RG1:
     769/    84BC : 2E 3A 04            	CMP	AL,CS:[SI]
     770/    84BF : 74 0D               	JE	RG2		; Character match
     771/    84C1 : 2E 8A 4C 01         	MOV	CL,CS:1[SI]
     772/    84C5 : 0A C9               	OR	CL,CL
     773/    84C7 : 74 69               	JE	RGE
     774/    84C9 : 83 C6 06            	ADD	SI,6
     775/    84CC : EB EE               	JMP	RG1
     776/    84CE :                     RG2:
     777/    84CE : 2E 8A 44 01         	MOV	AL,CS:1[SI]
     778/    84D2 : 3C 0F               	CMP	AL,0FH
     779/    84D4 : 75 0C               	JNE	RG3
     780/    84D6 :                     	;; Next table
     781/    84D6 : 2E 8B 74 02         	MOV	SI,CS:2[SI]
     782/    84DA : 43                  	INC	BX
     783/    84DB : 8A 07               	MOV	AL,[BX]
     784/    84DD : E8 D3 01            	CALL	UPPER
     785/    84E0 : EB DA               	JMP	RG1
     786/    84E2 :                     RG3:	
     787/    84E2 : 0A C0               	OR	AL,AL		; Found end mark
     788/    84E4 : 74 4C               	JE	RGE
     789/    84E6 :                     
     790/    84E6 : 2E 8A 4C 01         	MOV	CL,CS:1[SI]
     791/    84EA : 2E 8B 5C 04         	MOV	BX,CS:4[SI]
     792/    84EE : E8 F7 00            	CALL	MSGOUT
     793/    84F1 : B0 3D               	MOV	AL,'='
     794/    84F3 : E8 49 06            	CALL	CONOUT
     795/    84F6 : 2E 8B 5C 02         	MOV	BX,CS:2[SI]
     796/    84FA : 80 E1 07            	AND	CL,07H
     797/    84FD : 53                  	PUSH	BX
     798/    84FE : 51                  	PUSH	CX
     799/    84FF : 80 F9 01            	CMP	CL,1
     800/    8502 : 75 07               	JNE	RG4
     801/    8504 :                     	;; 8 bit register
     802/    8504 : 8A 07               	MOV	AL,[BX]
     803/    8506 : E8 01 01            	CALL	HEXOUT2
     804/    8509 : EB 05               	JMP	RG5
     805/    850B :                     RG4:
     806/    850B :                     	;; 16 bit register
     807/    850B : 8B 07               	MOV	AX,[BX]
     808/    850D : E8 F3 00            	CALL	HEXOUT4
     809/    8510 :                     RG5:
     810/    8510 : B0 20               	MOV	AL,' '
     811/    8512 : E8 2A 06            	CALL	CONOUT
     812/    8515 : E8 42 01            	CALL	GETLIN
     813/    8518 : BB F9 04            	MOV	BX,INBUF
     814/    851B : E8 A0 01            	CALL	RDHEX
     815/    851E : 0A C9               	OR	CL,CL
     816/    8520 : 74 0D               	JE	RGR
     817/    8522 : 59                  	POP	CX
     818/    8523 : 5B                  	POP	BX
     819/    8524 : 80 F9 01            	CMP	CL,1
     820/    8527 : 75 04               	JNE	RG6
     821/    8529 :                     	;; 8 bit register
     822/    8529 : 88 17               	MOV	[BX],DL
     823/    852B : EB 02               	JMP	RG7
     824/    852D :                     RG6:
     825/    852D :                     	;; 16 bit register
     826/    852D : 89 17               	MOV	[BX],DX
     827/    852F :                     RG7:
     828/    852F :                     RGR:
     829/    852F : E9 DE FB            	JMP	WSTART
     830/    8532 :                     RGE:
     831/    8532 : E9 1A FC            	JMP	ERR
     832/    8535 :                     	
     833/    8535 :                     RDUMP:
     834/    8535 : BE E5 88            	MOV	SI,RDTAB
     835/    8538 :                     RD0:	
     836/    8538 : 2E 8B 1C            	MOV	BX,CS:[SI]
     837/    853B : 0B DB               	OR	BX,BX
     838/    853D : 74 11               	JZ	RD1
     839/    853F : E8 A6 00            	CALL	MSGOUT
     840/    8542 : 46                  	INC	SI
     841/    8543 : 46                  	INC	SI
     842/    8544 : 2E 8B 1C            	MOV	BX,CS:[SI]
     843/    8547 : 8B 07               	MOV	AX,[BX]
     844/    8549 : E8 B7 00            	CALL	HEXOUT4
     845/    854C : 46                  	INC	SI
     846/    854D : 46                  	INC	SI
     847/    854E : EB E8               	JMP	RD0
     848/    8550 :                     RD1:	
     849/    8550 :                     ; Flag bit image
     850/    8550 :                     
     851/    8550 : BB 67 89            	mov	bx, FLGB
     852/    8553 : E8 92 00            	CALL	MSGOUT		;" FLb="
     853/    8556 :                     
     854/    8556 : BF 42 05            	mov	di, F_bit
     855/    8559 : BB 6D 89            	mov	bx, Fbiton
     856/    855C : B1 10               	mov	cl, 16
     857/    855E : A1 28 05            	mov	ax, [REGF]
     858/    8561 : 25 D5 0F            	and	ax, f_msk_bit
     859/    8564 :                     
     860/    8564 :                     fb_loop:
     861/    8564 : D1 E0               	shl	ax, 1
     862/    8566 : 72 05               	jc	rdf1
     863/    8568 :                     
     864/    8568 : C6 05 2E            	mov	byte ptr [di], '.'
     865/    856B : EB 04               	jmp	rdf2
     866/    856D :                     
     867/    856D :                     rdf1:
     868/    856D : 8A 2F               	mov	ch, [bx]
     869/    856F : 88 2D               	mov	[di], ch
     870/    8571 :                     rdf2:
     871/    8571 : 43                  	inc	bx
     872/    8572 : 47                  	inc	di
     873/    8573 : FE C9               	dec	cl
     874/    8575 : 75 ED               	jnz	fb_loop
     875/    8577 :                     
     876/    8577 : C6 05 00            	mov	byte ptr [di],0
     877/    857A : BB 42 05            	mov	bx, F_bit
     878/    857D : E8 68 00            	CALL	MSGOUT		;"....ODITSZ.A.P.C"
     879/    8580 :                     	
     880/    8580 : E9 CD 00            	JMP	CRLF
     881/    8583 :                     	
     882/    8583 :                     ;;;
     883/    8583 :                     ;;; T address
     884/    8583 :                     ;;; 
     885/    8583 :                     
     886/    8583 :                     Trace:
     887/    8583 : 43                  	INC	BX
     888/    8584 : E8 37 01            	CALL	RDHEX
     889/    8587 : 0A C9               	OR	CL,CL
     890/    8589 : 74 19               	JZ	T1
     891/    858B : 8A 07               	MOV	AL,[BX]
     892/    858D : 3C 3A               	CMP	AL,':'
     893/    858F : 75 0C               	JNE	T0
     894/    8591 :                     
     895/    8591 : 89 16 34 05         	MOV	[REGCS],DX
     896/    8595 : 43                  	INC	BX
     897/    8596 : E8 25 01            	CALL	RDHEX
     898/    8599 : 0A C9               	OR	CL,CL
     899/    859B : 74 0D               	JZ	TE
     900/    859D :                     T0:
     901/    859D : 89 16 32 05         	MOV	[REGIP],DX
     902/    85A1 : E8 05 01            	CALL	SKIPSP
     903/    85A4 :                     T1:
     904/    85A4 : 8A 07               	MOV	AL,[BX]
     905/    85A6 : 0A C0               	or	al, al
     906/    85A8 : 74 03               	je	To_go
     907/    85AA :                     
     908/    85AA :                     TE:
     909/    85AA : E9 A2 FB            	JMP	ERR
     910/    85AD :                     
     911/    85AD :                     To_go:
     912/    85AD : 8E 16 38 05         	MOV	SS,[REGSS]
     913/    85B1 : 8B 26 2A 05         	MOV	SP,[REGSP]
     914/    85B5 :                     	
     915/    85B5 : A1 28 05            	MOV	AX,[REGF]
     916/    85B8 : 0D 00 01            	or	ax, Tbit_ON_
     917/    85BB :                     ;	and	ax, IBIT_OFF
     918/    85BB :                     
     919/    85BB : 50                  	PUSH	AX
     920/    85BC : A1 34 05            	MOV	AX,[REGCS]
     921/    85BF : 50                  	PUSH	AX
     922/    85C0 : A1 32 05            	MOV	AX,[REGIP]
     923/    85C3 : 50                  	PUSH	AX
     924/    85C4 :                     
     925/    85C4 : A1 20 05            	MOV	AX,[REGAX]
     926/    85C7 : 8B 1E 22 05         	MOV	BX,[REGBX]
     927/    85CB : 8B 0E 24 05         	MOV	CX,[REGCX]
     928/    85CF : 8B 16 26 05         	MOV	DX,[REGDX]
     929/    85D3 : 8B 2E 2C 05         	MOV	BP,[REGBP]
     930/    85D7 : 8B 36 2E 05         	MOV	SI,[REGSI]
     931/    85DB : 8B 3E 30 05         	MOV	DI,[REGDI]
     932/    85DF : 8E 06 3A 05         	MOV	ES,[REGES]
     933/    85E3 : 8E 1E 36 05         	MOV	DS,[REGDS]
     934/    85E7 : CF                  	IRET
     935/    85E8 :                     
     936/    85E8 :                     ;;;
     937/    85E8 :                     ;;; Other support routines
     938/    85E8 :                     ;;;
     939/    85E8 :                     
     940/    85E8 :                     MSGOUT:
     941/    85E8 : 2E 8A 07            	MOV	AL,CS:[BX]
     942/    85EB : 22 C0               	AND	AL,AL
     943/    85ED : 74 06               	JZ	MSGOE
     944/    85EF : E8 4D 05            	CALL	CONOUT
     945/    85F2 : 43                  	INC	BX
     946/    85F3 : EB F3               	JMP	MSGOUT
     947/    85F5 :                     MSGOE:
     948/    85F5 : C3                  	RET
     949/    85F6 :                     
     950/    85F6 :                     STROUT:
     951/    85F6 : 8A 07               	MOV	AL,[BX]
     952/    85F8 : 22 C0               	AND	AL,AL
     953/    85FA : 74 06               	JZ	STROE
     954/    85FC : E8 40 05            	CALL	CONOUT
     955/    85FF : 43                  	INC	BX
     956/    8600 : EB F4               	JMP	STROUT
     957/    8602 :                     STROE:
     958/    8602 : C3                  	RET
     959/    8603 :                     
     960/    8603 :                     HEXOUT4:
     961/    8603 : 50                  	PUSH	AX
     962/    8604 : 8A C4               	MOV	AL,AH
     963/    8606 : E8 01 00            	CALL	HEXOUT2
     964/    8609 : 58                  	POP	AX
     965/    860A :                     HEXOUT2:
     966/    860A : 50                  	PUSH	AX
     967/    860B : D0 E8               	SHR	AL,1
     968/    860D : D0 E8               	SHR	AL,1
     969/    860F : D0 E8               	SHR	AL,1
     970/    8611 : D0 E8               	SHR	AL,1
     971/    8613 : E8 01 00            	CALL	HEXOUT1
     972/    8616 : 58                  	POP	AX
     973/    8617 :                     HEXOUT1:
     974/    8617 : 24 0F               	AND	AL,0FH
     975/    8619 : 04 30               	ADD	AL,'0'
     976/    861B : 3C 3A               	CMP	AL,'9'+1
     977/    861D : 72 02               	JC	HO10
     978/    861F : 04 07               	ADD	AL,'A'-'9'-1
     979/    8621 :                     HO10:
     980/    8621 : E9 1B 05            	JMP	CONOUT
     981/    8624 :                     
     982/    8624 :                     HEXIN:
     983/    8624 : 32 C0               	XOR	AL,AL
     984/    8626 : E8 08 00            	CALL	HI0
     985/    8629 : D0 E0               	SHL	AL,1
     986/    862B : D0 E0               	SHL	AL,1
     987/    862D : D0 E0               	SHL	AL,1
     988/    862F : D0 E0               	SHL	AL,1
     989/    8631 :                     HI0:
     990/    8631 : 8A E8               	MOV	CH,AL
     991/    8633 : E8 A3 04            	CALL	CONIN
     992/    8636 : E8 7A 00            	CALL	UPPER
     993/    8639 : 3C 30               	CMP	AL,'0'
     994/    863B : 72 12               	JC	HIR
     995/    863D : 3C 3A               	CMP	AL,'9'+1
     996/    863F : 72 0A               	JC	HI1
     997/    8641 : 3C 41               	CMP	AL,'A'
     998/    8643 : 72 0A               	JC	HIR
     999/    8645 : 3C 47               	CMP	AL,'F'+1
    1000/    8647 : 73 06               	JNC	HIR
    1001/    8649 : 2C 07               	SUB	AL,'A'-'9'-1
    1002/    864B :                     HI1:
    1003/    864B : 2C 30               	SUB	AL,'0'
    1004/    864D : 0A C5               	OR	AL,CH
    1005/    864F :                     HIR:
    1006/    864F : C3                  	RET
    1007/    8650 :                     
    1008/    8650 :                     CRLF:
    1009/    8650 : B0 0D               	MOV	AL,CR
    1010/    8652 : E8 EA 04            	CALL	CONOUT
    1011/    8655 : B0 0A               	MOV	AL,LF
    1012/    8657 : E9 E5 04            	JMP	CONOUT
    1013/    865A :                     
    1014/    865A :                     GETLIN:
    1015/    865A : BB F9 04            	MOV	BX,INBUF
    1016/    865D : 32 C9               	XOR	CL,CL
    1017/    865F :                     GL0:
    1018/    865F : E8 77 04            	CALL	CONIN
    1019/    8662 : 3C 0D               	CMP	AL,CR
    1020/    8664 : 74 3B               	JZ	GLE
    1021/    8666 : 3C 0A               	CMP	AL,LF
    1022/    8668 : 74 37               	JZ	GLE
    1023/    866A : 3C 08               	CMP	AL,BS
    1024/    866C : 74 1B               	JZ	GLB
    1025/    866E : 3C 7F               	CMP	AL,DEL
    1026/    8670 : 74 17               	JZ	GLB
    1027/    8672 : 3C 20               	CMP	AL,' '
    1028/    8674 : 72 E9               	JC	GL0
    1029/    8676 : 3C 80               	CMP	AL,80H
    1030/    8678 : 73 E5               	JNC	GL0
    1031/    867A : 80 F9 17            	CMP	CL,BUFLEN-1
    1032/    867D : 73 E0               	JNC	GL0		; Too long
    1033/    867F : 88 07               	MOV	[BX],AL
    1034/    8681 : E8 BB 04            	CALL	CONOUT
    1035/    8684 : 43                  	INC	BX
    1036/    8685 : FE C1               	INC	CL
    1037/    8687 : EB D6               	JMP	GL0
    1038/    8689 :                     GLB:
    1039/    8689 : 22 C9               	AND	CL,CL
    1040/    868B : 74 D2               	JZ	GL0
    1041/    868D : 4B                  	DEC	BX
    1042/    868E : FE C9               	DEC	CL
    1043/    8690 : B0 08               	MOV	AL,BS
    1044/    8692 : E8 AA 04            	CALL	CONOUT
    1045/    8695 : B0 20               	MOV	AL,' '
    1046/    8697 : E8 A5 04            	CALL	CONOUT
    1047/    869A : B0 08               	MOV	AL,BS
    1048/    869C : E8 A0 04            	CALL	CONOUT
    1049/    869F : EB BE               	JMP	GL0
    1050/    86A1 :                     GLE:
    1051/    86A1 : E8 AC FF            	CALL	CRLF
    1052/    86A4 : B0 00               	MOV	AL,00H
    1053/    86A6 : 88 07               	MOV	[BX],AL
    1054/    86A8 : C3                  	RET
    1055/    86A9 :                     	
    1056/    86A9 :                     SKIPSP:
    1057/    86A9 : 8A 07               	MOV	AL,[BX]
    1058/    86AB : 3C 20               	CMP	AL,' '
    1059/    86AD : 75 03               	JNE	SSR
    1060/    86AF : 43                  	INC	BX
    1061/    86B0 : EB F7               	JMP	SKIPSP
    1062/    86B2 :                     SSR:
    1063/    86B2 : C3                  	RET
    1064/    86B3 :                     
    1065/    86B3 :                     UPPER:
    1066/    86B3 : 3C 61               	CMP	AL,'a'
    1067/    86B5 : 72 06               	JC	UPR
    1068/    86B7 : 3C 7B               	CMP	AL,'z'+1
    1069/    86B9 : 73 02               	JNC	UPR
    1070/    86BB : 04 E0               	ADD	AL,'A'-'a'
    1071/    86BD :                     UPR:
    1072/    86BD : C3                  	RET
    1073/    86BE :                     
    1074/    86BE :                     RDHEX:
    1075/    86BE : E8 E8 FF            	CALL	SKIPSP
    1076/    86C1 : 32 C9               	XOR	CL,CL
    1077/    86C3 : 33 D2               	XOR	DX,DX
    1078/    86C5 :                     RH0:
    1079/    86C5 : 8A 07               	MOV	AL,[BX]
    1080/    86C7 : E8 E9 FF            	CALL	UPPER
    1081/    86CA : 3C 30               	CMP	AL,'0'
    1082/    86CC : 72 1F               	JC	RHE
    1083/    86CE : 3C 3A               	CMP	AL,'9'+1
    1084/    86D0 : 72 0A               	JC	RH1
    1085/    86D2 : 3C 41               	CMP	AL,'A'
    1086/    86D4 : 72 17               	JC	RHE
    1087/    86D6 : 3C 47               	CMP	AL,'F'+1
    1088/    86D8 : 73 13               	JNC	RHE
    1089/    86DA : 2C 07               	SUB	AL,'A'-'9'-1
    1090/    86DC :                     RH1:
    1091/    86DC : 2C 30               	SUB	AL,'0'
    1092/    86DE : D1 E2               	SHL	DX,1
    1093/    86E0 : D1 E2               	SHL	DX,1
    1094/    86E2 : D1 E2               	SHL	DX,1
    1095/    86E4 : D1 E2               	SHL	DX,1
    1096/    86E6 : 0A D0               	OR	DL,AL
    1097/    86E8 : 43                  	INC	BX
    1098/    86E9 : FE C1               	INC	CL
    1099/    86EB : EB D8               	JMP	RH0
    1100/    86ED :                     RHE:
    1101/    86ED : C3                  	RET
    1102/    86EE :                     
    1103/    86EE :                     ;-----------------------
    1104/    86EE :                     ; INT 21H function call 
    1105/    86EE :                     ;-----------------------
    1106/    86EE :                     INTFNC:
    1107/    86EE :                     	; get a charactor : AH = 7
    1108/    86EE :                     	; return AL : charactor
    1109/    86EE :                     
    1110/    86EE : 55                  	push	bp
    1111/    86EF : 8B EC               	mov	bp, sp
    1112/    86F1 : FF 76 06            	push	[bp+6]
    1113/    86F4 : 9D                  	popf		; get user FL condition
    1114/    86F5 : 5D                  	pop	bp
    1115/    86F6 :                     
    1116/    86F6 : 80 FC 07            	cmp	ah, 7
    1117/    86F9 : 75 04               	jnz	nfnc1
    1118/    86FB : E8 DB 03            	call	CONIN
    1119/    86FE : CF                  	iret
    1120/    86FF :                     nfnc1:
    1121/    86FF :                     	; put a charactor : AH = 2
    1122/    86FF :                     	; input : DL : charactor
    1123/    86FF : 80 FC 02            	cmp	ah, 2
    1124/    8702 : 75 06               	jnz	nfnc2		; no support function
    1125/    8704 : 8A C2               	mov	al, dl
    1126/    8706 : E8 36 04            	call	CONOUT
    1127/    8709 : CF                  	iret
    1128/    870A :                     
    1129/    870A :                     nfnc2:
    1130/    870A :                     	; check key status : AH = 0BH
    1131/    870A :                     	; OUTPUT : AL : 0     ( key is not exist )
    1132/    870A :                     	;             : 0FFH  ( key is exist )
    1133/    870A : 80 FC 0B            	cmp	ah, 0BH
    1134/    870D : 75 08               	jnz	nfnc3		; no support function
    1135/    870F : E8 27 04            	call	CONST
    1136/    8712 : 74 02               	jz	nfnc4
    1137/    8714 : B0 FF               	mov	al, 0FFH
    1138/    8716 :                     nfnc4:
    1139/    8716 : CF                  	iret
    1140/    8717 :                     
    1141/    8717 :                     nfnc3:
    1142/    8717 :                     	; warm boot check
    1143/    8717 :                     	; ah=0 : warm boot
    1144/    8717 : 80 FC 00            	cmp	ah, 0
    1145/    871A : 75 FA               	jnz	nfnc4
    1146/    871C :                     
    1147/    871C : B8 00 00            	MOV	AX,RAMSEG
    1148/    871F : 8E D8               	MOV	DS,AX
    1149/    8721 : 8E D0               	MOV	SS,AX
    1150/    8723 : BC 00 06            	MOV	SP,STACK
    1151/    8726 :                     nfnc31:
    1152/    8726 : B0 11               	mov	al, XON
    1153/    8728 : A2 07 04            	mov	[rx_xflg], al
    1154/    872B : E8 11 04            	call	CONOUT
    1155/    872E : E9 92 00            	jmp	chk_bpt
    1156/    8731 :                     
    1157/    8731 :                     ;;;
    1158/    8731 :                     ;;; Interrupt Handler
    1159/    8731 :                     ;;;
    1160/    8731 :                     
    1161/    8731 :                     	;; Divide error (INT 00H)
    1162/    8731 :                     INTDIV:
    1163/    8731 : 50                  	PUSH	AX
    1164/    8732 : 1E                  	PUSH	DS
    1165/    8733 : B8 00 00            	MOV	AX,RAMSEG
    1166/    8736 : 8E D8               	MOV	DS,AX
    1167/    8738 : 89 1E 22 05         	MOV	[REGBX],BX
    1168/    873C : 89 0E 24 05         	MOV	[REGCX],CX
    1169/    8740 : BB B6 88            	MOV	BX,DIVMSG
    1170/    8743 : 33 C9               	XOR	CX,CX		; IP adjustment
    1171/    8745 : EB 41               	JMP	INT0
    1172/    8747 :                     	
    1173/    8747 :                     	;; Single step (INT 01H)
    1174/    8747 :                     INTSTP:
    1175/    8747 : 50                  	PUSH	AX
    1176/    8748 : 1E                  	PUSH	DS
    1177/    8749 : B8 00 00            	MOV	AX,RAMSEG
    1178/    874C : 8E D8               	MOV	DS,AX
    1179/    874E : 89 1E 22 05         	MOV	[REGBX],BX
    1180/    8752 : 89 0E 24 05         	MOV	[REGCX],CX
    1181/    8756 : BB C5 88            	MOV	BX,STPMSG
    1182/    8759 : 33 C9               	XOR	CX,CX		; IP adjustment
    1183/    875B : EB 2B               	JMP	INT0
    1184/    875D :                     	
    1185/    875D :                     	;; Break (INT 03H)
    1186/    875D :                     INTBRK:
    1187/    875D : 50                  	PUSH	AX
    1188/    875E : 1E                  	PUSH	DS
    1189/    875F : B8 00 00            	MOV	AX,RAMSEG
    1190/    8762 : 8E D8               	MOV	DS,AX
    1191/    8764 : 89 1E 22 05         	MOV	[REGBX],BX
    1192/    8768 : 89 0E 24 05         	MOV	[REGCX],CX
    1193/    876C : BB D2 88            	MOV	BX,BRKMSG
    1194/    876F : B9 01 00            	MOV	CX,1		; IP adjustment
    1195/    8772 : EB 14               	JMP	INT0
    1196/    8774 :                     	
    1197/    8774 :                     	;; Overflow (INT 04H)
    1198/    8774 :                     INTOVF:
    1199/    8774 : 50                  	PUSH	AX
    1200/    8775 : 1E                  	PUSH	DS
    1201/    8776 : B8 00 00            	MOV	AX,RAMSEG
    1202/    8779 : 8E D8               	MOV	DS,AX
    1203/    877B : 89 1E 22 05         	MOV	[REGBX],BX
    1204/    877F : 89 0E 24 05         	MOV	[REGCX],CX
    1205/    8783 : BB DA 88            	MOV	BX,OVFMSG
    1206/    8786 : 33 C9               	XOR	CX,CX		; IP adjustment
    1207/    8788 :                     INT0:
    1208/    8788 : 58                  	POP	AX
    1209/    8789 : A3 36 05            	MOV	[REGDS],AX
    1210/    878C : 58                  	POP	AX
    1211/    878D : A3 20 05            	MOV	[REGAX],AX
    1212/    8790 : 89 16 26 05         	MOV	[REGDX],DX
    1213/    8794 :                     
    1214/    8794 : 89 2E 2C 05         	MOV	[REGBP],BP
    1215/    8798 : 89 36 2E 05         	MOV	[REGSI],SI
    1216/    879C : 89 3E 30 05         	MOV	[REGDI],DI
    1217/    87A0 : 8C 06 3A 05         	MOV	[REGES],ES
    1218/    87A4 :                     
    1219/    87A4 : 58                  	POP	AX
    1220/    87A5 : 2B C1               	SUB	AX,CX
    1221/    87A7 : A3 32 05            	MOV	[REGIP],AX
    1222/    87AA : 58                  	POP	AX
    1223/    87AB : A3 34 05            	MOV	[REGCS],AX
    1224/    87AE : 58                  	POP	AX
    1225/    87AF : 25 D5 0E            	and	ax,Tbit_OFF	; trace mode off
    1226/    87B2 :                     ;	or	ax, INIT_FL_	; int flag on
    1227/    87B2 :                     
    1228/    87B2 : A3 28 05            	MOV	[REGF],AX
    1229/    87B5 :                     
    1230/    87B5 : 89 26 2A 05         	MOV	[REGSP],SP
    1231/    87B9 : 8C 16 38 05         	MOV	[REGSS],SS
    1232/    87BD :                     
    1233/    87BD : E8 28 FE            	CALL	MSGOUT
    1234/    87C0 : E8 72 FD            	CALL	RDUMP
    1235/    87C3 :                     
    1236/    87C3 :                     ; check break point
    1237/    87C3 :                     
    1238/    87C3 :                     chk_bpt:
    1239/    87C3 : A0 3C 05            	mov	al, [bflg]
    1240/    87C6 : 0A C0               	or	al, al
    1241/    87C8 : 74 14               	je	nobrkp
    1242/    87CA :                     
    1243/    87CA :                     ; restore a original code at break point
    1244/    87CA :                     
    1245/    87CA : A1 3E 05            	mov	ax, [brkcs]
    1246/    87CD : 8E C0               	mov	es, ax
    1247/    87CF : 8B 36 40 05         	mov	si, [brkip]
    1248/    87D3 : A0 3D 05            	mov	al, [bp_code]
    1249/    87D6 : 26 88 04            	mov	es:[si], al	; restore a original code
    1250/    87D9 : 32 C0               	xor	al, al
    1251/    87DB : A2 3C 05            	mov	[bflg], al	; clear break flag
    1252/    87DE :                     
    1253/    87DE :                     nobrkp:
    1254/    87DE : FB                  	sti
    1255/    87DF : E9 2E F9            	JMP	WSTART
    1256/    87E2 :                     
    1257/    87E2 :                     	;; Dummy
    1258/    87E2 :                     INTDMY:
    1259/    87E2 : CF                  	IRET
    1260/    87E3 :                     	
    1261/    87E3 :                     OPNMSG:
    1262/    87E3 : 0D 0A 55 6E 69 76   	DB	CR,LF,"Universal Monitor 8086",CR,LF
             87E9 : 65 72 73 61 6C 20 
             87EF : 4D 6F 6E 69 74 6F 
             87F5 : 72 20 38 30 38 36 
             87FB : 0D 0A             
    1263/    87FD : 53 42 43 56 32 30   	db	"SBCV20 Edition. Rev.01",CR,LF,00H
             8803 : 20 45 64 69 74 69 
             8809 : 6F 6E 2E 20 52 65 
             880F : 76 2E 30 31 0D 0A 
             8815 : 00                
    1264/    8816 :                     
    1265/    8816 :                     PROMPT:
    1266/    8816 : 5D 20 00            	DB	"] ",00H
    1267/    8819 :                     
    1268/    8819 :                     IHEMSG:
    1269/    8819 : 45 72 72 6F 72 20   	DB	"Error ihex",CR,LF,00H
             881F : 69 68 65 78 0D 0A 
             8825 : 00                
    1270/    8826 :                     SHEMSG:
    1271/    8826 : 45 72 72 6F 72 20   	DB	"Error srec",CR,LF,00H
             882C : 73 72 65 63 0D 0A 
             8832 : 00                
    1272/    8833 :                     ERRMSG:
    1273/    8833 : 45 72 72 6F 72 0D   	DB	"Error",CR,LF,00H
             8839 : 0A 00             
    1274/    883B :                     
    1275/    883B :                     DSEP0:
    1276/    883B : 20 3A 00            	DB	" :",00H
    1277/    883E :                     DSEP1:
    1278/    883E : 20 3A 20 00         	DB	" : ",00H
    1279/    8842 :                     IHEXER:
    1280/    8842 : 3A 30 30 30 30 30           DB	":00000001FF",CR,LF,00H
             8848 : 30 30 31 46 46 0D 
             884E : 0A 00             
    1281/    8850 :                     SRECER:
    1282/    8850 : 53 39 30 33 30 30           DB	"S9030000FC",CR,LF,00H
             8856 : 30 30 46 43 0D 0A 
             885C : 00                
    1283/    885D :                     
    1284/    885D :                     INIVEC:
    1285/    885D : 31 87 00 00         	DW	INTDIV, ROMSEG	; 00H Divide error
    1286/    8861 : 47 87 00 00         	DW	INTSTP, ROMSEG	; 01H Single step
    1287/    8865 : E2 87 00 00         	DW	INTDMY, ROMSEG	; 02H NMI
    1288/    8869 : 5D 87 00 00         	DW	INTBRK, ROMSEG	; 03H Breakpoint
    1289/    886D : 74 87 00 00         	DW	INTOVF, ROMSEG	; 04H Overflow
    1290/    8871 :                     INIVECE:
    1291/    8871 :                     
    1292/    8871 : =>TRUE               	IF USE_IDENT
    1293/    8871 :                     
    1294/    8871 : 43 50 55 20 3A 20   cpum:	db	"CPU : ", 00h
             8877 : 00                
    1295/    8878 : 38 30 38 36 2F 38   IM86:	DB	"8086/8088",CR,LF,00H
             887E : 30 38 38 0D 0A 00 
    1296/    8884 : 38 30 31 38 36 2F   IM186:	DB	"80186/80188",CR,LF,00H
             888A : 38 30 31 38 38 0D 
             8890 : 0A 00             
    1297/    8892 : 56 33 30 2F 56 32   IMV30:	DB	"V30/V20",CR,LF,00H
             8898 : 30 0D 0A 00       
    1298/    889C : 38 30 32 38 36 0D   IM286:	DB	"80286",CR,LF,00H
             88A2 : 0A 00             
    1299/    88A4 : 38 30 33 38 36 0D   IM386:	DB	"80386",CR,LF,00H
             88AA : 0A 00             
    1300/    88AC : 55 6E 6B 6E 6F 77   IMUNK:	DB	"Unknown",CR,LF,00H
             88B2 : 6E 0D 0A 00       
    1301/    88B6 :                     
    1302/    88B6 : [1292]               	ENDIF
    1303/    88B6 :                     	
    1304/    88B6 : 44 69 76 69 64 65   DIVMSG:	DB	"Divide error",CR,LF,00H
             88BC : 20 65 72 72 6F 72 
             88C2 : 0D 0A 00          
    1305/    88C5 : 53 74 65 70 0D 0A   STPMSG:	DB	"Step",CR,LF,00H
             88CB : 00                
    1306/    88CC : 4E 4D 49 0D 0A 00   NMIMSG:	DB	"NMI",CR,LF,00H
    1307/    88D2 : 42 72 65 61 6B 0D   BRKMSG:	DB	"Break",CR,LF,00H
             88D8 : 0A 00             
    1308/    88DA : 4F 76 65 72 66 6C   OVFMSG:	DB	"Overflow",CR,LF,00H
             88E0 : 6F 77 0D 0A 00    
    1309/    88E5 :                     
    1310/    88E5 : 21 89 20 05         RDTAB:	DW	RDSAX, REGAX
    1311/    88E9 : 25 89 22 05         	DW	RDSBX, REGBX
    1312/    88ED : 2A 89 24 05         	DW	RDSCX, REGCX
    1313/    88F1 : 2F 89 26 05         	DW	RDSDX, REGDX
    1314/    88F5 : 34 89 28 05         	DW	RDSF,  REGF
    1315/    88F9 : 39 89 34 05         	DW	RDSCS, REGCS
    1316/    88FD : 3E 89 36 05         	DW	RDSDS, REGDS
    1317/    8901 : 43 89 38 05         	DW	RDSSS, REGSS
    1318/    8905 : 48 89 3A 05         	DW	RDSES, REGES
    1319/    8909 : 4D 89 2A 05         	DW	RDSSP, REGSP
    1320/    890D : 53 89 2C 05         	DW	RDSBP, REGBP
    1321/    8911 : 58 89 2E 05         	DW	RDSSI, REGSI
    1322/    8915 : 5D 89 30 05         	DW	RDSDI, REGDI
    1323/    8919 : 62 89 32 05         	DW	RDSIP, REGIP
    1324/    891D :                     	
    1325/    891D : 00 00 00 00         	DW	0000H, 0000H
    1326/    8921 :                     
    1327/    8921 : 41 58 3D 00         RDSAX:	DB	"AX=",00H
    1328/    8925 : 20 42 58 3D 00      RDSBX:	DB	" BX=",00H
    1329/    892A : 20 43 58 3D 00      RDSCX:	DB	" CX=",00H
    1330/    892F : 20 44 58 3D 00      RDSDX:	DB	" DX=",00H
    1331/    8934 : 20 46 4C 3D 00      RDSF:	DB	" FL=",00H
    1332/    8939 : 20 43 53 3D 00      RDSCS:	DB	" CS=",00H
    1333/    893E : 20 44 53 3D 00      RDSDS:	DB	" DS=",00H
    1334/    8943 : 20 53 53 3D 00      RDSSS:	DB	" SS=",00H
    1335/    8948 : 20 45 53 3D 00      RDSES:	DB	" ES=",00H
    1336/    894D : 0D 0A 53 50 3D 00   RDSSP:	DB	CR,LF,"SP=",00H
    1337/    8953 : 20 42 50 3D 00      RDSBP:	DB	" BP=",00H
    1338/    8958 : 20 53 49 3D 00      RDSSI:	DB	" SI=",00H
    1339/    895D : 20 44 49 3D 00      RDSDI:	DB	" DI=",00H
    1340/    8962 : 20 49 50 3D 00      RDSIP:	DB	" IP=",00H
    1341/    8967 :                     
    1342/    8967 : 20 46 4C 62 3D 00   FLGB:	db	" FLb=",00h
    1343/    896D : 2E 2E 2E 2E 4F 44   Fbiton:	db	"....ODITSZ.A.P.C"
             8973 : 49 54 53 5A 2E 41 
             8979 : 2E 50 2E 43       
    1344/    897D :                     
    1345/    897D :                     
    1346/    897D :                     RNTAB:
    1347/    897D : 41 0F               	DB	'A',0FH		; "A?"
    1348/    897F : B3 89 00 00         	DW	RNTABA,0
    1349/    8983 : 42 0F               	DB	'B',0FH		; "B?"
    1350/    8985 : CB 89 00 00         	DW	RNTABB,0
    1351/    8989 : 43 0F               	DB	'C',0FH		; "C?"
    1352/    898B : E9 89 00 00         	DW	RNTABC,0
    1353/    898F : 44 0F               	DB	'D',0FH		; "D?"
    1354/    8991 : 07 8A 00 00         	DW	RNTABD,0
    1355/    8995 : 45 0F               	DB	'E',0FH		; "E?"
    1356/    8997 : 07 8A 00 00         	DW	RNTABD,0
    1357/    899B : 46 02               	DB	'F',2		; "F"
    1358/    899D : 28 05 8E 8A         	DW	REGF,RNF
    1359/    89A1 : 49 0F               	DB	'I',0FH		; "I?"
    1360/    89A3 : 37 8A 00 00         	DW	RNTABI,0
    1361/    89A7 : 53 0F               	DB	'S',0FH		; "S?"
    1362/    89A9 : 43 8A 00 00         	DW	RNTABS,0
    1363/    89AD :                     
    1364/    89AD : 00 00               	DB	00H,0		; End mark
    1365/    89AF : 00 00 00 00         	DW	0,0
    1366/    89B3 :                     	
    1367/    89B3 :                     RNTABA:
    1368/    89B3 : 58 02               	DB	'X',2		; "AX"
    1369/    89B5 : 20 05 5B 8A         	DW	REGAX,RNAX
    1370/    89B9 : 48 01               	DB	'H',1		; "AH"
    1371/    89BB : 21 05 5E 8A         	DW	REGAX+1,RNAH
    1372/    89BF : 4C 01               	DB	'L',1		; "AL"
    1373/    89C1 : 20 05 61 8A         	DW	REGAX,RNAL
    1374/    89C5 :                     
    1375/    89C5 : 00 00               	DB	00H,0		; End mark
    1376/    89C7 : 00 00 00 00         	DW	0,0
    1377/    89CB :                     
    1378/    89CB :                     RNTABB:
    1379/    89CB : 58 02               	DB	'X',2		; "BX"
    1380/    89CD : 22 05 64 8A         	DW	REGBX,RNBX
    1381/    89D1 : 48 01               	DB	'H',1		; "BH"
    1382/    89D3 : 23 05 67 8A         	DW	REGBX+1,RNBH
    1383/    89D7 : 4C 01               	DB	'L',1		; "BL"
    1384/    89D9 : 22 05 6A 8A         	DW	REGBX,RNBL
    1385/    89DD : 50 02               	DB	'P',2		; "BP"
    1386/    89DF : 2C 05 6D 8A         	DW	REGBP,RNBP
    1387/    89E3 :                     	
    1388/    89E3 : 00 00               	DB	00H,0		; End mark
    1389/    89E5 : 00 00 00 00         	DW	0,0
    1390/    89E9 :                     
    1391/    89E9 :                     RNTABC:
    1392/    89E9 : 58 02               	DB	'X',2		; "CX"
    1393/    89EB : 24 05 70 8A         	DW	REGCX,RNCX
    1394/    89EF : 48 01               	DB	'H',1		; "CH"
    1395/    89F1 : 25 05 73 8A         	DW	REGCX+1,RNCH
    1396/    89F5 : 4C 01               	DB	'L',1		; "CL"
    1397/    89F7 : 24 05 76 8A         	DW	REGCX,RNCL
    1398/    89FB : 53 02               	DB	'S',2		; "CS"
    1399/    89FD : 34 05 79 8A         	DW	REGCS,RNCS
    1400/    8A01 :                     	
    1401/    8A01 : 00 00               	DB	00H,0		; End mark
    1402/    8A03 : 00 00 00 00         	DW	0,0
    1403/    8A07 :                     	
    1404/    8A07 :                     RNTABD:
    1405/    8A07 : 58 02               	DB	'X',2		; "DX"
    1406/    8A09 : 26 05 7C 8A         	DW	REGDX,RNDX
    1407/    8A0D : 48 01               	DB	'H',1		; "DH"
    1408/    8A0F : 27 05 7F 8A         	DW	REGDX+1,RNDH
    1409/    8A13 : 4C 01               	DB	'L',1		; "DL"
    1410/    8A15 : 26 05 82 8A         	DW	REGDX,RNDL
    1411/    8A19 : 49 02               	DB	'I',2		; "DI"
    1412/    8A1B : 30 05 85 8A         	DW	REGDI,RNDI
    1413/    8A1F : 53 02               	DB	'S',2		; "DS"
    1414/    8A21 : 36 05 88 8A         	DW	REGDS,RNDS
    1415/    8A25 :                     	
    1416/    8A25 : 00 00               	DB	00H,0		; End mark
    1417/    8A27 : 00 00 00 00         	DW	0,0
    1418/    8A2B :                     
    1419/    8A2B :                     RNTABE:
    1420/    8A2B : 53 02               	DB	'S',2		; "ES"
    1421/    8A2D : 3A 05 8B 8A         	DW	REGES,RNES
    1422/    8A31 :                     	
    1423/    8A31 : 00 00               	DB	00H,0		; End mark
    1424/    8A33 : 00 00 00 00         	DW	0,0
    1425/    8A37 :                     	
    1426/    8A37 :                     RNTABI:
    1427/    8A37 : 50 02               	DB	'P',2		; "IP"
    1428/    8A39 : 32 05 90 8A         	DW	REGIP,RNIP
    1429/    8A3D :                     	
    1430/    8A3D : 00 00               	DB	00H,0		; End mark
    1431/    8A3F : 00 00 00 00         	DW	0,0
    1432/    8A43 :                     	
    1433/    8A43 :                     RNTABS:
    1434/    8A43 : 49 02               	DB	'I',2		; "SI"
    1435/    8A45 : 2E 05 93 8A         	DW	REGSI,RNSI
    1436/    8A49 : 50 02               	DB	'P',2		; "SP"
    1437/    8A4B : 2A 05 96 8A         	DW	REGSP,RNSP
    1438/    8A4F : 53 02               	DB	'S',2		; "SS"
    1439/    8A51 : 38 05 99 8A         	DW	REGSS,RNSS
    1440/    8A55 :                     	
    1441/    8A55 : 00 00               	DB	00H,0		; End mark
    1442/    8A57 : 00 00 00 00         	DW	0,0
    1443/    8A5B :                     	
    1444/    8A5B : 41 58 00            RNAX:	DB	"AX",00H
    1445/    8A5E : 41 48 00            RNAH:	DB	"AH",00H
    1446/    8A61 : 41 4C 00            RNAL:	DB	"AL",00H
    1447/    8A64 : 42 58 00            RNBX:	DB	"BX",00H
    1448/    8A67 : 42 48 00            RNBH:	DB	"BH",00H
    1449/    8A6A : 42 4C 00            RNBL:	DB	"BL",00H
    1450/    8A6D : 42 50 00            RNBP:	DB	"BP",00H
    1451/    8A70 : 43 58 00            RNCX:	DB	"CX",00H
    1452/    8A73 : 43 48 00            RNCH:	DB	"CH",00H
    1453/    8A76 : 43 4C 00            RNCL:	DB	"CL",00H
    1454/    8A79 : 43 53 00            RNCS:	DB	"CS",00H
    1455/    8A7C : 44 58 00            RNDX:	DB	"DX",00H
    1456/    8A7F : 44 48 00            RNDH:	DB	"DH",00H
    1457/    8A82 : 44 4C 00            RNDL:	DB	"DL",00H
    1458/    8A85 : 44 49 00            RNDI:	DB	"DI",00H
    1459/    8A88 : 44 53 00            RNDS:	DB	"DS",00H
    1460/    8A8B : 45 53 00            RNES:	DB	"ES",00H
    1461/    8A8E : 46 00               RNF:	DB	"F",00H
    1462/    8A90 : 49 50 00            RNIP:	DB	"IP",00H
    1463/    8A93 : 53 49 00            RNSI:	DB	"SI",00H
    1464/    8A96 : 53 50 00            RNSP:	DB	"SP",00H
    1465/    8A99 : 53 53 00            RNSS:	DB	"SS",00H
    1466/    8A9C :                     
    1467/    8A9C :                     ;;;
    1468/    8A9C :                     ;;; 	8251 Console Driver
    1469/    8A9C :                     ;;;
    1470/    8A9C :                     INIT:
    1471/    8A9C :                     	;; Reset USART
    1472/    8A9C : B0 00               	MOV	AL,00H
    1473/    8A9E : E6 01               	OUT	USARTC,AL
    1474/    8AA0 : 90                  	NOP
    1475/    8AA1 : 90                  	NOP
    1476/    8AA2 : B0 00               	MOV	AL,00H
    1477/    8AA4 : E6 01               	OUT	USARTC,AL
    1478/    8AA6 : 90                  	NOP
    1479/    8AA7 : 90                  	NOP
    1480/    8AA8 : B0 00               	MOV	AL,00H
    1481/    8AAA : E6 01               	OUT	USARTC,AL
    1482/    8AAC : 90                  	NOP
    1483/    8AAD : 90                  	NOP
    1484/    8AAE : B0 40               	MOV	AL,40H
    1485/    8AB0 : E6 01               	OUT	USARTC,AL
    1486/    8AB2 : 90                  	NOP
    1487/    8AB3 : 90                  	NOP
    1488/    8AB4 :                     	
    1489/    8AB4 :                     	;;
    1490/    8AB4 : B0 4E               	MOV	AL,4EH
    1491/    8AB6 : E6 01               	OUT	USARTC,AL
    1492/    8AB8 : 90                  	NOP
    1493/    8AB9 : 90                  	NOP
    1494/    8ABA :                     
    1495/    8ABA :                     	;;
    1496/    8ABA : B0 37               	MOV	AL,37H
    1497/    8ABC : E6 01               	OUT	USARTC,AL
    1498/    8ABE :                     ;
    1499/    8ABE :                     ;	Buffer initialize
    1500/    8ABE : 33 C0               	xor	ax, ax			;Clear al
    1501/    8AC0 : A2 06 04            	mov	[RBFCNT], al		;Set count of chars
    1502/    8AC3 : A3 04 04            	mov	[RBFRDP], ax		;Set read point
    1503/    8AC6 : A3 05 04            	mov	[RBFWTP], ax		;Set write point
    1504/    8AC9 : A2 08 04            	mov	[tx_xflg], al
    1505/    8ACC : A2 00 04            	mov	[MAXCNT], al
    1506/    8ACF : A3 02 04            	mov	[LOSTC], ax
    1507/    8AD2 : B0 11               	mov	al, XON
    1508/    8AD4 : A2 07 04            	mov	[rx_xflg], al
    1509/    8AD7 : EB 66               	jmp	CONOUT
    1510/    8AD9 :                     
    1511/    8AD9 :                     ;
    1512/    8AD9 :                     ; input charctor to console
    1513/    8AD9 :                     ; outputt al : char
    1514/    8AD9 :                     ;
    1515/    8AD9 :                     CONIN:
    1516/    8AD9 : 53                  	push	bx
    1517/    8ADA : 51                  	push	cx
    1518/    8ADB :                     ;
    1519/    8ADB : A0 06 04            gcst1:	mov	al, [RBFCNT]
    1520/    8ADE : 0A C0               	or	al, al			;Buffer enpty?
    1521/    8AE0 : 74 F9               	je	gcst1
    1522/    8AE2 :                     
    1523/    8AE2 : FA                  	cli
    1524/    8AE3 : 8A 26 06 04         	mov	ah, [RBFCNT]
    1525/    8AE7 : FE CC               	dec	ah
    1526/    8AE9 : 88 26 06 04         	mov	[RBFCNT], ah	; update
    1527/    8AED :                     ;
    1528/    8AED : 8A 1E 04 04         	mov	bl, [RBFRDP]	;Get read point
    1529/    8AF1 : B7 00               	mov	bh, 0
    1530/    8AF3 : 8A 87 09 04         	mov	al, [bx+RECBUF]	;Read char from buffer
    1531/    8AF7 :                     ;
    1532/    8AF7 : FE C3               	inc	bl		;Next read point
    1533/    8AF9 : 80 FB F0            	cmp	bl, BUFSIZ
    1534/    8AFC : 75 02               	jnz	sv_rdptr
    1535/    8AFE : 32 DB               	xor	bl, bl		;Wrap
    1536/    8B00 :                     ;	and	bl,BUFSIZ-1	;Wrap
    1537/    8B00 :                     sv_rdptr:
    1538/    8B00 : 88 1E 04 04         	mov	[RBFRDP] ,bl	;Update
    1539/    8B04 : FB                  	sti
    1540/    8B05 :                     
    1541/    8B05 : 8A C8               	mov	cl, al		; save a char
    1542/    8B07 : 32 E4               	xor	ah, ah		; make XON base digit
    1543/    8B09 :                     
    1544/    8B09 : 80 3E 07 04 13      	cmp	byte ptr [rx_xflg], XOFF	; XOFF?
    1545/    8B0E : 75 0C               	jne	chk_xon
    1546/    8B10 :                     
    1547/    8B10 :                     	; XOFF state is here
    1548/    8B10 : 80 3E 06 04 0A      	cmp	byte ptr [RBFCNT], RBLOW	; need XON action?
    1549/    8B15 : 76 10               	jbe	need_xon
    1550/    8B17 :                     	;
    1551/    8B17 :                     gcst5:	; get a char to al
    1552/    8B17 : 8A C1               	mov	al, cl
    1553/    8B19 : 59                  	pop	cx
    1554/    8B1A : 5B                  	pop	bx
    1555/    8B1B : C3                  	ret
    1556/    8B1C :                     
    1557/    8B1C :                     	; XON state is here
    1558/    8B1C :                     chk_xon:
    1559/    8B1C :                     
    1560/    8B1C : A0 01 04            	mov	al, [tsh]			; get threshold value
    1561/    8B1F : 38 06 06 04         	cmp	[RBFCNT], al			; need XOFF action?
    1562/    8B23 : 72 F2               	jb	gcst5				; return if char buffering state
    1563/    8B25 : B4 02               	mov	ah, XOFF-XON			; set XOFF base digit
    1564/    8B27 :                     need_xon:
    1565/    8B27 : 80 C4 11            	add	ah, XON		; make XON or XOFF
    1566/    8B2A :                     
    1567/    8B2A :                     gcst2:
    1568/    8B2A : E4 01               	IN	AL,USARTC
    1569/    8B2C : 24 01               	AND	AL,01H
    1570/    8B2E : 74 FA               	JZ	gcst2
    1571/    8B30 :                     
    1572/    8B30 : 8A C4               	mov	al, ah		; set XON or XOFF
    1573/    8B32 : E6 00               	OUT	USARTD,AL
    1574/    8B34 : A2 07 04            	mov	[rx_xflg], al	; update xon/xoff flag
    1575/    8B37 : EB DE               	jmp	gcst5
    1576/    8B39 :                     
    1577/    8B39 :                     ;
    1578/    8B39 :                     ; check console
    1579/    8B39 :                     ; outputt al : key
    1580/    8B39 :                     ;
    1581/    8B39 :                     CONST:
    1582/    8B39 : A0 06 04            	mov	al, [RBFCNT]	;Get count of char
    1583/    8B3C : 0A C0               	or	al, al
    1584/    8B3E : C3                  	RET
    1585/    8B3F :                     
    1586/    8B3F :                     ;
    1587/    8B3F :                     ; output charctor to console
    1588/    8B3F :                     ; input al : char
    1589/    8B3F :                     ;
    1590/    8B3F :                     CONOUT:
    1591/    8B3F : 8A E0               	mov	ah, al		; save char
    1592/    8B41 :                     cnout1:
    1593/    8B41 : 80 3E 08 04 00      	cmp	byte ptr [tx_xflg], 0
    1594/    8B46 : 75 F9               	jne	cnout1
    1595/    8B48 :                     
    1596/    8B48 :                     COUT0:
    1597/    8B48 : E4 01               	IN	AL,USARTC
    1598/    8B4A : 24 01               	AND	AL,01H
    1599/    8B4C : 74 FA               	JZ	COUT0
    1600/    8B4E :                     
    1601/    8B4E : 8A C4               	mov	al, ah		; restore char
    1602/    8B50 : E6 00               	OUT	USARTD,AL
    1603/    8B52 : C3                  	RET
    1604/    8B53 :                     ;
    1605/    8B53 :                     ;	8251 -> buffer by interrupt
    1606/    8B53 :                     ;
    1607/    8B53 : 50                  intsr:	push	ax	;Save ax
    1608/    8B54 : 53                  	push	bx	;Save bx
    1609/    8B55 :                     
    1610/    8B55 : E4 00               	in	al, USARTD	; Get char
    1611/    8B57 :                     
    1612/    8B57 : 3C 13               	cmp	al, XOFF	; get XOFF for tx side from console
    1613/    8B59 : 75 05               	jne	intsr1
    1614/    8B5B :                     
    1615/    8B5B : A2 08 04            	mov	[tx_xflg], al	; set tx stop request
    1616/    8B5E : EB 3B               	jmp	isext		; exit
    1617/    8B60 :                     	
    1618/    8B60 :                     intsr1:
    1619/    8B60 : 3C 11               	cmp	al, XON
    1620/    8B62 : 75 07               	jne	intsr2
    1621/    8B64 :                     
    1622/    8B64 : 32 C0               	xor	al, al
    1623/    8B66 : A2 08 04            	mov	[tx_xflg], al	; clear tx stop request
    1624/    8B69 : EB 30               	jmp	isext		; exit
    1625/    8B6B :                     
    1626/    8B6B :                     intsr2:
    1627/    8B6B : 8A 26 06 04         	mov	ah, [RBFCNT]
    1628/    8B6F : 80 FC F0            	cmp	ah, BUFSIZ
    1629/    8B72 : 74 2A               	je	isext1		;If yes, ignore
    1630/    8B74 :                     
    1631/    8B74 : FE C4               	inc	ah
    1632/    8B76 : 88 26 06 04         	mov	[RBFCNT], ah	;Update
    1633/    8B7A :                     
    1634/    8B7A : 3A 26 00 04         	cmp	ah, [MAXCNT]
    1635/    8B7E : 76 04               	jbe	rec1
    1636/    8B80 : 88 26 00 04         	mov	[MAXCNT], ah	; update max count
    1637/    8B84 :                     rec1:
    1638/    8B84 : 8A 1E 05 04         	mov	bl, [RBFWTP]
    1639/    8B88 : B7 00               	mov	bh, 0
    1640/    8B8A : 88 87 09 04         	mov	[bx+RECBUF], al	;Write char into buffer
    1641/    8B8E :                     
    1642/    8B8E : FE C3               	inc	bl		;Next write point
    1643/    8B90 : 80 FB F0            	cmp	bl, BUFSIZ
    1644/    8B93 : 75 02               	jnz	sv_wtptr
    1645/    8B95 : 32 DB               	xor	bl, bl		;Wrap
    1646/    8B97 :                     ;	and	bl,BUFSIZ-1	;Wrap
    1647/    8B97 :                     sv_wtptr:
    1648/    8B97 : 88 1E 05 04         	mov	[RBFWTP], bl	;Update
    1649/    8B9B :                     
    1650/    8B9B :                     isext:
    1651/    8B9B : 5B                  	pop	bx	;Restore bx
    1652/    8B9C : 58                  	pop	ax	;Restore ax
    1653/    8B9D : CF                  	iret
    1654/    8B9E :                     
    1655/    8B9E :                     isext1:
    1656/    8B9E : FF 06 02 04         	inc	word ptr [LOSTC]
    1657/    8BA2 : EB F7               	jmp	isext
    1658/    8BA4 :                     
    1659/    8BA4 : FF FF FF FF FF FF   	db	($ & 0FF00H)+100H-$ dup(0FFH)
             8BAA : FF FF FF FF FF FF 
             8BB0 : FF FF FF FF FF FF 
             8BB6 : FF FF FF FF FF FF 
             8BBC : FF FF FF FF FF FF 
             8BC2 : FF FF FF FF FF FF 
             8BC8 : FF FF FF FF FF FF 
             8BCE : FF FF FF FF FF FF 
             8BD4 : FF FF FF FF FF FF 
             8BDA : FF FF FF FF FF FF 
             8BE0 : FF FF FF FF FF FF 
             8BE6 : FF FF FF FF FF FF 
             8BEC : FF FF FF FF FF FF 
             8BF2 : FF FF FF FF FF FF 
             8BF8 : FF FF FF FF FF FF 
             8BFE : FF FF             
    1660/    8C00 :                     
    1661/    8C00 :                     	;;
    1662/    8C00 :                     	;; Reset entry point
    1663/    8C00 :                     	;;
    1664/    8C00 :                     	
    1665/    8C00 :                     ;	ORG	( 0FFFF0H - ROMSEG * 16 )
    1666/    FFF0 :                     	ORG	0FFF0H
    1667/    FFF0 :                     
    1668/    FFF0 : EA 00 80 00 00      	JMPF	ROMSEG:CSTART
    1669/    FFF5 :                     	
    1670/    FFF5 :                     ;;;
    1671/    FFF5 :                     ;;; RAM area
    1672/    FFF5 :                     ;;;
    1673/    FFF5 :                     
    1674/       0 :                     	SEGMENT	DATA
    1675/       0 :                     
    1676/       0 :                     	;;
    1677/       0 :                     	;; Work area
    1678/       0 :                     	;;
    1679/       0 :                     
    1680/     400 :                     	ORG	WORK_B
    1681/     400 :                     
    1682/     400 :                     ;
    1683/     400 :                     ;	Receive buffer
    1684/     400 :                     MAXCNT	ds	1
    1685/     401 :                     tsh	ds	1
    1686/     402 :                     LOSTC	ds	2
    1687/     404 :                     RBFRDP	ds	1	;Read address
    1688/     405 :                     RBFWTP	ds	1	;Write address
    1689/     406 :                     RBFCNT	ds	1	;Count of chars
    1690/     407 :                     rx_xflg	ds	1
    1691/     408 :                     tx_xflg	ds	1
    1692/     409 :                     RECBUF	ds	BUFSIZ	;Buffer
    1693/     4F9 :                     
    1694/     4F9 :                     
    1695/     4F9 :                     INBUF:	DS	BUFLEN	; Line input buffer
    1696/     511 :                     CURSEG:	DS	2	; Current segment
    1697/     513 :                     DSADDR:	DS	2	; DUMP start address
    1698/     515 :                     DEADDR:	DS	2	; DUMP end address
    1699/     517 :                     DSTATE:	DS	1	; DUMP state
    1700/     518 :                     	ALIGN	2
    1701/     518 :                     GADDR:	DS	2	; GO address
    1702/     51A :                     SADDR:	DS	2	; SET address
    1703/     51C :                     HEXMOD:	DS	1	; HEX file mode
    1704/     51D :                     PSPEC:	DS	1	; Processor spec.
    1705/     51E :                     
    1706/     51E :                     RECTYP:	DS	1	; Record type
    1707/     51F :                     
    1708/     51F :                     	ALIGN	2
    1709/     520 :                     REG_B:	
    1710/     520 :                     REGAX:	DS	2
    1711/     522 :                     REGBX:	DS	2
    1712/     524 :                     REGCX:	DS	2
    1713/     526 :                     REGDX:	DS	2
    1714/     528 :                     REGF:	DS	2
    1715/     52A :                     REGSP:	DS	2		; Stack Pointer SP
    1716/     52C :                     REGBP:	DS	2		; Base Pointer BP
    1717/     52E :                     REGSI:	DS	2		; Source Index SI
    1718/     530 :                     REGDI:	DS	2		; Destination Index DI
    1719/     532 :                     REGIP:	DS	2		; Instruction Pointer IP
    1720/     534 :                     REGCS:	DS	2		; Code Segment CS
    1721/     536 :                     REGDS:	DS	2		; Data Segment DS
    1722/     538 :                     REGSS:	DS	2		; Stack Segment SS
    1723/     53A :                     REGES:	DS	2		; Extra Segment ES
    1724/     53C :                     REG_E:	
    1725/     53C :                     
    1726/     53C :                     ; break point
    1727/     53C :                     bflg	ds	1
    1728/     53D :                     bp_code	ds	1
    1729/     53E :                     brkcs	ds	2
    1730/     540 :                     brkip	ds	2
    1731/     542 :                     
    1732/     542 :                     ; Frag register bit image string buffer
    1733/     542 :                     F_bit:		ds	F_bitSize+1
    1734/     553 :                     
    1735/     553 :                     	END
 AS V1.42 Beta [Bld 227] - Source File unimon_8086_INTR.asm - Page 2 - 1/10/2024 10:36:18


  Symbol Table (* = unused):
  --------------------------

*ARCHITECTURE :                                        "i386-unknown-win32" - |
 BFLG :                         53C D |  BP_CODE :                      53D D |
 BRKCS :                        53E D |  BRKIP :                        540 D |
 BRKMSG :                      88D2 C |  BS :                             8 - |
 BUFLEN :                        18 - |  BUFSIZ :                       0F0 - |
*CASESENSITIVE :                  0 - |  CHK_BPT :                     87C3 C |
 CHK_XON :                     8B1C C |  CNOUT1 :                      8B41 C |
*COMPMODE :                       0 - |  CONIN :                       8AD9 C |
 CONOUT :                      8B3F C |  CONST :                       8B39 C |
*CONSTPI :        3.141592653589793 - |  COUT0 :                       8B48 C |
 CPUM :                        8871 C |  CR :                            0D - |
 CRLF :                        8650 C |  CSTART :                      8000 C |
 CURSEG :                       511 D | *DATE :                 "1/10/2024" - |
 DEADDR :                       515 D |  DEL :                           7F - |
 DIVMSG :                      88B6 C |  DP0 :                         8174 C |
 DP01 :                        8186 C |  DP1 :                         819E C |
 DPB :                         822F C |  DPB0 :                        8241 C |
 DPB1 :                        8250 C |  DPB2 :                        8255 C |
 DPB3 :                        8271 C |  DPL :                         81E8 C |
 DPL0 :                        8204 C |  DPL1 :                        8215 C |
 DPL2 :                        8225 C |  DPL3 :                        822A C |
 DPM :                         81B4 C |  DPM0 :                        81C4 C |
 DPM1 :                        81DE C |  DSADDR :                       513 D |
 DSEP0 :                       883B C |  DSEP1 :                       883E C |
 DSTATE :                       517 D |  DUMP :                        8157 C |
 ERR :                         814F C |  ERRMSG :                      8833 C |
*FALSE :                          0 - |  FBITON :                      896D C |
 FB_LOOP :                     8564 C |  FLGB :                        8967 C |
*FULLPMMU :                       1 - |  FULSIZ :                        30 - |
 F_BIT :                        542 D |  F_BITSIZE :                     10 - |
 F_MSK_BIT :                   0FD5 - |  G0 :                          8291 C |
 G0_0 :                        82BF C |  G1 :                          8298 C |
 G2 :                          82AD C |  GADDR :                        518 D |
 GCST1 :                       8ADB C |  GCST2 :                       8B2A C |
 GCST5 :                       8B17 C |  GE :                          82AA C |
 GETLIN :                      865A C |  GL0 :                         865F C |
 GLB :                         8689 C |  GLE :                         86A1 C |
 GO :                          8272 C |  GO_ANYWHERE :                 82EA C |
 GO_GO :                       82CF C | *HAS64 :                          0 - |
*HASFPU :                         0 - | *HASPMMU :                        0 - |
 HEXIN :                       8624 C |  HEXMOD :                       51C D |
 HEXOUT1 :                     8617 C |  HEXOUT2 :                     860A C |
 HEXOUT4 :                     8603 C |  HI0 :                         8631 C |
 HI1 :                         864B C |  HIR :                         864F C |
 HO10 :                        8621 C | *IBIT_OFF :                    0DD5 - |
 IDE :                         8102 C |  ID_286 :                      80E2 C |
 ID_386 :                      80F6 C |  ID_UNK :                      80FD C |
 ID_V30 :                      80DB C |  IHEMSG :                      8819 C |
*IHEXER :                      8842 C | *IM186 :                       8884 C |
 IM286 :                       889C C |  IM386 :                       88A4 C |
 IM86 :                        8878 C |  IMUNK :                       88AC C |
 IMV30 :                       8892 C |  INBUF :                        4F9 D |
 INI0 :                        806F C |  INI1 :                        8088 C |
 INI2 :                        8096 C |  INIT :                        8A9C C |
 INIT_FL_ :                     200 - |  INIVEC :                      885D C |
 INIVECE :                     8871 C | *INSUPMODE :                      0 - |
 INT0 :                        8788 C |  INT21VEC :                      84 - |
 INTBRK :                      875D C |  INTDIV :                      8731 C |
 INTDMY :                      87E2 C |  INTFFVEC :                     3FC - |
 INTFNC :                      86EE C |  INTOVF :                      8774 C |
 INTSR :                       8B53 C |  INTSR1 :                      8B60 C |
 INTSR2 :                      8B6B C |  INTSTP :                      8747 C |
 IR0 :                         8035 C |  ISEXT :                       8B9B C |
 ISEXT1 :                      8B9E C |  LF :                            0A - |
 LH0 :                         83C8 C |  LH1 :                         83CA C |
 LH2 :                         83D6 C |  LH3 :                         83E9 C |
 LHE :                         83F6 C |  LHI0 :                        83F9 C |
 LHI1 :                        841E C |  LHI2 :                        842F C |
 LHI3 :                        8433 C |  LHIE :                        8447 C |
 LHS0 :                        8450 C |  LHS1 :                        8476 C |
 LHS2 :                        8488 C |  LHS3 :                        848C C |
 LHSE :                        849F C |  LHSR :                        8441 C |
*LISTON :                         1 - |  LOADH :                       83AC C |
 LOSTC :                        402 D |  M00 :                         812C C |
 M01 :                         8133 C |  M02 :                         813A C |
 M03 :                         8141 C |  M05 :                         8148 C |
 M06 :                         814F C | *MACEXP :                         7 - |
 MAXCNT :                       400 D | *MOMCPU :                      8086 - |
*MOMCPUNAME :                "8086" - |  MSGOE :                       85F5 C |
 MSGOUT :                      85E8 C |  NEED_XON :                    8B27 C |
*NESTMAX :                      100 - |  NFNC1 :                       86FF C |
 NFNC2 :                       870A C |  NFNC3 :                       8717 C |
*NFNC31 :                      8726 C |  NFNC4 :                       8716 C |
*NMIMSG :                      88CC C |  NOBRKP :                      87DE C |
 OPNMSG :                      87E3 C |  OVFMSG :                      88DA C |
*PADDING :                        1 - |  PROMPT :                      8816 C |
 PSPEC :                        51D D |  RAMSEG :                         0 - |
 RBFCNT :                       406 D |  RBFRDP :                       404 D |
 RBFWTP :                       405 D |  RBLOW :                         0A - |
 RD0 :                         8538 C |  RD1 :                         8550 C |
 RDF1 :                        856D C |  RDF2 :                        8571 C |
 RDHEX :                       86BE C |  RDSAX :                       8921 C |
 RDSBP :                       8953 C |  RDSBX :                       8925 C |
 RDSCS :                       8939 C |  RDSCX :                       892A C |
 RDSDI :                       895D C |  RDSDS :                       893E C |
 RDSDX :                       892F C |  RDSES :                       8948 C |
 RDSF :                        8934 C |  RDSIP :                       8962 C |
 RDSSI :                       8958 C |  RDSSP :                       894D C |
 RDSSS :                       8943 C |  RDTAB :                       88E5 C |
 RDUMP :                       8535 C |  REC1 :                        8B84 C |
 RECBUF :                       409 D |  RECTYP :                       51E D |
 REG :                         84A8 C |  REGAX :                        520 D |
 REGBP :                        52C D |  REGBX :                        522 D |
 REGCS :                        534 D |  REGCX :                        524 D |
 REGDI :                        530 D |  REGDS :                        536 D |
 REGDX :                        526 D |  REGES :                        53A D |
 REGF :                         528 D |  REGIP :                        532 D |
 REGSI :                        52E D |  REGSP :                        52A D |
 REGSS :                        538 D |  REG_B :                        520 D |
 REG_E :                        53C D | *RELAXED :                        0 - |
 RG0 :                         84B9 C |  RG1 :                         84BC C |
 RG2 :                         84CE C |  RG3 :                         84E2 C |
 RG4 :                         850B C |  RG5 :                         8510 C |
 RG6 :                         852D C |  RG7 :                         852F C |
 RGE :                         8532 C |  RGR :                         852F C |
 RH0 :                         86C5 C |  RH1 :                         86DC C |
 RHE :                         86ED C |  RNAH :                        8A5E C |
 RNAL :                        8A61 C |  RNAX :                        8A5B C |
 RNBH :                        8A67 C |  RNBL :                        8A6A C |
 RNBP :                        8A6D C |  RNBX :                        8A64 C |
 RNCH :                        8A73 C |  RNCL :                        8A76 C |
 RNCS :                        8A79 C |  RNCX :                        8A70 C |
 RNDH :                        8A7F C |  RNDI :                        8A85 C |
 RNDL :                        8A82 C |  RNDS :                        8A88 C |
 RNDX :                        8A7C C |  RNES :                        8A8B C |
 RNF :                         8A8E C |  RNIP :                        8A90 C |
 RNSI :                        8A93 C |  RNSP :                        8A96 C |
 RNSS :                        8A99 C |  RNTAB :                       897D C |
 RNTABA :                      89B3 C |  RNTABB :                      89CB C |
 RNTABC :                      89E9 C |  RNTABD :                      8A07 C |
*RNTABE :                      8A2B C |  RNTABI :                      8A37 C |
 RNTABS :                      8A43 C |  ROMSEG :                         0 - |
 ROM_B :                       8000 - |  RX_XFLG :                      407 D |
 SADDR :                        51A D |  SETM :                        8322 C |
 SHEMSG :                      8826 C |  SKIPSP :                      86A9 C |
 SM0 :                         833C C |  SM1 :                         8349 C |
 SM2 :                         8386 C |  SM3 :                         8391 C |
 SM4 :                         8398 C |  SME :                         83A9 C |
*SRECER :                      8850 C |  SSR :                         86B2 C |
 STACK :                        600 - |  STPMSG :                      88C5 C |
 STROE :                       8602 C |  STROUT :                      85F6 C |
 SV_RDPTR :                    8B00 C |  SV_WTPTR :                    8B97 C |
 T0 :                          859D C |  T1 :                          85A4 C |
*TARGET :                    "8088" - |  TBIT_OFF :                    0ED5 - |
 TBIT_ON_ :                     100 - |  TE :                          85AA C |
*TIME :                  "10:36:18" - |  TO_GO :                       85AD C |
 TRACE :                       8583 C | *TRUE :                           1 - |
 TSH :                          401 D |  TX_XFLG :                      408 D |
 UPPER :                       86B3 C |  UPR :                         86BD C |
 USARTC :                         1 - |  USARTD :                         0 - |
 USE_IDENT :                      1 - |  U_STACK :                      700 - |
 VECSIZ :                       100 - | *VERSION :                     142F - |
 WORK_B :                       400 - |  WSTART :                      8110 C |
 XOFF :                          13 - |  XON :                           11 - |

    307 symbols
     29 unused symbols

 AS V1.42 Beta [Bld 227] - Source File unimon_8086_INTR.asm - Page 3 - 1/10/2024 10:36:18


  Code Pages:
  ----------

STANDARD (0 changed characters)

1 code page

0.05 seconds assembly time

   1737 lines source file
      3 passes
      0 errors
      0 warnings
