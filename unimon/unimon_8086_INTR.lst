 AS V1.42 Beta [Bld 227] - Source File unimon_8086_INTR.asm - Page 1 - 3/4/2023 17:5:23


       1/       0 :                     	page 0
       2/       0 :                     ;;;
       3/       0 :                     ;;; Universal Monitor 8086
       4/       0 :                     ;;;   Copyright (C) 2020 Haruo Asano
       5/       0 :                     ;;;
       6/       0 :                     
       7/       0 :                     	CPU	8086
       8/       0 :                     
       9/       0 : ="8088"              TARGET:	EQU	"8088"
      10/       0 :                     
      11/       0 :                     ;;;
      12/       0 :                     ;;; Memory
      13/       0 :                     ;;;
      14/       0 :                     
      15/       0 : =0H                  ROMSEG:	EQU	00000H		; CSEG
      16/       0 : =8000H               ROM_B:	EQU	08000H
      17/       0 :                     
      18/       0 : =0H                  RAMSEG:	EQU	0000H		; DSEG & SSEG
      19/       0 :                     
      20/       0 : =400H                WORK_B:	EQU	400H	; unimon work area 400h - 500h
      21/       0 : =600H                STACK:	EQU	600H	; unimon stack area 600h - 680h
      22/       0 : =700H                U_STACK	EQU	STACK+100H	; 700H
      23/       0 : =18H                 BUFLEN:	EQU	24
      24/       0 : =100H                VECSIZ:	EQU	256		; Number of vectors to be initialized
      25/       0 :                     
      26/       0 : =84H                 int21vec:	equ	21H * 4 ; INT 21H Vector table offset
      27/       0 : =3FCH                intFFvec:	equ	0ffH *4 ; 8251 Vector table offset
      28/       0 :                     ;;;
      29/       0 :                     ;;; Options
      30/       0 :                     ;;;
      31/       0 :                     
      32/       0 : =1H                  USE_IDENT = 1			; CPU Identification
      33/       0 :                     	
      34/       0 :                     ;;;
      35/       0 :                     ;;; Intel 8251
      36/       0 :                     ;;;
      37/       0 :                     
      38/       0 : =0H                  USARTD:	EQU	00H
      39/       0 : =1H                  USARTC:	EQU	01H
      40/       0 :                     	
      41/       0 :                     ;;; Constants
      42/       0 : =0DH                 CR:	EQU	0DH
      43/       0 : =0AH                 LF:	EQU	0AH
      44/       0 : =8H                  BS:	EQU	08H
      45/       0 : =7FH                 DEL:	EQU	7FH
      46/       0 :                     
      47/       0 : =11H                 XON  	equ	11h		; code DC1
      48/       0 : =13H                 XOFF	equ	13h		; code DC3
      49/       0 : =0F0H                BUFSIZ	equ	240
      50/       0 : =30H                 FULSIZ	equ	BUFSIZ-192	;Buffer almost full
      51/       0 : =0AH                 RBLOW	equ	10
      52/       0 :                     
      53/       0 :                     
      54/       0 : =10H                 F_bitSize	equ	16
      55/       0 : =0FD5H               f_msk_bit	equ	0000111111010101b
      56/       0 :                     
      57/       0 : =100H                Tbit_ON_	equ	0000000100000000b
      58/       0 : =0ED6H               Tbit_OFF	equ	0000111011010110b
      59/       0 :                     
      60/       0 : =202H                INIT_FL_	equ	0000001000000010b		; init user FL value
      61/       0 : =0DD6H               IBIT_OFF	equ	0000110111010110b
      62/       0 :                     
      63/       0 :                     	ASSUME	CS:CODE, DS:DATA, SS:DATA, ES:NOTHING
      64/       0 :                     
      65/       0 :                     ;;;
      66/       0 :                     ;;; ROM area
      67/       0 :                     ;;;
      68/       0 :                     
      69/       0 :                     	SEGMENT	CODE
      70/       0 :                     	
      71/    8000 :                     	ORG	ROM_B
      72/    8000 :                     
      73/    8000 :                     CSTART:
      74/    8000 : B8 00 00            	MOV	AX,RAMSEG
      75/    8003 : 8E D8               	MOV	DS,AX
      76/    8005 : 8E D0               	MOV	SS,AX
      77/    8007 : BC 00 06            	MOV	SP,STACK
      78/    800A :                     
      79/    800A :                     	;; 
      80/    800A :                     	
      81/    800A : E8 8F 0A            	CALL	INIT
      82/    800D :                     
      83/    800D : B8 00 00            	MOV	AX,RAMSEG
      84/    8010 : A3 11 05            	MOV	[CURSEG],AX
      85/    8013 : =>TRUE               	IF RAMSEG = 0
      86/    8013 : B8 00 04            	MOV	AX,VECSIZ*4
      87/    8016 : =>FALSE              	ELSE
      88/    8016 :                     	XOR	AX,AX
      89/    8016 : [85]                 	ENDIF
      90/    8016 : A3 13 05            	MOV	[DSADDR],AX
      91/    8019 : A3 18 05            	MOV	[GADDR],AX
      92/    801C : A3 1A 05            	MOV	[SADDR],AX
      93/    801F : B0 49               	MOV	AL,'I'
      94/    8021 : A2 1C 05            	MOV	[HEXMOD],AL
      95/    8024 : 32 C0               	XOR	AL,AL
      96/    8026 : A2 1D 05            	MOV	[PSPEC],AL
      97/    8029 :                     
      98/    8029 :                     	; init break point
      99/    8029 : A2 3C 05            	mov	[bflg], al	; clear break flag
     100/    802C : 90                  	nop
     101/    802D :                     	;; Initialize register value
     102/    802D : 33 C0               	XOR	AX,AX
     103/    802F : BB 20 05            	MOV	BX,REG_B
     104/    8032 : B9 0E 00            	MOV	CX,(REG_E - REG_B)/2
     105/    8035 :                     IR0:
     106/    8035 : 89 07               	MOV	[BX],AX
     107/    8037 : 43                  	INC	BX
     108/    8038 : 43                  	INC	BX
     109/    8039 : 49                  	DEC	CX
     110/    803A : 75 F9               	JNE	IR0
     111/    803C :                     
     112/    803C : B8 00 00            	mov	ax, ROMSEG
     113/    803F : A3 34 05            	mov	[REGCS], ax
     114/    8042 :                     	; init break point segment
     115/    8042 : A3 3E 05            	mov	[brkcs], ax
     116/    8045 :                     
     117/    8045 : B8 00 07            	mov	ax, U_STACK
     118/    8048 : A3 32 05            	mov	[REGIP], ax
     119/    804B :                     	; init break point ip
     120/    804B : A3 40 05            	mov	[brkip], ax
     121/    804E :                     
     122/    804E : B8 00 00            	MOV	AX,RAMSEG
     123/    8051 : A3 36 05            	MOV	[REGDS],AX
     124/    8054 : A3 38 05            	MOV	[REGSS],AX
     125/    8057 : B8 00 07            	MOV	AX,U_STACK
     126/    805A : A3 2A 05            	MOV	[REGSP],AX
     127/    805D :                     
     128/    805D :                     	; init user FL : set interrupt (sti)
     129/    805D : B8 02 02            	mov	ax, INIT_FL_
     130/    8060 : A3 28 05            	mov	[REGF], ax
     131/    8063 :                     
     132/    8063 :                     	;; Initialize vector
     133/    8063 : 33 C0               	XOR	AX,AX
     134/    8065 : 8E C0               	MOV	ES,AX
     135/    8067 : BE 5D 88            	MOV	SI,INIVEC
     136/    806A : 8B F8               	MOV	DI,AX
     137/    806C : B9 00 02            	MOV	CX,VECSIZ*2
     138/    806F :                     INI0:	
     139/    806F : 2E 8B 04            	MOV	AX,CS:[SI]
     140/    8072 : 46                  	INC	SI
     141/    8073 : 46                  	INC	SI
     142/    8074 : 26 89 05            	MOV	ES:[DI],AX
     143/    8077 : 47                  	INC	DI
     144/    8078 : 47                  	INC	DI
     145/    8079 : 49                  	DEC	CX
     146/    807A : 74 1A               	JZ	INI2
     147/    807C : 81 FE 71 88         	CMP	SI,INIVECE
     148/    8080 : 75 ED               	JNZ	INI0
     149/    8082 : B8 E2 87            	MOV	AX,INTDMY
     150/    8085 : BB 00 00            	MOV	BX,ROMSEG
     151/    8088 :                     INI1:
     152/    8088 : 26 89 05            	MOV	ES:[DI],AX
     153/    808B : 47                  	INC	DI
     154/    808C : 47                  	INC	DI
     155/    808D : 26 89 1D            	MOV	ES:[DI],BX
     156/    8090 : 47                  	INC	DI
     157/    8091 : 47                  	INC	DI
     158/    8092 : 49                  	DEC	CX
     159/    8093 : 49                  	DEC	CX
     160/    8094 : 75 F2               	JNZ	INI1
     161/    8096 :                     INI2:
     162/    8096 :                     	; init INT 21H
     163/    8096 : BF 84 00            	mov	di, int21vec
     164/    8099 : B8 EE 86            	mov	ax, INTFNC
     165/    809C : 89 05               	mov	[di], ax
     166/    809E :                     
     167/    809E :                     	
     168/    809E :                     	; init INT FFH (8251 RXD)
     169/    809E :                     
     170/    809E : BF FC 03            	mov	di, intFFvec
     171/    80A1 : B8 53 8B            	mov	ax, intsr
     172/    80A4 : 89 05               	mov	[di], ax
     173/    80A6 :                     
     174/    80A6 : C6 06 01 04 30      	mov	byte ptr [tsh], FULSIZ
     175/    80AB : FB                  	sti	; enable interrupt
     176/    80AC :                     
     177/    80AC :                     	;; Opening message
     178/    80AC : BB E3 87            	MOV	BX,OPNMSG
     179/    80AF : E8 36 05            	CALL	MSGOUT
     180/    80B2 :                     
     181/    80B2 : =>TRUE               	IF USE_IDENT
     182/    80B2 :                     
     183/    80B2 : 9C                  	PUSHF			; Begin: (from Application Note 485)
     184/    80B3 : 58                  	POP	AX
     185/    80B4 : 8B C8               	MOV	CX,AX
     186/    80B6 : 25 FF 0F            	AND	AX,0FFFH
     187/    80B9 : 50                  	PUSH	AX
     188/    80BA : 9D                  	POPF
     189/    80BB : 9C                  	PUSHF
     190/    80BC : 58                  	POP	AX
     191/    80BD : 25 00 F0            	AND	AX,0F000H
     192/    80C0 : 3D 00 F0            	CMP	AX,0F000H
     193/    80C3 : 75 1D               	JNE	ID_286
     194/    80C5 :                     
     195/    80C5 : 54                  	PUSH	SP
     196/    80C6 : 5A                  	POP	DX
     197/    80C7 : 3B D4               	CMP	DX,SP
     198/    80C9 : 74 32               	JE	ID_UNK		; End:
     199/    80CB :                     
     200/    80CB : B8 00 01            	MOV	AX,0100H
     201/    80CE : D5 00               	DB	0D5H,00H	; AAD 00H
     202/    80D0 : 0A C0               	OR	AL,AL
     203/    80D2 : 75 07               	JNE	ID_V30
     204/    80D4 :                     	;; 8086/80186
     205/    80D4 : B0 11               	MOV	AL,11H
     206/    80D6 : BB 78 88            	MOV	BX,IM86
     207/    80D9 : EB 27               	JMP	IDE
     208/    80DB :                     ID_V30:
     209/    80DB :                     	;; V30
     210/    80DB : B0 14               	MOV	AL,14H
     211/    80DD : BB 92 88            	MOV	BX,IMV30
     212/    80E0 : EB 20               	JMP	IDE
     213/    80E2 :                     ID_286:
     214/    80E2 : 81 C9 00 F0         	OR	CX,0F000H	; Begin: (from Application Note 485)
     215/    80E6 : 51                  	PUSH	CX
     216/    80E7 : 9D                  	POPF
     217/    80E8 : 9C                  	PUSHF
     218/    80E9 : 58                  	POP	AX
     219/    80EA : 25 00 F0            	AND	AX,0F000H
     220/    80ED : 75 07               	JNE	ID_386		; End
     221/    80EF :                     	;; 80286
     222/    80EF : B0 31               	MOV	AL,31H
     223/    80F1 : BB 9C 88            	MOV	BX,IM286
     224/    80F4 : EB 0C               	JMP	IDE
     225/    80F6 :                     ID_386:
     226/    80F6 :                     	;; 80386
     227/    80F6 : B0 71               	MOV	AL,71H
     228/    80F8 : BB A4 88            	MOV	BX,IM386
     229/    80FB : EB 05               	JMP	IDE
     230/    80FD :                     	;; Unknown
     231/    80FD :                     ID_UNK:
     232/    80FD : 32 C0               	XOR	AL,AL
     233/    80FF : BB AC 88            	MOV	BX,IMUNK
     234/    8102 :                     IDE:
     235/    8102 : A2 1D 05            	MOV	[PSPEC],AL
     236/    8105 : 53                  	push	bx
     237/    8106 : BB 71 88            	mov	bx, cpum
     238/    8109 : E8 DC 04            	CALL	MSGOUT
     239/    810C : 5B                  	pop	bx
     240/    810D : E8 D8 04            	CALL	MSGOUT
     241/    8110 :                     	
     242/    8110 : [181]                	ENDIF
     243/    8110 :                     	
     244/    8110 :                     WSTART:
     245/    8110 : BB 16 88            	MOV	BX,PROMPT
     246/    8113 : E8 D2 04            	CALL	MSGOUT
     247/    8116 : E8 41 05            	CALL	GETLIN
     248/    8119 : BB F9 04            	MOV	BX,INBUF
     249/    811C : E8 8A 05            	CALL	SKIPSP
     250/    811F : E8 91 05            	CALL	UPPER
     251/    8122 : 22 C0               	AND	AL,AL
     252/    8124 : 74 EA               	JZ	WSTART
     253/    8126 :                     
     254/    8126 : 3C 44               	CMP	AL,'D'
     255/    8128 : 75 02               	JNE	M00
     256/    812A : EB 2B               	JMP	DUMP
     257/    812C :                     M00:	
     258/    812C : 3C 47               	CMP	AL,'G'
     259/    812E : 75 03               	JNE	M01
     260/    8130 : E9 3F 01            	JMP	GO
     261/    8133 :                     M01:
     262/    8133 : 3C 53               	CMP	AL,'S'
     263/    8135 : 75 03               	JNE	M02
     264/    8137 : E9 E8 01            	JMP	SETM
     265/    813A :                     
     266/    813A :                     M02:	
     267/    813A : 3C 4C               	CMP	AL,'L'
     268/    813C : 75 03               	JNE	M03
     269/    813E : E9 6B 02            	JMP	LOADH
     270/    8141 :                     M03:
     271/    8141 :                     
     272/    8141 : 3C 52               	CMP	AL,'R'
     273/    8143 : 75 03               	JNE	M05
     274/    8145 : E9 60 03            	JMP	REG
     275/    8148 :                     
     276/    8148 :                     M05:
     277/    8148 : 3C 54               	CMP	AL,'T'
     278/    814A : 75 03               	JNE	M06
     279/    814C : E9 34 04            	JMP	Trace
     280/    814F :                     
     281/    814F :                     M06:
     282/    814F :                     ERR:
     283/    814F : BB 33 88            	MOV	BX,ERRMSG
     284/    8152 : E8 93 04            	CALL	MSGOUT
     285/    8155 : EB B9               	JMP	WSTART
     286/    8157 :                     
     287/    8157 :                     ;;;
     288/    8157 :                     ;;; DUMP memory
     289/    8157 :                     ;;;
     290/    8157 :                     
     291/    8157 :                     DUMP:
     292/    8157 : 43                  	INC	BX
     293/    8158 : E8 63 05            	CALL	RDHEX
     294/    815B : 0A C9               	OR	CL,CL
     295/    815D : 75 15               	JNZ	DP0
     296/    815F :                     	;; No arg.
     297/    815F : E8 47 05            	CALL	SKIPSP
     298/    8162 : 0A C0               	OR	AL,AL
     299/    8164 : 75 E9               	JNZ	ERR
     300/    8166 :                     
     301/    8166 : 8B 16 13 05         	MOV	DX,[DSADDR]
     302/    816A : 81 C2 80 00         	ADD	DX,128
     303/    816E : 89 16 15 05         	MOV	[DEADDR],DX
     304/    8172 : EB 40               	JMP	DPM
     305/    8174 :                     
     306/    8174 :                     	;; 1st arg. found
     307/    8174 :                     DP0:
     308/    8174 : 8A 07               	MOV	AL,[BX]
     309/    8176 : 3C 3A               	CMP	AL,':'
     310/    8178 : 75 0C               	JNZ	DP01
     311/    817A : 89 16 11 05         	MOV	[CURSEG],DX
     312/    817E : 43                  	INC	BX
     313/    817F : E8 3C 05            	CALL	RDHEX
     314/    8182 : 0A C9               	OR	CL,CL
     315/    8184 : 74 C9               	JZ	ERR
     316/    8186 :                     DP01:	
     317/    8186 : 89 16 13 05         	MOV	[DSADDR],DX
     318/    818A : 8A 07               	MOV	AL,[BX]
     319/    818C : 3C 2C               	CMP	AL,','
     320/    818E : 74 0E               	JZ	DP1
     321/    8190 : 0A C0               	OR	AL,AL
     322/    8192 : 75 BB               	JNZ	ERR
     323/    8194 :                     	;; No 2nd arg.
     324/    8194 : 81 C2 80 00         	ADD	DX,128
     325/    8198 : 89 16 15 05         	MOV	[DEADDR],DX
     326/    819C : EB 16               	JMP	DPM
     327/    819E :                     DP1:
     328/    819E : 43                  	INC	BX
     329/    819F : E8 1C 05            	CALL	RDHEX
     330/    81A2 : E8 04 05            	CALL	SKIPSP
     331/    81A5 : 0A C9               	OR	CL,CL
     332/    81A7 : 74 A6               	JZ	ERR
     333/    81A9 : 8A 07               	MOV	AL,[BX]
     334/    81AB : 0A C0               	OR	AL,AL
     335/    81AD : 75 A0               	JNZ	ERR
     336/    81AF : 42                  	INC	DX
     337/    81B0 : 89 16 15 05         	MOV	[DEADDR],DX
     338/    81B4 :                     DPM:
     339/    81B4 :                     	;; DUMP main
     340/    81B4 : 8E 06 11 05         	MOV	ES,[CURSEG]
     341/    81B8 : 8B 36 13 05         	MOV	SI,[DSADDR]
     342/    81BC : 83 E6 F0            	AND	SI,0FFF0H
     343/    81BF : 32 C0               	XOR	AL,AL
     344/    81C1 : A2 17 05            	MOV	[DSTATE],AL
     345/    81C4 :                     DPM0:
     346/    81C4 : E8 21 00            	CALL	DPL
     347/    81C7 : E8 6F 09            	CALL	CONST
     348/    81CA : 75 12               	JNZ	DPM1
     349/    81CC : A0 17 05            	MOV	AL,[DSTATE]
     350/    81CF : 3C 02               	CMP	AL,2
     351/    81D1 : 72 F1               	JC	DPM0
     352/    81D3 : 8B 1E 15 05         	MOV	BX,[DEADDR]
     353/    81D7 : 89 1E 13 05         	MOV	[DSADDR],BX
     354/    81DB : E9 32 FF            	JMP	WSTART
     355/    81DE :                     DPM1:
     356/    81DE : 89 36 13 05         	MOV	[DSADDR],SI
     357/    81E2 : E8 F4 08            	CALL	CONIN
     358/    81E5 : E9 28 FF            	JMP	WSTART
     359/    81E8 :                     
     360/    81E8 :                     DPL:
     361/    81E8 :                     	;; DUMP	line
     362/    81E8 : A1 11 05            	MOV	AX,[CURSEG]
     363/    81EB : E8 15 04            	CALL	HEXOUT4
     364/    81EE : B0 3A               	MOV	AL,':'
     365/    81F0 : E8 4C 09            	CALL	CONOUT
     366/    81F3 : 8B C6               	MOV	AX,SI
     367/    81F5 : E8 0B 04            	CALL	HEXOUT4
     368/    81F8 : BB 3B 88            	MOV	BX,DSEP0
     369/    81FB : E8 EA 03            	CALL	MSGOUT
     370/    81FE : BF F9 04            	MOV	DI,INBUF
     371/    8201 : B9 10 00            	MOV	CX,16
     372/    8204 :                     DPL0:
     373/    8204 : E8 28 00            	CALL	DPB
     374/    8207 : E2 FB               	LOOP	DPL0
     375/    8209 :                     
     376/    8209 : BB 3E 88            	MOV	BX,DSEP1
     377/    820C : E8 D9 03            	CALL	MSGOUT
     378/    820F :                     
     379/    820F : BF F9 04            	MOV	DI,INBUF
     380/    8212 : B9 10 00            	MOV	CX,16
     381/    8215 :                     DPL1:
     382/    8215 : 8A 05               	MOV	AL,[DI]
     383/    8217 : 47                  	INC	DI
     384/    8218 : 3C 20               	CMP	AL,' '
     385/    821A : 72 09               	JC	DPL2
     386/    821C : 3C 7F               	CMP	AL,7FH
     387/    821E : 73 05               	JNC	DPL2
     388/    8220 : E8 1C 09            	CALL	CONOUT
     389/    8223 : EB 05               	JMP	DPL3
     390/    8225 :                     DPL2:
     391/    8225 : B0 2E               	MOV	AL,'.'
     392/    8227 : E8 15 09            	CALL	CONOUT
     393/    822A :                     DPL3:
     394/    822A : E2 E9               	LOOP	DPL1
     395/    822C : E9 21 04            	JMP	CRLF
     396/    822F :                     
     397/    822F :                     DPB:
     398/    822F :                     	;; DUMP byte
     399/    822F : B0 20               	MOV	AL,' '
     400/    8231 : E8 0B 09            	CALL	CONOUT
     401/    8234 : A0 17 05            	MOV	AL,[DSTATE]
     402/    8237 : 0A C0               	OR	AL,AL
     403/    8239 : 75 1A               	JNZ	DPB2
     404/    823B :                     	;; State 0
     405/    823B : 3B 36 13 05         	CMP	SI,[DSADDR]
     406/    823F : 74 0F               	JZ	DPB1
     407/    8241 :                     DPB0:
     408/    8241 :                     	;; Still 0 or 2
     409/    8241 : B0 20               	MOV	AL,' '
     410/    8243 : 88 05               	MOV	[DI],AL
     411/    8245 : E8 F7 08            	CALL	CONOUT
     412/    8248 : B0 20               	MOV	AL,' '
     413/    824A : E8 F2 08            	CALL	CONOUT
     414/    824D : 46                  	INC	SI
     415/    824E : 47                  	INC	DI
     416/    824F : C3                  	RET
     417/    8250 :                     DPB1:
     418/    8250 :                     	;; Found start address
     419/    8250 : B0 01               	MOV	AL,1
     420/    8252 : A2 17 05            	MOV	[DSTATE],AL
     421/    8255 :                     DPB2:
     422/    8255 : A0 17 05            	MOV	AL,[DSTATE]
     423/    8258 : 3C 01               	CMP	AL,1
     424/    825A : 75 E5               	JNZ	DPB0		; state 2
     425/    825C :                     	;; DUMP state 1
     426/    825C : 26 8A 04            	MOV	AL,ES:[SI]
     427/    825F : 88 05               	MOV	[DI],AL
     428/    8261 : E8 A6 03            	CALL	HEXOUT2
     429/    8264 : 46                  	INC	SI
     430/    8265 : 47                  	INC	DI
     431/    8266 :                     
     432/    8266 : 3B 36 15 05         	CMP	SI,[DEADDR]
     433/    826A : 75 05               	JNZ	DPB3
     434/    826C :                     	;; Found end address
     435/    826C : B0 02               	MOV	AL,2
     436/    826E : A2 17 05            	MOV	[DSTATE],AL
     437/    8271 :                     DPB3:
     438/    8271 : C3                  	RET
     439/    8272 :                     
     440/    8272 :                     ;;;
     441/    8272 :                     ;;; GO address
     442/    8272 :                     ;;; 
     443/    8272 :                     
     444/    8272 :                     GO:
     445/    8272 : 32 C0               	xor 	al, al
     446/    8274 : A2 3C 05            	mov	[bflg], al
     447/    8277 :                     
     448/    8277 : 43                  	INC	BX
     449/    8278 : E8 43 04            	CALL	RDHEX
     450/    827B : 0A C9               	OR	CL,CL
     451/    827D : 74 19               	JZ	G1
     452/    827F : 8A 07               	MOV	AL,[BX]
     453/    8281 : 3C 3A               	CMP	AL,':'
     454/    8283 : 75 0C               	JNE	G0
     455/    8285 :                     
     456/    8285 : 89 16 34 05         	MOV	[REGCS],DX
     457/    8289 : 43                  	INC	BX
     458/    828A : E8 31 04            	CALL	RDHEX
     459/    828D : 0A C9               	OR	CL,CL
     460/    828F : 74 19               	JZ	GE
     461/    8291 :                     G0:
     462/    8291 : 89 16 32 05         	MOV	[REGIP],DX
     463/    8295 : E8 11 04            	CALL	SKIPSP
     464/    8298 :                     G1:
     465/    8298 : 8A 07               	MOV	AL,[BX]
     466/    829A : 0A C0               	or	al, al
     467/    829C : 74 31               	je	go_go
     468/    829E :                     
     469/    829E : 3C 2C               	CMP	AL,','
     470/    82A0 : 75 08               	JNZ	GE
     471/    82A2 :                     
     472/    82A2 : 43                  	INC	BX
     473/    82A3 : E8 18 04            	CALL	RDHEX
     474/    82A6 : 0A C9               	OR	CL,CL
     475/    82A8 : 75 03               	jnz	g2
     476/    82AA :                     GE:
     477/    82AA : E9 A2 FE            	JMP	ERR
     478/    82AD :                     
     479/    82AD :                     g2:
     480/    82AD : 8A 07               	MOV	AL,[BX]
     481/    82AF : 3C 3A               	CMP	AL,':'
     482/    82B1 : 75 0C               	JNE	G0_0
     483/    82B3 :                     
     484/    82B3 : 89 16 3E 05         	MOV	[brkcs],DX
     485/    82B7 : 43                  	INC	BX
     486/    82B8 : E8 03 04            	CALL	RDHEX
     487/    82BB : 0A C9               	OR	CL,CL
     488/    82BD : 74 EB               	JZ	GE
     489/    82BF :                     
     490/    82BF :                     G0_0:
     491/    82BF : 89 16 40 05         	MOV	[brkip],DX
     492/    82C3 : E8 E3 03            	CALL	SKIPSP
     493/    82C6 : 0A C0               	OR	AL,AL
     494/    82C8 : 75 E0               	JNZ	GE
     495/    82CA :                     
     496/    82CA : B0 01               	mov	al, 1
     497/    82CC : A2 3C 05            	mov	[bflg], al
     498/    82CF :                     
     499/    82CF :                     go_go:
     500/    82CF : A0 3C 05            	mov	al, [bflg]
     501/    82D2 : 0A C0               	or	al, al
     502/    82D4 : 74 14               	je	go_anywhere
     503/    82D6 :                     
     504/    82D6 :                     ; set break point
     505/    82D6 :                     
     506/    82D6 : A1 3E 05            	mov	ax, [brkcs]
     507/    82D9 : 8E C0               	mov	es, ax
     508/    82DB : 8B 36 40 05         	mov	si, [brkip]
     509/    82DF : 26 8A 04            	mov	al, es:[si]	; get a code at break point
     510/    82E2 : A2 3D 05            	mov	[bp_code], al
     511/    82E5 : B0 CC               	mov	al, 0CCH	; int 03h code
     512/    82E7 : 26 88 04            	mov	es:[si], al	; set break point
     513/    82EA :                     
     514/    82EA :                     go_anywhere:
     515/    82EA : 8E 16 38 05         	MOV	SS,[REGSS]
     516/    82EE : 8B 26 2A 05         	MOV	SP,[REGSP]
     517/    82F2 :                     	
     518/    82F2 : A1 28 05            	MOV	AX,[REGF]
     519/    82F5 : 50                  	PUSH	AX
     520/    82F6 : A1 34 05            	MOV	AX,[REGCS]
     521/    82F9 : 50                  	PUSH	AX
     522/    82FA : A1 32 05            	MOV	AX,[REGIP]
     523/    82FD : 50                  	PUSH	AX
     524/    82FE :                     
     525/    82FE : A1 20 05            	MOV	AX,[REGAX]
     526/    8301 : 8B 1E 22 05         	MOV	BX,[REGBX]
     527/    8305 : 8B 0E 24 05         	MOV	CX,[REGCX]
     528/    8309 : 8B 16 26 05         	MOV	DX,[REGDX]
     529/    830D : 8B 2E 2C 05         	MOV	BP,[REGBP]
     530/    8311 : 8B 36 2E 05         	MOV	SI,[REGSI]
     531/    8315 : 8B 3E 30 05         	MOV	DI,[REGDI]
     532/    8319 : 8E 06 3A 05         	MOV	ES,[REGES]
     533/    831D : 8E 1E 36 05         	MOV	DS,[REGDS]
     534/    8321 : CF                  	IRET
     535/    8322 :                     
     536/    8322 :                     ;;;
     537/    8322 :                     ;;; SET memory
     538/    8322 :                     ;;;
     539/    8322 :                     
     540/    8322 :                     SETM:
     541/    8322 : 43                  	INC	BX
     542/    8323 : E8 98 03            	CALL	RDHEX
     543/    8326 : 0A C9               	OR	CL,CL
     544/    8328 : 74 1F               	JZ	SM1
     545/    832A : 8A 07               	MOV	AL,[BX]
     546/    832C : 3C 3A               	CMP	AL,':'
     547/    832E : 75 0C               	JNE	SM0
     548/    8330 : 89 16 11 05         	MOV	[CURSEG],DX
     549/    8334 : 43                  	INC	BX
     550/    8335 : E8 86 03            	CALL	RDHEX
     551/    8338 : 0A C9               	OR	CL,CL
     552/    833A : 74 6D               	JZ	SME
     553/    833C :                     SM0:
     554/    833C : 89 16 1A 05         	MOV	[SADDR],DX
     555/    8340 : E8 66 03            	CALL	SKIPSP
     556/    8343 : 8A 07               	MOV	AL,[BX]
     557/    8345 : 0A C0               	OR	AL,AL
     558/    8347 : 75 60               	JNZ	SME
     559/    8349 :                     SM1:
     560/    8349 : A1 11 05            	MOV	AX,[CURSEG]
     561/    834C : 8E C0               	MOV	ES,AX
     562/    834E : E8 B2 02            	CALL	HEXOUT4
     563/    8351 : B0 3A               	MOV	AL,':'
     564/    8353 : E8 E9 07            	CALL	CONOUT
     565/    8356 : 8B 36 1A 05         	MOV	SI,[SADDR]
     566/    835A : 8B C6               	MOV	AX,SI
     567/    835C : E8 A4 02            	CALL	HEXOUT4
     568/    835F : BB 3E 88            	MOV	BX,DSEP1
     569/    8362 : E8 83 02            	CALL	MSGOUT
     570/    8365 : 26 8A 04            	MOV	AL,ES:[SI]
     571/    8368 : E8 9F 02            	CALL	HEXOUT2
     572/    836B : B0 20               	MOV	AL,' '
     573/    836D : E8 CF 07            	CALL	CONOUT
     574/    8370 : E8 E7 02            	CALL	GETLIN
     575/    8373 : BB F9 04            	MOV	BX,INBUF
     576/    8376 : E8 30 03            	CALL	SKIPSP
     577/    8379 : 8A 07               	MOV	AL,[BX]
     578/    837B : 0A C0               	OR	AL,AL
     579/    837D : 75 07               	JNZ	SM2
     580/    837F :                     	;; Empty (Increment address)
     581/    837F : 46                  	INC	SI
     582/    8380 : 89 36 1A 05         	MOV	[SADDR],SI
     583/    8384 : EB C3               	JMP	SM1
     584/    8386 :                     SM2:
     585/    8386 : 3C 2D               	CMP	AL,'-'
     586/    8388 : 75 07               	JNZ	SM3
     587/    838A :                     	;; '-' (Decrement address)
     588/    838A : 4E                  	DEC	SI
     589/    838B : 89 36 1A 05         	MOV	[SADDR],SI
     590/    838F : EB B8               	JMP	SM1
     591/    8391 :                     SM3:
     592/    8391 : 3C 2E               	CMP	AL,'.'
     593/    8393 : 75 03               	JNZ	SM4
     594/    8395 :                     	;; '.' (Quit)
     595/    8395 : E9 78 FD            	JMP	WSTART
     596/    8398 :                     SM4:
     597/    8398 : E8 23 03            	CALL	RDHEX
     598/    839B : 0A C9               	OR	CL,CL
     599/    839D : 74 0A               	JZ	SME
     600/    839F : 26 88 14            	MOV	ES:[SI],DL
     601/    83A2 : 46                  	INC	SI
     602/    83A3 : 89 36 1A 05         	MOV	[SADDR],SI
     603/    83A7 : EB A0               	JMP	SM1
     604/    83A9 :                     SME:
     605/    83A9 : E9 A3 FD            	JMP	ERR
     606/    83AC :                     
     607/    83AC :                     ;;;
     608/    83AC :                     ;;; LOAD HEX file
     609/    83AC :                     ;;;
     610/    83AC :                     
     611/    83AC :                     LOADH:
     612/    83AC : 43                  	INC	BX
     613/    83AD : E8 0E 03            	CALL	RDHEX
     614/    83B0 : 0A C9               	OR	CL,CL
     615/    83B2 : 74 14               	JZ	LH0
     616/    83B4 : 8A 07               	MOV	AL,[BX]
     617/    83B6 : 3C 3A               	CMP	AL,':'
     618/    83B8 : 75 10               	JNE	LH1
     619/    83BA : 89 16 11 05         	MOV	[CURSEG],DX
     620/    83BE : 43                  	INC	BX
     621/    83BF : E8 FC 02            	CALL	RDHEX
     622/    83C2 : 0A C9               	OR	CL,CL
     623/    83C4 : 74 30               	JZ	LHE
     624/    83C6 : EB 02               	JMP	LH1
     625/    83C8 :                     LH0:
     626/    83C8 : 33 D2               	XOR	DX,DX
     627/    83CA :                     LH1:
     628/    83CA : 8A 07               	MOV	AL,[BX]
     629/    83CC : 0A C0               	OR	AL,AL
     630/    83CE : 75 26               	JNZ	LHE
     631/    83D0 : 8B F2               	MOV	SI,DX
     632/    83D2 : 8E 06 11 05         	MOV	ES,[CURSEG]
     633/    83D6 :                     
     634/    83D6 :                     LH2:	
     635/    83D6 : B0 2E               	mov	al, '.'
     636/    83D8 : E8 64 07            	call	CONOUT
     637/    83DB :                     	
     638/    83DB : E8 FB 06            	CALL	CONIN
     639/    83DE : E8 D2 02            	CALL	UPPER
     640/    83E1 : 3C 53               	CMP	AL,'S'
     641/    83E3 : 74 6B               	JE	LHS0
     642/    83E5 : 3C 3A               	CMP	AL,':'
     643/    83E7 : 74 10               	JE	LHI0
     644/    83E9 :                     LH3:
     645/    83E9 :                     	;; Skip to EOL
     646/    83E9 : 3C 0D               	CMP	AL,CR
     647/    83EB : 74 E9               	JE	LH2
     648/    83ED : 3C 0A               	CMP	AL,LF
     649/    83EF : 74 E5               	JE	LH2
     650/    83F1 : E8 E5 06            	CALL	CONIN
     651/    83F4 : EB F3               	JMP	LH3
     652/    83F6 :                     LHE:
     653/    83F6 : E9 56 FD            	JMP	ERR
     654/    83F9 :                     
     655/    83F9 :                     LHI0:
     656/    83F9 : E8 28 02            	CALL	HEXIN
     657/    83FC : 8A C8               	MOV	CL,AL		; Checksum
     658/    83FE : 8A D8               	MOV	BL,AL		; Length
     659/    8400 :                     
     660/    8400 : E8 21 02            	CALL	HEXIN
     661/    8403 : 8A F0               	MOV	DH,AL		; Address H
     662/    8405 : 02 C8               	ADD	CL,AL		; Checksum
     663/    8407 :                     
     664/    8407 : E8 1A 02            	CALL	HEXIN
     665/    840A : 8A D0               	MOV	DL,AL		; Address L
     666/    840C : 02 C8               	ADD	CL,AL		; Checksum
     667/    840E :                     
     668/    840E : 8B FA               	MOV	DI,DX
     669/    8410 : 03 FE               	ADD	DI,SI		; Add offset
     670/    8412 :                     
     671/    8412 : E8 0F 02            	CALL	HEXIN
     672/    8415 : A2 1E 05            	MOV	[RECTYP],AL	; Record Type
     673/    8418 : 02 C8               	ADD	CL,AL		; Checksum
     674/    841A :                     
     675/    841A : 0A DB               	OR	BL,BL		; Check length
     676/    841C : 74 15               	JZ	LHI3
     677/    841E :                     LHI1:
     678/    841E : E8 03 02            	CALL	HEXIN
     679/    8421 : 02 C8               	ADD	CL,AL		; Checksum
     680/    8423 :                     
     681/    8423 : 8A 3E 1E 05         	MOV	BH,[RECTYP]
     682/    8427 : 0A FF               	OR	BH,BH
     683/    8429 : 75 04               	JNZ	LHI2
     684/    842B :                     
     685/    842B : 26 88 05            	MOV	ES:[DI],AL
     686/    842E : 47                  	INC	DI
     687/    842F :                     LHI2:
     688/    842F : FE CB               	DEC	BL
     689/    8431 : 75 EB               	JNZ	LHI1
     690/    8433 :                     LHI3:
     691/    8433 : E8 EE 01            	CALL	HEXIN
     692/    8436 : 02 C1               	ADD	AL,CL
     693/    8438 : 75 0D               	JNZ	LHIE		; Checksum error
     694/    843A : A0 1E 05            	MOV	AL,[RECTYP]
     695/    843D : 0A C0               	OR	AL,AL
     696/    843F : 74 A8               	JZ	LH3
     697/    8441 :                     
     698/    8441 :                     LHSR:
     699/    8441 : E8 0C 02            	call	CRLF
     700/    8444 : E9 C9 FC            	JMP	WSTART
     701/    8447 :                     LHIE:
     702/    8447 : BB 19 88            	MOV	BX,IHEMSG
     703/    844A : E8 9B 01            	CALL	MSGOUT
     704/    844D : E9 C0 FC            	JMP	WSTART
     705/    8450 :                     
     706/    8450 :                     LHS0:
     707/    8450 : E8 86 06            	CALL	CONIN
     708/    8453 : A2 1E 05            	MOV	[RECTYP],AL
     709/    8456 :                     
     710/    8456 : E8 CB 01            	CALL	HEXIN
     711/    8459 : 8A D8               	MOV	BL,AL		; Length+3
     712/    845B : 8A C8               	MOV	CL,AL		; Checksum
     713/    845D :                     
     714/    845D : E8 C4 01            	CALL	HEXIN
     715/    8460 : 8A F0               	MOV	DH,AL		; Address H
     716/    8462 : 02 C8               	ADD	CL,AL		; Checksum
     717/    8464 :                     	
     718/    8464 : E8 BD 01            	CALL	HEXIN
     719/    8467 : 8A D0               	MOV	DL,AL		; Address L
     720/    8469 : 02 C8               	ADD	CL,AL		; Checksum
     721/    846B :                     
     722/    846B : 8B FA               	MOV	DI,DX
     723/    846D : 03 FE               	ADD	DI,SI		; Add offset
     724/    846F :                     
     725/    846F : 80 EB 03            	SUB	BL,3
     726/    8472 : 72 2B               	JC	LHSE		; Length error
     727/    8474 : 74 16               	JZ	LHS3
     728/    8476 :                     LHS1:
     729/    8476 : E8 AB 01            	CALL	HEXIN
     730/    8479 : 02 C8               	ADD	CL,AL		; Checksum
     731/    847B :                     
     732/    847B : 8A 3E 1E 05         	MOV	BH,[RECTYP]
     733/    847F : 80 FF 31            	CMP	BH,'1'
     734/    8482 : 75 04               	JNZ	LHS2
     735/    8484 :                     
     736/    8484 : 26 88 05            	MOV	ES:[DI],AL
     737/    8487 : 47                  	INC	DI
     738/    8488 :                     LHS2:
     739/    8488 : FE CB               	DEC	BL
     740/    848A : 75 EA               	JNZ	LHS1
     741/    848C :                     LHS3:
     742/    848C : E8 95 01            	CALL	HEXIN
     743/    848F : 02 C1               	ADD	AL,CL
     744/    8491 : 3C FF               	CMP	AL,0FFH
     745/    8493 : 75 0A               	JNE	LHSE		; Checksum error
     746/    8495 :                     
     747/    8495 : A0 1E 05            	MOV	AL,[RECTYP]
     748/    8498 : 3C 39               	CMP	AL,'9'
     749/    849A : 74 A5               	JZ	LHSR
     750/    849C : E9 4A FF            	JMP	LH3
     751/    849F :                     LHSE:
     752/    849F : BB 26 88            	MOV	BX,SHEMSG
     753/    84A2 : E8 43 01            	CALL	MSGOUT
     754/    84A5 : E9 68 FC            	JMP	WSTART
     755/    84A8 :                     
     756/    84A8 :                     ;;;
     757/    84A8 :                     ;;; Register
     758/    84A8 :                     ;;; 
     759/    84A8 :                     REG:
     760/    84A8 : 43                  	INC	BX
     761/    84A9 : E8 FD 01            	CALL	SKIPSP
     762/    84AC : E8 04 02            	CALL	UPPER
     763/    84AF : 0A C0               	OR	AL,AL
     764/    84B1 : 75 06               	JNE	RG0
     765/    84B3 : E8 7F 00            	CALL	RDUMP
     766/    84B6 : E9 57 FC            	JMP	WSTART
     767/    84B9 :                     RG0:
     768/    84B9 : BE 7D 89            	MOV	SI,RNTAB
     769/    84BC :                     RG1:
     770/    84BC : 2E 3A 04            	CMP	AL,CS:[SI]
     771/    84BF : 74 0D               	JE	RG2		; Character match
     772/    84C1 : 2E 8A 4C 01         	MOV	CL,CS:1[SI]
     773/    84C5 : 0A C9               	OR	CL,CL
     774/    84C7 : 74 69               	JE	RGE
     775/    84C9 : 83 C6 06            	ADD	SI,6
     776/    84CC : EB EE               	JMP	RG1
     777/    84CE :                     RG2:
     778/    84CE : 2E 8A 44 01         	MOV	AL,CS:1[SI]
     779/    84D2 : 3C 0F               	CMP	AL,0FH
     780/    84D4 : 75 0C               	JNE	RG3
     781/    84D6 :                     	;; Next table
     782/    84D6 : 2E 8B 74 02         	MOV	SI,CS:2[SI]
     783/    84DA : 43                  	INC	BX
     784/    84DB : 8A 07               	MOV	AL,[BX]
     785/    84DD : E8 D3 01            	CALL	UPPER
     786/    84E0 : EB DA               	JMP	RG1
     787/    84E2 :                     RG3:	
     788/    84E2 : 0A C0               	OR	AL,AL		; Found end mark
     789/    84E4 : 74 4C               	JE	RGE
     790/    84E6 :                     
     791/    84E6 : 2E 8A 4C 01         	MOV	CL,CS:1[SI]
     792/    84EA : 2E 8B 5C 04         	MOV	BX,CS:4[SI]
     793/    84EE : E8 F7 00            	CALL	MSGOUT
     794/    84F1 : B0 3D               	MOV	AL,'='
     795/    84F3 : E8 49 06            	CALL	CONOUT
     796/    84F6 : 2E 8B 5C 02         	MOV	BX,CS:2[SI]
     797/    84FA : 80 E1 07            	AND	CL,07H
     798/    84FD : 53                  	PUSH	BX
     799/    84FE : 51                  	PUSH	CX
     800/    84FF : 80 F9 01            	CMP	CL,1
     801/    8502 : 75 07               	JNE	RG4
     802/    8504 :                     	;; 8 bit register
     803/    8504 : 8A 07               	MOV	AL,[BX]
     804/    8506 : E8 01 01            	CALL	HEXOUT2
     805/    8509 : EB 05               	JMP	RG5
     806/    850B :                     RG4:
     807/    850B :                     	;; 16 bit register
     808/    850B : 8B 07               	MOV	AX,[BX]
     809/    850D : E8 F3 00            	CALL	HEXOUT4
     810/    8510 :                     RG5:
     811/    8510 : B0 20               	MOV	AL,' '
     812/    8512 : E8 2A 06            	CALL	CONOUT
     813/    8515 : E8 42 01            	CALL	GETLIN
     814/    8518 : BB F9 04            	MOV	BX,INBUF
     815/    851B : E8 A0 01            	CALL	RDHEX
     816/    851E : 0A C9               	OR	CL,CL
     817/    8520 : 74 0D               	JE	RGR
     818/    8522 : 59                  	POP	CX
     819/    8523 : 5B                  	POP	BX
     820/    8524 : 80 F9 01            	CMP	CL,1
     821/    8527 : 75 04               	JNE	RG6
     822/    8529 :                     	;; 8 bit register
     823/    8529 : 88 17               	MOV	[BX],DL
     824/    852B : EB 02               	JMP	RG7
     825/    852D :                     RG6:
     826/    852D :                     	;; 16 bit register
     827/    852D : 89 17               	MOV	[BX],DX
     828/    852F :                     RG7:
     829/    852F :                     RGR:
     830/    852F : E9 DE FB            	JMP	WSTART
     831/    8532 :                     RGE:
     832/    8532 : E9 1A FC            	JMP	ERR
     833/    8535 :                     	
     834/    8535 :                     RDUMP:
     835/    8535 : BE E5 88            	MOV	SI,RDTAB
     836/    8538 :                     RD0:	
     837/    8538 : 2E 8B 1C            	MOV	BX,CS:[SI]
     838/    853B : 0B DB               	OR	BX,BX
     839/    853D : 74 11               	JZ	RD1
     840/    853F : E8 A6 00            	CALL	MSGOUT
     841/    8542 : 46                  	INC	SI
     842/    8543 : 46                  	INC	SI
     843/    8544 : 2E 8B 1C            	MOV	BX,CS:[SI]
     844/    8547 : 8B 07               	MOV	AX,[BX]
     845/    8549 : E8 B7 00            	CALL	HEXOUT4
     846/    854C : 46                  	INC	SI
     847/    854D : 46                  	INC	SI
     848/    854E : EB E8               	JMP	RD0
     849/    8550 :                     RD1:	
     850/    8550 :                     ; Flag bit image
     851/    8550 :                     
     852/    8550 : BB 67 89            	mov	bx, FLGB
     853/    8553 : E8 92 00            	CALL	MSGOUT		;" FLb="
     854/    8556 :                     
     855/    8556 : BF 42 05            	mov	di, F_bit
     856/    8559 : BB 6D 89            	mov	bx, Fbiton
     857/    855C : B1 10               	mov	cl, 16
     858/    855E : A1 28 05            	mov	ax, [REGF]
     859/    8561 : 25 D5 0F            	and	ax, f_msk_bit
     860/    8564 :                     
     861/    8564 :                     fb_loop:
     862/    8564 : D1 E0               	shl	ax, 1
     863/    8566 : 72 05               	jc	rdf1
     864/    8568 :                     
     865/    8568 : C6 05 2E            	mov	byte ptr [di], '.'
     866/    856B : EB 04               	jmp	rdf2
     867/    856D :                     
     868/    856D :                     rdf1:
     869/    856D : 8A 2F               	mov	ch, [bx]
     870/    856F : 88 2D               	mov	[di], ch
     871/    8571 :                     rdf2:
     872/    8571 : 43                  	inc	bx
     873/    8572 : 47                  	inc	di
     874/    8573 : FE C9               	dec	cl
     875/    8575 : 75 ED               	jnz	fb_loop
     876/    8577 :                     
     877/    8577 : C6 05 00            	mov	byte ptr [di],0
     878/    857A : BB 42 05            	mov	bx, F_bit
     879/    857D : E8 68 00            	CALL	MSGOUT		;"....ODITSZ.A.P.C"
     880/    8580 :                     	
     881/    8580 : E9 CD 00            	JMP	CRLF
     882/    8583 :                     	
     883/    8583 :                     ;;;
     884/    8583 :                     ;;; T address
     885/    8583 :                     ;;; 
     886/    8583 :                     
     887/    8583 :                     Trace:
     888/    8583 : 43                  	INC	BX
     889/    8584 : E8 37 01            	CALL	RDHEX
     890/    8587 : 0A C9               	OR	CL,CL
     891/    8589 : 74 19               	JZ	T1
     892/    858B : 8A 07               	MOV	AL,[BX]
     893/    858D : 3C 3A               	CMP	AL,':'
     894/    858F : 75 0C               	JNE	T0
     895/    8591 :                     
     896/    8591 : 89 16 34 05         	MOV	[REGCS],DX
     897/    8595 : 43                  	INC	BX
     898/    8596 : E8 25 01            	CALL	RDHEX
     899/    8599 : 0A C9               	OR	CL,CL
     900/    859B : 74 0D               	JZ	TE
     901/    859D :                     T0:
     902/    859D : 89 16 32 05         	MOV	[REGIP],DX
     903/    85A1 : E8 05 01            	CALL	SKIPSP
     904/    85A4 :                     T1:
     905/    85A4 : 8A 07               	MOV	AL,[BX]
     906/    85A6 : 0A C0               	or	al, al
     907/    85A8 : 74 03               	je	To_go
     908/    85AA :                     
     909/    85AA :                     TE:
     910/    85AA : E9 A2 FB            	JMP	ERR
     911/    85AD :                     
     912/    85AD :                     To_go:
     913/    85AD : 8E 16 38 05         	MOV	SS,[REGSS]
     914/    85B1 : 8B 26 2A 05         	MOV	SP,[REGSP]
     915/    85B5 :                     	
     916/    85B5 : A1 28 05            	MOV	AX,[REGF]
     917/    85B8 : 0D 00 01            	or	ax, Tbit_ON_
     918/    85BB :                     ;	and	ax, IBIT_OFF
     919/    85BB :                     
     920/    85BB : 50                  	PUSH	AX
     921/    85BC : A1 34 05            	MOV	AX,[REGCS]
     922/    85BF : 50                  	PUSH	AX
     923/    85C0 : A1 32 05            	MOV	AX,[REGIP]
     924/    85C3 : 50                  	PUSH	AX
     925/    85C4 :                     
     926/    85C4 : A1 20 05            	MOV	AX,[REGAX]
     927/    85C7 : 8B 1E 22 05         	MOV	BX,[REGBX]
     928/    85CB : 8B 0E 24 05         	MOV	CX,[REGCX]
     929/    85CF : 8B 16 26 05         	MOV	DX,[REGDX]
     930/    85D3 : 8B 2E 2C 05         	MOV	BP,[REGBP]
     931/    85D7 : 8B 36 2E 05         	MOV	SI,[REGSI]
     932/    85DB : 8B 3E 30 05         	MOV	DI,[REGDI]
     933/    85DF : 8E 06 3A 05         	MOV	ES,[REGES]
     934/    85E3 : 8E 1E 36 05         	MOV	DS,[REGDS]
     935/    85E7 : CF                  	IRET
     936/    85E8 :                     
     937/    85E8 :                     ;;;
     938/    85E8 :                     ;;; Other support routines
     939/    85E8 :                     ;;;
     940/    85E8 :                     
     941/    85E8 :                     MSGOUT:
     942/    85E8 : 2E 8A 07            	MOV	AL,CS:[BX]
     943/    85EB : 22 C0               	AND	AL,AL
     944/    85ED : 74 06               	JZ	MSGOE
     945/    85EF : E8 4D 05            	CALL	CONOUT
     946/    85F2 : 43                  	INC	BX
     947/    85F3 : EB F3               	JMP	MSGOUT
     948/    85F5 :                     MSGOE:
     949/    85F5 : C3                  	RET
     950/    85F6 :                     
     951/    85F6 :                     STROUT:
     952/    85F6 : 8A 07               	MOV	AL,[BX]
     953/    85F8 : 22 C0               	AND	AL,AL
     954/    85FA : 74 06               	JZ	STROE
     955/    85FC : E8 40 05            	CALL	CONOUT
     956/    85FF : 43                  	INC	BX
     957/    8600 : EB F4               	JMP	STROUT
     958/    8602 :                     STROE:
     959/    8602 : C3                  	RET
     960/    8603 :                     
     961/    8603 :                     HEXOUT4:
     962/    8603 : 50                  	PUSH	AX
     963/    8604 : 8A C4               	MOV	AL,AH
     964/    8606 : E8 01 00            	CALL	HEXOUT2
     965/    8609 : 58                  	POP	AX
     966/    860A :                     HEXOUT2:
     967/    860A : 50                  	PUSH	AX
     968/    860B : D0 E8               	SHR	AL,1
     969/    860D : D0 E8               	SHR	AL,1
     970/    860F : D0 E8               	SHR	AL,1
     971/    8611 : D0 E8               	SHR	AL,1
     972/    8613 : E8 01 00            	CALL	HEXOUT1
     973/    8616 : 58                  	POP	AX
     974/    8617 :                     HEXOUT1:
     975/    8617 : 24 0F               	AND	AL,0FH
     976/    8619 : 04 30               	ADD	AL,'0'
     977/    861B : 3C 3A               	CMP	AL,'9'+1
     978/    861D : 72 02               	JC	HO10
     979/    861F : 04 07               	ADD	AL,'A'-'9'-1
     980/    8621 :                     HO10:
     981/    8621 : E9 1B 05            	JMP	CONOUT
     982/    8624 :                     
     983/    8624 :                     HEXIN:
     984/    8624 : 32 C0               	XOR	AL,AL
     985/    8626 : E8 08 00            	CALL	HI0
     986/    8629 : D0 E0               	SHL	AL,1
     987/    862B : D0 E0               	SHL	AL,1
     988/    862D : D0 E0               	SHL	AL,1
     989/    862F : D0 E0               	SHL	AL,1
     990/    8631 :                     HI0:
     991/    8631 : 8A E8               	MOV	CH,AL
     992/    8633 : E8 A3 04            	CALL	CONIN
     993/    8636 : E8 7A 00            	CALL	UPPER
     994/    8639 : 3C 30               	CMP	AL,'0'
     995/    863B : 72 12               	JC	HIR
     996/    863D : 3C 3A               	CMP	AL,'9'+1
     997/    863F : 72 0A               	JC	HI1
     998/    8641 : 3C 41               	CMP	AL,'A'
     999/    8643 : 72 0A               	JC	HIR
    1000/    8645 : 3C 47               	CMP	AL,'F'+1
    1001/    8647 : 73 06               	JNC	HIR
    1002/    8649 : 2C 07               	SUB	AL,'A'-'9'-1
    1003/    864B :                     HI1:
    1004/    864B : 2C 30               	SUB	AL,'0'
    1005/    864D : 0A C5               	OR	AL,CH
    1006/    864F :                     HIR:
    1007/    864F : C3                  	RET
    1008/    8650 :                     
    1009/    8650 :                     CRLF:
    1010/    8650 : B0 0D               	MOV	AL,CR
    1011/    8652 : E8 EA 04            	CALL	CONOUT
    1012/    8655 : B0 0A               	MOV	AL,LF
    1013/    8657 : E9 E5 04            	JMP	CONOUT
    1014/    865A :                     
    1015/    865A :                     GETLIN:
    1016/    865A : BB F9 04            	MOV	BX,INBUF
    1017/    865D : 32 C9               	XOR	CL,CL
    1018/    865F :                     GL0:
    1019/    865F : E8 77 04            	CALL	CONIN
    1020/    8662 : 3C 0D               	CMP	AL,CR
    1021/    8664 : 74 3B               	JZ	GLE
    1022/    8666 : 3C 0A               	CMP	AL,LF
    1023/    8668 : 74 37               	JZ	GLE
    1024/    866A : 3C 08               	CMP	AL,BS
    1025/    866C : 74 1B               	JZ	GLB
    1026/    866E : 3C 7F               	CMP	AL,DEL
    1027/    8670 : 74 17               	JZ	GLB
    1028/    8672 : 3C 20               	CMP	AL,' '
    1029/    8674 : 72 E9               	JC	GL0
    1030/    8676 : 3C 80               	CMP	AL,80H
    1031/    8678 : 73 E5               	JNC	GL0
    1032/    867A : 80 F9 17            	CMP	CL,BUFLEN-1
    1033/    867D : 73 E0               	JNC	GL0		; Too long
    1034/    867F : 88 07               	MOV	[BX],AL
    1035/    8681 : E8 BB 04            	CALL	CONOUT
    1036/    8684 : 43                  	INC	BX
    1037/    8685 : FE C1               	INC	CL
    1038/    8687 : EB D6               	JMP	GL0
    1039/    8689 :                     GLB:
    1040/    8689 : 22 C9               	AND	CL,CL
    1041/    868B : 74 D2               	JZ	GL0
    1042/    868D : 4B                  	DEC	BX
    1043/    868E : FE C9               	DEC	CL
    1044/    8690 : B0 08               	MOV	AL,BS
    1045/    8692 : E8 AA 04            	CALL	CONOUT
    1046/    8695 : B0 20               	MOV	AL,' '
    1047/    8697 : E8 A5 04            	CALL	CONOUT
    1048/    869A : B0 08               	MOV	AL,BS
    1049/    869C : E8 A0 04            	CALL	CONOUT
    1050/    869F : EB BE               	JMP	GL0
    1051/    86A1 :                     GLE:
    1052/    86A1 : E8 AC FF            	CALL	CRLF
    1053/    86A4 : B0 00               	MOV	AL,00H
    1054/    86A6 : 88 07               	MOV	[BX],AL
    1055/    86A8 : C3                  	RET
    1056/    86A9 :                     	
    1057/    86A9 :                     SKIPSP:
    1058/    86A9 : 8A 07               	MOV	AL,[BX]
    1059/    86AB : 3C 20               	CMP	AL,' '
    1060/    86AD : 75 03               	JNE	SSR
    1061/    86AF : 43                  	INC	BX
    1062/    86B0 : EB F7               	JMP	SKIPSP
    1063/    86B2 :                     SSR:
    1064/    86B2 : C3                  	RET
    1065/    86B3 :                     
    1066/    86B3 :                     UPPER:
    1067/    86B3 : 3C 61               	CMP	AL,'a'
    1068/    86B5 : 72 06               	JC	UPR
    1069/    86B7 : 3C 7B               	CMP	AL,'z'+1
    1070/    86B9 : 73 02               	JNC	UPR
    1071/    86BB : 04 E0               	ADD	AL,'A'-'a'
    1072/    86BD :                     UPR:
    1073/    86BD : C3                  	RET
    1074/    86BE :                     
    1075/    86BE :                     RDHEX:
    1076/    86BE : E8 E8 FF            	CALL	SKIPSP
    1077/    86C1 : 32 C9               	XOR	CL,CL
    1078/    86C3 : 33 D2               	XOR	DX,DX
    1079/    86C5 :                     RH0:
    1080/    86C5 : 8A 07               	MOV	AL,[BX]
    1081/    86C7 : E8 E9 FF            	CALL	UPPER
    1082/    86CA : 3C 30               	CMP	AL,'0'
    1083/    86CC : 72 1F               	JC	RHE
    1084/    86CE : 3C 3A               	CMP	AL,'9'+1
    1085/    86D0 : 72 0A               	JC	RH1
    1086/    86D2 : 3C 41               	CMP	AL,'A'
    1087/    86D4 : 72 17               	JC	RHE
    1088/    86D6 : 3C 47               	CMP	AL,'F'+1
    1089/    86D8 : 73 13               	JNC	RHE
    1090/    86DA : 2C 07               	SUB	AL,'A'-'9'-1
    1091/    86DC :                     RH1:
    1092/    86DC : 2C 30               	SUB	AL,'0'
    1093/    86DE : D1 E2               	SHL	DX,1
    1094/    86E0 : D1 E2               	SHL	DX,1
    1095/    86E2 : D1 E2               	SHL	DX,1
    1096/    86E4 : D1 E2               	SHL	DX,1
    1097/    86E6 : 0A D0               	OR	DL,AL
    1098/    86E8 : 43                  	INC	BX
    1099/    86E9 : FE C1               	INC	CL
    1100/    86EB : EB D8               	JMP	RH0
    1101/    86ED :                     RHE:
    1102/    86ED : C3                  	RET
    1103/    86EE :                     
    1104/    86EE :                     ;-----------------------
    1105/    86EE :                     ; INT 21H function call 
    1106/    86EE :                     ;-----------------------
    1107/    86EE :                     INTFNC:
    1108/    86EE :                     	; get a charactor : AH = 7
    1109/    86EE :                     	; return AL : charactor
    1110/    86EE :                     
    1111/    86EE : 55                  	push	bp
    1112/    86EF : 8B EC               	mov	bp, sp
    1113/    86F1 : FF 76 06            	push	[bp+6]
    1114/    86F4 : 9D                  	popf		; get user FL condition
    1115/    86F5 : 5D                  	pop	bp
    1116/    86F6 :                     
    1117/    86F6 : 80 FC 07            	cmp	ah, 7
    1118/    86F9 : 75 04               	jnz	nfnc1
    1119/    86FB : E8 DB 03            	call	CONIN
    1120/    86FE : CF                  	iret
    1121/    86FF :                     nfnc1:
    1122/    86FF :                     	; put a charactor : AH = 2
    1123/    86FF :                     	; input : DL : charactor
    1124/    86FF : 80 FC 02            	cmp	ah, 2
    1125/    8702 : 75 06               	jnz	nfnc2		; no support function
    1126/    8704 : 8A C2               	mov	al, dl
    1127/    8706 : E8 36 04            	call	CONOUT
    1128/    8709 : CF                  	iret
    1129/    870A :                     
    1130/    870A :                     nfnc2:
    1131/    870A :                     	; check key status : AH = 0BH
    1132/    870A :                     	; OUTPUT : AL : 0     ( key is not exist )
    1133/    870A :                     	;             : 0FFH  ( key is exist )
    1134/    870A : 80 FC 0B            	cmp	ah, 0BH
    1135/    870D : 75 08               	jnz	nfnc3		; no support function
    1136/    870F : E8 27 04            	call	CONST
    1137/    8712 : 74 02               	jz	nfnc4
    1138/    8714 : B0 FF               	mov	al, 0FFH
    1139/    8716 :                     nfnc4:
    1140/    8716 : CF                  	iret
    1141/    8717 :                     
    1142/    8717 :                     nfnc3:
    1143/    8717 :                     	; warm boot check
    1144/    8717 :                     	; ah=0 : warm boot
    1145/    8717 : 80 FC 00            	cmp	ah, 0
    1146/    871A : 75 FA               	jnz	nfnc4
    1147/    871C :                     
    1148/    871C : B8 00 00            	MOV	AX,RAMSEG
    1149/    871F : 8E D8               	MOV	DS,AX
    1150/    8721 : 8E D0               	MOV	SS,AX
    1151/    8723 : BC 00 06            	MOV	SP,STACK
    1152/    8726 :                     nfnc31:
    1153/    8726 : B0 11               	mov	al, XON
    1154/    8728 : A2 07 04            	mov	[rx_xflg], al
    1155/    872B : E8 11 04            	call	CONOUT
    1156/    872E : E9 92 00            	jmp	chk_bpt
    1157/    8731 :                     
    1158/    8731 :                     ;;;
    1159/    8731 :                     ;;; Interrupt Handler
    1160/    8731 :                     ;;;
    1161/    8731 :                     
    1162/    8731 :                     	;; Divide error (INT 00H)
    1163/    8731 :                     INTDIV:
    1164/    8731 : 50                  	PUSH	AX
    1165/    8732 : 1E                  	PUSH	DS
    1166/    8733 : B8 00 00            	MOV	AX,RAMSEG
    1167/    8736 : 8E D8               	MOV	DS,AX
    1168/    8738 : 89 1E 22 05         	MOV	[REGBX],BX
    1169/    873C : 89 0E 24 05         	MOV	[REGCX],CX
    1170/    8740 : BB B6 88            	MOV	BX,DIVMSG
    1171/    8743 : 33 C9               	XOR	CX,CX		; IP adjustment
    1172/    8745 : EB 41               	JMP	INT0
    1173/    8747 :                     	
    1174/    8747 :                     	;; Single step (INT 01H)
    1175/    8747 :                     INTSTP:
    1176/    8747 : 50                  	PUSH	AX
    1177/    8748 : 1E                  	PUSH	DS
    1178/    8749 : B8 00 00            	MOV	AX,RAMSEG
    1179/    874C : 8E D8               	MOV	DS,AX
    1180/    874E : 89 1E 22 05         	MOV	[REGBX],BX
    1181/    8752 : 89 0E 24 05         	MOV	[REGCX],CX
    1182/    8756 : BB C5 88            	MOV	BX,STPMSG
    1183/    8759 : 33 C9               	XOR	CX,CX		; IP adjustment
    1184/    875B : EB 2B               	JMP	INT0
    1185/    875D :                     	
    1186/    875D :                     	;; Break (INT 03H)
    1187/    875D :                     INTBRK:
    1188/    875D : 50                  	PUSH	AX
    1189/    875E : 1E                  	PUSH	DS
    1190/    875F : B8 00 00            	MOV	AX,RAMSEG
    1191/    8762 : 8E D8               	MOV	DS,AX
    1192/    8764 : 89 1E 22 05         	MOV	[REGBX],BX
    1193/    8768 : 89 0E 24 05         	MOV	[REGCX],CX
    1194/    876C : BB D2 88            	MOV	BX,BRKMSG
    1195/    876F : B9 01 00            	MOV	CX,1		; IP adjustment
    1196/    8772 : EB 14               	JMP	INT0
    1197/    8774 :                     	
    1198/    8774 :                     	;; Overflow (INT 04H)
    1199/    8774 :                     INTOVF:
    1200/    8774 : 50                  	PUSH	AX
    1201/    8775 : 1E                  	PUSH	DS
    1202/    8776 : B8 00 00            	MOV	AX,RAMSEG
    1203/    8779 : 8E D8               	MOV	DS,AX
    1204/    877B : 89 1E 22 05         	MOV	[REGBX],BX
    1205/    877F : 89 0E 24 05         	MOV	[REGCX],CX
    1206/    8783 : BB DA 88            	MOV	BX,OVFMSG
    1207/    8786 : 33 C9               	XOR	CX,CX		; IP adjustment
    1208/    8788 :                     INT0:
    1209/    8788 : 58                  	POP	AX
    1210/    8789 : A3 36 05            	MOV	[REGDS],AX
    1211/    878C : 58                  	POP	AX
    1212/    878D : A3 20 05            	MOV	[REGAX],AX
    1213/    8790 : 89 16 26 05         	MOV	[REGDX],DX
    1214/    8794 :                     
    1215/    8794 : 89 2E 2C 05         	MOV	[REGBP],BP
    1216/    8798 : 89 36 2E 05         	MOV	[REGSI],SI
    1217/    879C : 89 3E 30 05         	MOV	[REGDI],DI
    1218/    87A0 : 8C 06 3A 05         	MOV	[REGES],ES
    1219/    87A4 :                     
    1220/    87A4 : 58                  	POP	AX
    1221/    87A5 : 2B C1               	SUB	AX,CX
    1222/    87A7 : A3 32 05            	MOV	[REGIP],AX
    1223/    87AA : 58                  	POP	AX
    1224/    87AB : A3 34 05            	MOV	[REGCS],AX
    1225/    87AE : 58                  	POP	AX
    1226/    87AF : 25 D6 0E            	and	ax,Tbit_OFF	; trace mode off
    1227/    87B2 :                     ;	or	ax, INIT_FL_	; int flag on
    1228/    87B2 :                     
    1229/    87B2 : A3 28 05            	MOV	[REGF],AX
    1230/    87B5 :                     
    1231/    87B5 : 89 26 2A 05         	MOV	[REGSP],SP
    1232/    87B9 : 8C 16 38 05         	MOV	[REGSS],SS
    1233/    87BD :                     
    1234/    87BD : E8 28 FE            	CALL	MSGOUT
    1235/    87C0 : E8 72 FD            	CALL	RDUMP
    1236/    87C3 :                     
    1237/    87C3 :                     ; check break point
    1238/    87C3 :                     
    1239/    87C3 :                     chk_bpt:
    1240/    87C3 : A0 3C 05            	mov	al, [bflg]
    1241/    87C6 : 0A C0               	or	al, al
    1242/    87C8 : 74 14               	je	nobrkp
    1243/    87CA :                     
    1244/    87CA :                     ; restore a original code at break point
    1245/    87CA :                     
    1246/    87CA : A1 3E 05            	mov	ax, [brkcs]
    1247/    87CD : 8E C0               	mov	es, ax
    1248/    87CF : 8B 36 40 05         	mov	si, [brkip]
    1249/    87D3 : A0 3D 05            	mov	al, [bp_code]
    1250/    87D6 : 26 88 04            	mov	es:[si], al	; restore a original code
    1251/    87D9 : 32 C0               	xor	al, al
    1252/    87DB : A2 3C 05            	mov	[bflg], al	; clear break flag
    1253/    87DE :                     
    1254/    87DE :                     nobrkp:
    1255/    87DE : FB                  	sti
    1256/    87DF : E9 2E F9            	JMP	WSTART
    1257/    87E2 :                     
    1258/    87E2 :                     	;; Dummy
    1259/    87E2 :                     INTDMY:
    1260/    87E2 : CF                  	IRET
    1261/    87E3 :                     	
    1262/    87E3 :                     OPNMSG:
    1263/    87E3 : 0D 0A 55 6E 69 76   	DB	CR,LF,"Universal Monitor 8086",CR,LF
             87E9 : 65 72 73 61 6C 20 
             87EF : 4D 6F 6E 69 74 6F 
             87F5 : 72 20 38 30 38 36 
             87FB : 0D 0A             
    1264/    87FD : 53 42 43 56 32 30   	db	"SBCV20 Edition. Rev.01",CR,LF,00H
             8803 : 20 45 64 69 74 69 
             8809 : 6F 6E 2E 20 52 65 
             880F : 76 2E 30 31 0D 0A 
             8815 : 00                
    1265/    8816 :                     
    1266/    8816 :                     PROMPT:
    1267/    8816 : 5D 20 00            	DB	"] ",00H
    1268/    8819 :                     
    1269/    8819 :                     IHEMSG:
    1270/    8819 : 45 72 72 6F 72 20   	DB	"Error ihex",CR,LF,00H
             881F : 69 68 65 78 0D 0A 
             8825 : 00                
    1271/    8826 :                     SHEMSG:
    1272/    8826 : 45 72 72 6F 72 20   	DB	"Error srec",CR,LF,00H
             882C : 73 72 65 63 0D 0A 
             8832 : 00                
    1273/    8833 :                     ERRMSG:
    1274/    8833 : 45 72 72 6F 72 0D   	DB	"Error",CR,LF,00H
             8839 : 0A 00             
    1275/    883B :                     
    1276/    883B :                     DSEP0:
    1277/    883B : 20 3A 00            	DB	" :",00H
    1278/    883E :                     DSEP1:
    1279/    883E : 20 3A 20 00         	DB	" : ",00H
    1280/    8842 :                     IHEXER:
    1281/    8842 : 3A 30 30 30 30 30           DB	":00000001FF",CR,LF,00H
             8848 : 30 30 31 46 46 0D 
             884E : 0A 00             
    1282/    8850 :                     SRECER:
    1283/    8850 : 53 39 30 33 30 30           DB	"S9030000FC",CR,LF,00H
             8856 : 30 30 46 43 0D 0A 
             885C : 00                
    1284/    885D :                     
    1285/    885D :                     INIVEC:
    1286/    885D : 31 87 00 00         	DW	INTDIV, ROMSEG	; 00H Divide error
    1287/    8861 : 47 87 00 00         	DW	INTSTP, ROMSEG	; 01H Single step
    1288/    8865 : E2 87 00 00         	DW	INTDMY, ROMSEG	; 02H NMI
    1289/    8869 : 5D 87 00 00         	DW	INTBRK, ROMSEG	; 03H Breakpoint
    1290/    886D : 74 87 00 00         	DW	INTOVF, ROMSEG	; 04H Overflow
    1291/    8871 :                     INIVECE:
    1292/    8871 :                     
    1293/    8871 : =>TRUE               	IF USE_IDENT
    1294/    8871 :                     
    1295/    8871 : 43 50 55 20 3A 20   cpum:	db	"CPU : ", 00h
             8877 : 00                
    1296/    8878 : 38 30 38 36 2F 38   IM86:	DB	"8086/8088",CR,LF,00H
             887E : 30 38 38 0D 0A 00 
    1297/    8884 : 38 30 31 38 36 2F   IM186:	DB	"80186/80188",CR,LF,00H
             888A : 38 30 31 38 38 0D 
             8890 : 0A 00             
    1298/    8892 : 56 33 30 2F 56 32   IMV30:	DB	"V30/V20",CR,LF,00H
             8898 : 30 0D 0A 00       
    1299/    889C : 38 30 32 38 36 0D   IM286:	DB	"80286",CR,LF,00H
             88A2 : 0A 00             
    1300/    88A4 : 38 30 33 38 36 0D   IM386:	DB	"80386",CR,LF,00H
             88AA : 0A 00             
    1301/    88AC : 55 6E 6B 6E 6F 77   IMUNK:	DB	"Unknown",CR,LF,00H
             88B2 : 6E 0D 0A 00       
    1302/    88B6 :                     
    1303/    88B6 : [1293]               	ENDIF
    1304/    88B6 :                     	
    1305/    88B6 : 44 69 76 69 64 65   DIVMSG:	DB	"Divide error",CR,LF,00H
             88BC : 20 65 72 72 6F 72 
             88C2 : 0D 0A 00          
    1306/    88C5 : 53 74 65 70 0D 0A   STPMSG:	DB	"Step",CR,LF,00H
             88CB : 00                
    1307/    88CC : 4E 4D 49 0D 0A 00   NMIMSG:	DB	"NMI",CR,LF,00H
    1308/    88D2 : 42 72 65 61 6B 0D   BRKMSG:	DB	"Break",CR,LF,00H
             88D8 : 0A 00             
    1309/    88DA : 4F 76 65 72 66 6C   OVFMSG:	DB	"Overflow",CR,LF,00H
             88E0 : 6F 77 0D 0A 00    
    1310/    88E5 :                     
    1311/    88E5 : 21 89 20 05         RDTAB:	DW	RDSAX, REGAX
    1312/    88E9 : 25 89 22 05         	DW	RDSBX, REGBX
    1313/    88ED : 2A 89 24 05         	DW	RDSCX, REGCX
    1314/    88F1 : 2F 89 26 05         	DW	RDSDX, REGDX
    1315/    88F5 : 34 89 28 05         	DW	RDSF,  REGF
    1316/    88F9 : 39 89 34 05         	DW	RDSCS, REGCS
    1317/    88FD : 3E 89 36 05         	DW	RDSDS, REGDS
    1318/    8901 : 43 89 38 05         	DW	RDSSS, REGSS
    1319/    8905 : 48 89 3A 05         	DW	RDSES, REGES
    1320/    8909 : 4D 89 2A 05         	DW	RDSSP, REGSP
    1321/    890D : 53 89 2C 05         	DW	RDSBP, REGBP
    1322/    8911 : 58 89 2E 05         	DW	RDSSI, REGSI
    1323/    8915 : 5D 89 30 05         	DW	RDSDI, REGDI
    1324/    8919 : 62 89 32 05         	DW	RDSIP, REGIP
    1325/    891D :                     	
    1326/    891D : 00 00 00 00         	DW	0000H, 0000H
    1327/    8921 :                     
    1328/    8921 : 41 58 3D 00         RDSAX:	DB	"AX=",00H
    1329/    8925 : 20 42 58 3D 00      RDSBX:	DB	" BX=",00H
    1330/    892A : 20 43 58 3D 00      RDSCX:	DB	" CX=",00H
    1331/    892F : 20 44 58 3D 00      RDSDX:	DB	" DX=",00H
    1332/    8934 : 20 46 4C 3D 00      RDSF:	DB	" FL=",00H
    1333/    8939 : 20 43 53 3D 00      RDSCS:	DB	" CS=",00H
    1334/    893E : 20 44 53 3D 00      RDSDS:	DB	" DS=",00H
    1335/    8943 : 20 53 53 3D 00      RDSSS:	DB	" SS=",00H
    1336/    8948 : 20 45 53 3D 00      RDSES:	DB	" ES=",00H
    1337/    894D : 0D 0A 53 50 3D 00   RDSSP:	DB	CR,LF,"SP=",00H
    1338/    8953 : 20 42 50 3D 00      RDSBP:	DB	" BP=",00H
    1339/    8958 : 20 53 49 3D 00      RDSSI:	DB	" SI=",00H
    1340/    895D : 20 44 49 3D 00      RDSDI:	DB	" DI=",00H
    1341/    8962 : 20 49 50 3D 00      RDSIP:	DB	" IP=",00H
    1342/    8967 :                     
    1343/    8967 : 20 46 4C 62 3D 00   FLGB:	db	" FLb=",00h
    1344/    896D : 2E 2E 2E 2E 4F 44   Fbiton:	db	"....ODITSZ.A.P.C"
             8973 : 49 54 53 5A 2E 41 
             8979 : 2E 50 2E 43       
    1345/    897D :                     
    1346/    897D :                     
    1347/    897D :                     RNTAB:
    1348/    897D : 41 0F               	DB	'A',0FH		; "A?"
    1349/    897F : B3 89 00 00         	DW	RNTABA,0
    1350/    8983 : 42 0F               	DB	'B',0FH		; "B?"
    1351/    8985 : CB 89 00 00         	DW	RNTABB,0
    1352/    8989 : 43 0F               	DB	'C',0FH		; "C?"
    1353/    898B : E9 89 00 00         	DW	RNTABC,0
    1354/    898F : 44 0F               	DB	'D',0FH		; "D?"
    1355/    8991 : 07 8A 00 00         	DW	RNTABD,0
    1356/    8995 : 45 0F               	DB	'E',0FH		; "E?"
    1357/    8997 : 07 8A 00 00         	DW	RNTABD,0
    1358/    899B : 46 02               	DB	'F',2		; "F"
    1359/    899D : 28 05 8E 8A         	DW	REGF,RNF
    1360/    89A1 : 49 0F               	DB	'I',0FH		; "I?"
    1361/    89A3 : 37 8A 00 00         	DW	RNTABI,0
    1362/    89A7 : 53 0F               	DB	'S',0FH		; "S?"
    1363/    89A9 : 43 8A 00 00         	DW	RNTABS,0
    1364/    89AD :                     
    1365/    89AD : 00 00               	DB	00H,0		; End mark
    1366/    89AF : 00 00 00 00         	DW	0,0
    1367/    89B3 :                     	
    1368/    89B3 :                     RNTABA:
    1369/    89B3 : 58 02               	DB	'X',2		; "AX"
    1370/    89B5 : 20 05 5B 8A         	DW	REGAX,RNAX
    1371/    89B9 : 48 01               	DB	'H',1		; "AH"
    1372/    89BB : 21 05 5E 8A         	DW	REGAX+1,RNAH
    1373/    89BF : 4C 01               	DB	'L',1		; "AL"
    1374/    89C1 : 20 05 61 8A         	DW	REGAX,RNAL
    1375/    89C5 :                     
    1376/    89C5 : 00 00               	DB	00H,0		; End mark
    1377/    89C7 : 00 00 00 00         	DW	0,0
    1378/    89CB :                     
    1379/    89CB :                     RNTABB:
    1380/    89CB : 58 02               	DB	'X',2		; "BX"
    1381/    89CD : 22 05 64 8A         	DW	REGBX,RNBX
    1382/    89D1 : 48 01               	DB	'H',1		; "BH"
    1383/    89D3 : 23 05 67 8A         	DW	REGBX+1,RNBH
    1384/    89D7 : 4C 01               	DB	'L',1		; "BL"
    1385/    89D9 : 22 05 6A 8A         	DW	REGBX,RNBL
    1386/    89DD : 50 02               	DB	'P',2		; "BP"
    1387/    89DF : 2C 05 6D 8A         	DW	REGBP,RNBP
    1388/    89E3 :                     	
    1389/    89E3 : 00 00               	DB	00H,0		; End mark
    1390/    89E5 : 00 00 00 00         	DW	0,0
    1391/    89E9 :                     
    1392/    89E9 :                     RNTABC:
    1393/    89E9 : 58 02               	DB	'X',2		; "CX"
    1394/    89EB : 24 05 70 8A         	DW	REGCX,RNCX
    1395/    89EF : 48 01               	DB	'H',1		; "CH"
    1396/    89F1 : 25 05 73 8A         	DW	REGCX+1,RNCH
    1397/    89F5 : 4C 01               	DB	'L',1		; "CL"
    1398/    89F7 : 24 05 76 8A         	DW	REGCX,RNCL
    1399/    89FB : 53 02               	DB	'S',2		; "CS"
    1400/    89FD : 34 05 79 8A         	DW	REGCS,RNCS
    1401/    8A01 :                     	
    1402/    8A01 : 00 00               	DB	00H,0		; End mark
    1403/    8A03 : 00 00 00 00         	DW	0,0
    1404/    8A07 :                     	
    1405/    8A07 :                     RNTABD:
    1406/    8A07 : 58 02               	DB	'X',2		; "DX"
    1407/    8A09 : 26 05 7C 8A         	DW	REGDX,RNDX
    1408/    8A0D : 48 01               	DB	'H',1		; "DH"
    1409/    8A0F : 27 05 7F 8A         	DW	REGDX+1,RNDH
    1410/    8A13 : 4C 01               	DB	'L',1		; "DL"
    1411/    8A15 : 26 05 82 8A         	DW	REGDX,RNDL
    1412/    8A19 : 49 02               	DB	'I',2		; "DI"
    1413/    8A1B : 30 05 85 8A         	DW	REGDI,RNDI
    1414/    8A1F : 53 02               	DB	'S',2		; "DS"
    1415/    8A21 : 36 05 88 8A         	DW	REGDS,RNDS
    1416/    8A25 :                     	
    1417/    8A25 : 00 00               	DB	00H,0		; End mark
    1418/    8A27 : 00 00 00 00         	DW	0,0
    1419/    8A2B :                     
    1420/    8A2B :                     RNTABE:
    1421/    8A2B : 53 02               	DB	'S',2		; "ES"
    1422/    8A2D : 3A 05 8B 8A         	DW	REGES,RNES
    1423/    8A31 :                     	
    1424/    8A31 : 00 00               	DB	00H,0		; End mark
    1425/    8A33 : 00 00 00 00         	DW	0,0
    1426/    8A37 :                     	
    1427/    8A37 :                     RNTABI:
    1428/    8A37 : 50 02               	DB	'P',2		; "IP"
    1429/    8A39 : 32 05 90 8A         	DW	REGIP,RNIP
    1430/    8A3D :                     	
    1431/    8A3D : 00 00               	DB	00H,0		; End mark
    1432/    8A3F : 00 00 00 00         	DW	0,0
    1433/    8A43 :                     	
    1434/    8A43 :                     RNTABS:
    1435/    8A43 : 49 02               	DB	'I',2		; "SI"
    1436/    8A45 : 2E 05 93 8A         	DW	REGSI,RNSI
    1437/    8A49 : 50 02               	DB	'P',2		; "SP"
    1438/    8A4B : 2A 05 96 8A         	DW	REGSP,RNSP
    1439/    8A4F : 53 02               	DB	'S',2		; "SS"
    1440/    8A51 : 38 05 99 8A         	DW	REGSS,RNSS
    1441/    8A55 :                     	
    1442/    8A55 : 00 00               	DB	00H,0		; End mark
    1443/    8A57 : 00 00 00 00         	DW	0,0
    1444/    8A5B :                     	
    1445/    8A5B : 41 58 00            RNAX:	DB	"AX",00H
    1446/    8A5E : 41 48 00            RNAH:	DB	"AH",00H
    1447/    8A61 : 41 4C 00            RNAL:	DB	"AL",00H
    1448/    8A64 : 42 58 00            RNBX:	DB	"BX",00H
    1449/    8A67 : 42 48 00            RNBH:	DB	"BH",00H
    1450/    8A6A : 42 4C 00            RNBL:	DB	"BL",00H
    1451/    8A6D : 42 50 00            RNBP:	DB	"BP",00H
    1452/    8A70 : 43 58 00            RNCX:	DB	"CX",00H
    1453/    8A73 : 43 48 00            RNCH:	DB	"CH",00H
    1454/    8A76 : 43 4C 00            RNCL:	DB	"CL",00H
    1455/    8A79 : 43 53 00            RNCS:	DB	"CS",00H
    1456/    8A7C : 44 58 00            RNDX:	DB	"DX",00H
    1457/    8A7F : 44 48 00            RNDH:	DB	"DH",00H
    1458/    8A82 : 44 4C 00            RNDL:	DB	"DL",00H
    1459/    8A85 : 44 49 00            RNDI:	DB	"DI",00H
    1460/    8A88 : 44 53 00            RNDS:	DB	"DS",00H
    1461/    8A8B : 45 53 00            RNES:	DB	"ES",00H
    1462/    8A8E : 46 00               RNF:	DB	"F",00H
    1463/    8A90 : 49 50 00            RNIP:	DB	"IP",00H
    1464/    8A93 : 53 49 00            RNSI:	DB	"SI",00H
    1465/    8A96 : 53 50 00            RNSP:	DB	"SP",00H
    1466/    8A99 : 53 53 00            RNSS:	DB	"SS",00H
    1467/    8A9C :                     
    1468/    8A9C :                     ;;;
    1469/    8A9C :                     ;;; 	8251 Console Driver
    1470/    8A9C :                     ;;;
    1471/    8A9C :                     INIT:
    1472/    8A9C :                     	;; Reset USART
    1473/    8A9C : B0 00               	MOV	AL,00H
    1474/    8A9E : E6 01               	OUT	USARTC,AL
    1475/    8AA0 : 90                  	NOP
    1476/    8AA1 : 90                  	NOP
    1477/    8AA2 : B0 00               	MOV	AL,00H
    1478/    8AA4 : E6 01               	OUT	USARTC,AL
    1479/    8AA6 : 90                  	NOP
    1480/    8AA7 : 90                  	NOP
    1481/    8AA8 : B0 00               	MOV	AL,00H
    1482/    8AAA : E6 01               	OUT	USARTC,AL
    1483/    8AAC : 90                  	NOP
    1484/    8AAD : 90                  	NOP
    1485/    8AAE : B0 40               	MOV	AL,40H
    1486/    8AB0 : E6 01               	OUT	USARTC,AL
    1487/    8AB2 : 90                  	NOP
    1488/    8AB3 : 90                  	NOP
    1489/    8AB4 :                     	
    1490/    8AB4 :                     	;;
    1491/    8AB4 : B0 4E               	MOV	AL,4EH
    1492/    8AB6 : E6 01               	OUT	USARTC,AL
    1493/    8AB8 : 90                  	NOP
    1494/    8AB9 : 90                  	NOP
    1495/    8ABA :                     
    1496/    8ABA :                     	;;
    1497/    8ABA : B0 37               	MOV	AL,37H
    1498/    8ABC : E6 01               	OUT	USARTC,AL
    1499/    8ABE :                     ;
    1500/    8ABE :                     ;	Buffer initialize
    1501/    8ABE : 33 C0               	xor	ax, ax			;Clear al
    1502/    8AC0 : A2 06 04            	mov	[RBFCNT], al		;Set count of chars
    1503/    8AC3 : A3 04 04            	mov	[RBFRDP], ax		;Set read point
    1504/    8AC6 : A3 05 04            	mov	[RBFWTP], ax		;Set write point
    1505/    8AC9 : A2 08 04            	mov	[tx_xflg], al
    1506/    8ACC : A2 00 04            	mov	[MAXCNT], al
    1507/    8ACF : A3 02 04            	mov	[LOSTC], ax
    1508/    8AD2 : B0 11               	mov	al, XON
    1509/    8AD4 : A2 07 04            	mov	[rx_xflg], al
    1510/    8AD7 : EB 66               	jmp	CONOUT
    1511/    8AD9 :                     
    1512/    8AD9 :                     ;
    1513/    8AD9 :                     ; input charctor to console
    1514/    8AD9 :                     ; outputt al : char
    1515/    8AD9 :                     ;
    1516/    8AD9 :                     CONIN:
    1517/    8AD9 : 53                  	push	bx
    1518/    8ADA : 51                  	push	cx
    1519/    8ADB :                     ;
    1520/    8ADB : A0 06 04            gcst1:	mov	al, [RBFCNT]
    1521/    8ADE : 0A C0               	or	al, al			;Buffer enpty?
    1522/    8AE0 : 74 F9               	je	gcst1
    1523/    8AE2 :                     
    1524/    8AE2 : FA                  	cli
    1525/    8AE3 : 8A 26 06 04         	mov	ah, [RBFCNT]
    1526/    8AE7 : FE CC               	dec	ah
    1527/    8AE9 : 88 26 06 04         	mov	[RBFCNT], ah	; update
    1528/    8AED :                     ;
    1529/    8AED : 8A 1E 04 04         	mov	bl, [RBFRDP]	;Get read point
    1530/    8AF1 : B7 00               	mov	bh, 0
    1531/    8AF3 : 8A 87 09 04         	mov	al, [bx+RECBUF]	;Read char from buffer
    1532/    8AF7 :                     ;
    1533/    8AF7 : FE C3               	inc	bl		;Next read point
    1534/    8AF9 : 80 FB F0            	cmp	bl, BUFSIZ
    1535/    8AFC : 75 02               	jnz	sv_rdptr
    1536/    8AFE : 32 DB               	xor	bl, bl		;Wrap
    1537/    8B00 :                     ;	and	bl,BUFSIZ-1	;Wrap
    1538/    8B00 :                     sv_rdptr:
    1539/    8B00 : 88 1E 04 04         	mov	[RBFRDP] ,bl	;Update
    1540/    8B04 : FB                  	sti
    1541/    8B05 :                     
    1542/    8B05 : 8A C8               	mov	cl, al		; save a char
    1543/    8B07 : 32 E4               	xor	ah, ah		; make XON base digit
    1544/    8B09 :                     
    1545/    8B09 : 80 3E 07 04 13      	cmp	byte ptr [rx_xflg], XOFF	; XOFF?
    1546/    8B0E : 75 0C               	jne	chk_xon
    1547/    8B10 :                     
    1548/    8B10 :                     	; XOFF state is here
    1549/    8B10 : 80 3E 06 04 0A      	cmp	byte ptr [RBFCNT], RBLOW	; need XON action?
    1550/    8B15 : 76 10               	jbe	need_xon
    1551/    8B17 :                     	;
    1552/    8B17 :                     gcst5:	; get a char to al
    1553/    8B17 : 8A C1               	mov	al, cl
    1554/    8B19 : 59                  	pop	cx
    1555/    8B1A : 5B                  	pop	bx
    1556/    8B1B : C3                  	ret
    1557/    8B1C :                     
    1558/    8B1C :                     	; XON state is here
    1559/    8B1C :                     chk_xon:
    1560/    8B1C :                     
    1561/    8B1C : A0 01 04            	mov	al, [tsh]			; get threshold value
    1562/    8B1F : 38 06 06 04         	cmp	[RBFCNT], al			; need XOFF action?
    1563/    8B23 : 72 F2               	jb	gcst5				; return if char buffering state
    1564/    8B25 : B4 02               	mov	ah, XOFF-XON			; set XOFF base digit
    1565/    8B27 :                     need_xon:
    1566/    8B27 : 80 C4 11            	add	ah, XON		; make XON or XOFF
    1567/    8B2A :                     
    1568/    8B2A :                     gcst2:
    1569/    8B2A : E4 01               	IN	AL,USARTC
    1570/    8B2C : 24 01               	AND	AL,01H
    1571/    8B2E : 74 FA               	JZ	gcst2
    1572/    8B30 :                     
    1573/    8B30 : 8A C4               	mov	al, ah		; set XON or XOFF
    1574/    8B32 : E6 00               	OUT	USARTD,AL
    1575/    8B34 : A2 07 04            	mov	[rx_xflg], al	; update xon/xoff flag
    1576/    8B37 : EB DE               	jmp	gcst5
    1577/    8B39 :                     
    1578/    8B39 :                     ;
    1579/    8B39 :                     ; check console
    1580/    8B39 :                     ; outputt al : key
    1581/    8B39 :                     ;
    1582/    8B39 :                     CONST:
    1583/    8B39 : A0 06 04            	mov	al, [RBFCNT]	;Get count of char
    1584/    8B3C : 0A C0               	or	al, al
    1585/    8B3E : C3                  	RET
    1586/    8B3F :                     
    1587/    8B3F :                     ;
    1588/    8B3F :                     ; output charctor to console
    1589/    8B3F :                     ; input al : char
    1590/    8B3F :                     ;
    1591/    8B3F :                     CONOUT:
    1592/    8B3F : 8A E0               	mov	ah, al		; save char
    1593/    8B41 :                     cnout1:
    1594/    8B41 : 80 3E 08 04 00      	cmp	byte ptr [tx_xflg], 0
    1595/    8B46 : 75 F9               	jne	cnout1
    1596/    8B48 :                     
    1597/    8B48 :                     COUT0:
    1598/    8B48 : E4 01               	IN	AL,USARTC
    1599/    8B4A : 24 01               	AND	AL,01H
    1600/    8B4C : 74 FA               	JZ	COUT0
    1601/    8B4E :                     
    1602/    8B4E : 8A C4               	mov	al, ah		; restore char
    1603/    8B50 : E6 00               	OUT	USARTD,AL
    1604/    8B52 : C3                  	RET
    1605/    8B53 :                     ;
    1606/    8B53 :                     ;	8251 -> buffer by interrupt
    1607/    8B53 :                     ;
    1608/    8B53 : 50                  intsr:	push	ax	;Save ax
    1609/    8B54 : 53                  	push	bx	;Save bx
    1610/    8B55 :                     
    1611/    8B55 : E4 00               	in	al, USARTD	; Get char
    1612/    8B57 :                     
    1613/    8B57 : 3C 13               	cmp	al, XOFF	; get XOFF for tx side from console
    1614/    8B59 : 75 05               	jne	intsr1
    1615/    8B5B :                     
    1616/    8B5B : A2 08 04            	mov	[tx_xflg], al	; set tx stop request
    1617/    8B5E : EB 3B               	jmp	isext		; exit
    1618/    8B60 :                     	
    1619/    8B60 :                     intsr1:
    1620/    8B60 : 3C 11               	cmp	al, XON
    1621/    8B62 : 75 07               	jne	intsr2
    1622/    8B64 :                     
    1623/    8B64 : 32 C0               	xor	al, al
    1624/    8B66 : A2 08 04            	mov	[tx_xflg], al	; clear tx stop request
    1625/    8B69 : EB 30               	jmp	isext		; exit
    1626/    8B6B :                     
    1627/    8B6B :                     intsr2:
    1628/    8B6B : 8A 26 06 04         	mov	ah, [RBFCNT]
    1629/    8B6F : 80 FC F0            	cmp	ah, BUFSIZ
    1630/    8B72 : 74 2A               	je	isext1		;If yes, ignore
    1631/    8B74 :                     
    1632/    8B74 : FE C4               	inc	ah
    1633/    8B76 : 88 26 06 04         	mov	[RBFCNT], ah	;Update
    1634/    8B7A :                     
    1635/    8B7A : 3A 26 00 04         	cmp	ah, [MAXCNT]
    1636/    8B7E : 76 04               	jbe	rec1
    1637/    8B80 : 88 26 00 04         	mov	[MAXCNT], ah	; update max count
    1638/    8B84 :                     rec1:
    1639/    8B84 : 8A 1E 05 04         	mov	bl, [RBFWTP]
    1640/    8B88 : B7 00               	mov	bh, 0
    1641/    8B8A : 88 87 09 04         	mov	[bx+RECBUF], al	;Write char into buffer
    1642/    8B8E :                     
    1643/    8B8E : FE C3               	inc	bl		;Next write point
    1644/    8B90 : 80 FB F0            	cmp	bl, BUFSIZ
    1645/    8B93 : 75 02               	jnz	sv_wtptr
    1646/    8B95 : 32 DB               	xor	bl, bl		;Wrap
    1647/    8B97 :                     ;	and	bl,BUFSIZ-1	;Wrap
    1648/    8B97 :                     sv_wtptr:
    1649/    8B97 : 88 1E 05 04         	mov	[RBFWTP], bl	;Update
    1650/    8B9B :                     
    1651/    8B9B :                     isext:
    1652/    8B9B : 5B                  	pop	bx	;Restore bx
    1653/    8B9C : 58                  	pop	ax	;Restore ax
    1654/    8B9D : CF                  	iret
    1655/    8B9E :                     
    1656/    8B9E :                     isext1:
    1657/    8B9E : FF 06 02 04         	inc	word ptr [LOSTC]
    1658/    8BA2 : EB F7               	jmp	isext
    1659/    8BA4 :                     
    1660/    8BA4 : FF FF FF FF FF FF   	db	($ & 0FF00H)+100H-$ dup(0FFH)
             8BAA : FF FF FF FF FF FF 
             8BB0 : FF FF FF FF FF FF 
             8BB6 : FF FF FF FF FF FF 
             8BBC : FF FF FF FF FF FF 
             8BC2 : FF FF FF FF FF FF 
             8BC8 : FF FF FF FF FF FF 
             8BCE : FF FF FF FF FF FF 
             8BD4 : FF FF FF FF FF FF 
             8BDA : FF FF FF FF FF FF 
             8BE0 : FF FF FF FF FF FF 
             8BE6 : FF FF FF FF FF FF 
             8BEC : FF FF FF FF FF FF 
             8BF2 : FF FF FF FF FF FF 
             8BF8 : FF FF FF FF FF FF 
             8BFE : FF FF             
    1661/    8C00 :                     
    1662/    8C00 :                     	;;
    1663/    8C00 :                     	;; Reset entry point
    1664/    8C00 :                     	;;
    1665/    8C00 :                     	
    1666/    8C00 :                     ;	ORG	( 0FFFF0H - ROMSEG * 16 )
    1667/    FFF0 :                     	ORG	0FFF0H
    1668/    FFF0 :                     
    1669/    FFF0 : EA 00 80 00 00      	JMPF	ROMSEG:CSTART
    1670/    FFF5 :                     	
    1671/    FFF5 :                     ;;;
    1672/    FFF5 :                     ;;; RAM area
    1673/    FFF5 :                     ;;;
    1674/    FFF5 :                     
    1675/       0 :                     	SEGMENT	DATA
    1676/       0 :                     
    1677/       0 :                     	;;
    1678/       0 :                     	;; Work area
    1679/       0 :                     	;;
    1680/       0 :                     
    1681/     400 :                     	ORG	WORK_B
    1682/     400 :                     
    1683/     400 :                     ;
    1684/     400 :                     ;	Receive buffer
    1685/     400 :                     MAXCNT	ds	1
    1686/     401 :                     tsh	ds	1
    1687/     402 :                     LOSTC	ds	2
    1688/     404 :                     RBFRDP	ds	1	;Read address
    1689/     405 :                     RBFWTP	ds	1	;Write address
    1690/     406 :                     RBFCNT	ds	1	;Count of chars
    1691/     407 :                     rx_xflg	ds	1
    1692/     408 :                     tx_xflg	ds	1
    1693/     409 :                     RECBUF	ds	BUFSIZ	;Buffer
    1694/     4F9 :                     
    1695/     4F9 :                     
    1696/     4F9 :                     INBUF:	DS	BUFLEN	; Line input buffer
    1697/     511 :                     CURSEG:	DS	2	; Current segment
    1698/     513 :                     DSADDR:	DS	2	; DUMP start address
    1699/     515 :                     DEADDR:	DS	2	; DUMP end address
    1700/     517 :                     DSTATE:	DS	1	; DUMP state
    1701/     518 :                     	ALIGN	2
    1702/     518 :                     GADDR:	DS	2	; GO address
    1703/     51A :                     SADDR:	DS	2	; SET address
    1704/     51C :                     HEXMOD:	DS	1	; HEX file mode
    1705/     51D :                     PSPEC:	DS	1	; Processor spec.
    1706/     51E :                     
    1707/     51E :                     RECTYP:	DS	1	; Record type
    1708/     51F :                     
    1709/     51F :                     	ALIGN	2
    1710/     520 :                     REG_B:	
    1711/     520 :                     REGAX:	DS	2
    1712/     522 :                     REGBX:	DS	2
    1713/     524 :                     REGCX:	DS	2
    1714/     526 :                     REGDX:	DS	2
    1715/     528 :                     REGF:	DS	2
    1716/     52A :                     REGSP:	DS	2		; Stack Pointer SP
    1717/     52C :                     REGBP:	DS	2		; Base Pointer BP
    1718/     52E :                     REGSI:	DS	2		; Source Index SI
    1719/     530 :                     REGDI:	DS	2		; Destination Index DI
    1720/     532 :                     REGIP:	DS	2		; Instruction Pointer IP
    1721/     534 :                     REGCS:	DS	2		; Code Segment CS
    1722/     536 :                     REGDS:	DS	2		; Data Segment DS
    1723/     538 :                     REGSS:	DS	2		; Stack Segment SS
    1724/     53A :                     REGES:	DS	2		; Extra Segment ES
    1725/     53C :                     REG_E:	
    1726/     53C :                     
    1727/     53C :                     ; break point
    1728/     53C :                     bflg	ds	1
    1729/     53D :                     bp_code	ds	1
    1730/     53E :                     brkcs	ds	2
    1731/     540 :                     brkip	ds	2
    1732/     542 :                     
    1733/     542 :                     ; Frag register bit image string buffer
    1734/     542 :                     F_bit:		ds	F_bitSize+1
    1735/     553 :                     
    1736/     553 :                     	END
 AS V1.42 Beta [Bld 227] - Source File unimon_8086_INTR.asm - Page 2 - 3/4/2023 17:5:23


  Symbol Table (* = unused):
  --------------------------

*ARCHITECTURE :                                        "i386-unknown-win32" - |
 BFLG :                         53C D |  BP_CODE :                      53D D |
 BRKCS :                        53E D |  BRKIP :                        540 D |
 BRKMSG :                      88D2 C |  BS :                             8 - |
 BUFLEN :                        18 - |  BUFSIZ :                       0F0 - |
*CASESENSITIVE :                  0 - |  CHK_BPT :                     87C3 C |
 CHK_XON :                     8B1C C |  CNOUT1 :                      8B41 C |
*COMPMODE :                       0 - |  CONIN :                       8AD9 C |
 CONOUT :                      8B3F C |  CONST :                       8B39 C |
*CONSTPI :        3.141592653589793 - |  COUT0 :                       8B48 C |
 CPUM :                        8871 C |  CR :                            0D - |
 CRLF :                        8650 C |  CSTART :                      8000 C |
 CURSEG :                       511 D | *DATE :                  "3/4/2023" - |
 DEADDR :                       515 D |  DEL :                           7F - |
 DIVMSG :                      88B6 C |  DP0 :                         8174 C |
 DP01 :                        8186 C |  DP1 :                         819E C |
 DPB :                         822F C |  DPB0 :                        8241 C |
 DPB1 :                        8250 C |  DPB2 :                        8255 C |
 DPB3 :                        8271 C |  DPL :                         81E8 C |
 DPL0 :                        8204 C |  DPL1 :                        8215 C |
 DPL2 :                        8225 C |  DPL3 :                        822A C |
 DPM :                         81B4 C |  DPM0 :                        81C4 C |
 DPM1 :                        81DE C |  DSADDR :                       513 D |
 DSEP0 :                       883B C |  DSEP1 :                       883E C |
 DSTATE :                       517 D |  DUMP :                        8157 C |
 ERR :                         814F C |  ERRMSG :                      8833 C |
*FALSE :                          0 - |  FBITON :                      896D C |
 FB_LOOP :                     8564 C |  FLGB :                        8967 C |
*FULLPMMU :                       1 - |  FULSIZ :                        30 - |
 F_BIT :                        542 D |  F_BITSIZE :                     10 - |
 F_MSK_BIT :                   0FD5 - |  G0 :                          8291 C |
 G0_0 :                        82BF C |  G1 :                          8298 C |
 G2 :                          82AD C |  GADDR :                        518 D |
 GCST1 :                       8ADB C |  GCST2 :                       8B2A C |
 GCST5 :                       8B17 C |  GE :                          82AA C |
 GETLIN :                      865A C |  GL0 :                         865F C |
 GLB :                         8689 C |  GLE :                         86A1 C |
 GO :                          8272 C |  GO_ANYWHERE :                 82EA C |
 GO_GO :                       82CF C | *HAS64 :                          0 - |
*HASFPU :                         0 - | *HASPMMU :                        0 - |
 HEXIN :                       8624 C |  HEXMOD :                       51C D |
 HEXOUT1 :                     8617 C |  HEXOUT2 :                     860A C |
 HEXOUT4 :                     8603 C |  HI0 :                         8631 C |
 HI1 :                         864B C |  HIR :                         864F C |
 HO10 :                        8621 C | *IBIT_OFF :                    0DD6 - |
 IDE :                         8102 C |  ID_286 :                      80E2 C |
 ID_386 :                      80F6 C |  ID_UNK :                      80FD C |
 ID_V30 :                      80DB C |  IHEMSG :                      8819 C |
*IHEXER :                      8842 C | *IM186 :                       8884 C |
 IM286 :                       889C C |  IM386 :                       88A4 C |
 IM86 :                        8878 C |  IMUNK :                       88AC C |
 IMV30 :                       8892 C |  INBUF :                        4F9 D |
 INI0 :                        806F C |  INI1 :                        8088 C |
 INI2 :                        8096 C |  INIT :                        8A9C C |
 INIT_FL_ :                     202 - |  INIVEC :                      885D C |
 INIVECE :                     8871 C | *INSUPMODE :                      0 - |
 INT0 :                        8788 C |  INT21VEC :                      84 - |
 INTBRK :                      875D C |  INTDIV :                      8731 C |
 INTDMY :                      87E2 C |  INTFFVEC :                     3FC - |
 INTFNC :                      86EE C |  INTOVF :                      8774 C |
 INTSR :                       8B53 C |  INTSR1 :                      8B60 C |
 INTSR2 :                      8B6B C |  INTSTP :                      8747 C |
 IR0 :                         8035 C |  ISEXT :                       8B9B C |
 ISEXT1 :                      8B9E C |  LF :                            0A - |
 LH0 :                         83C8 C |  LH1 :                         83CA C |
 LH2 :                         83D6 C |  LH3 :                         83E9 C |
 LHE :                         83F6 C |  LHI0 :                        83F9 C |
 LHI1 :                        841E C |  LHI2 :                        842F C |
 LHI3 :                        8433 C |  LHIE :                        8447 C |
 LHS0 :                        8450 C |  LHS1 :                        8476 C |
 LHS2 :                        8488 C |  LHS3 :                        848C C |
 LHSE :                        849F C |  LHSR :                        8441 C |
*LISTON :                         1 - |  LOADH :                       83AC C |
 LOSTC :                        402 D |  M00 :                         812C C |
 M01 :                         8133 C |  M02 :                         813A C |
 M03 :                         8141 C |  M05 :                         8148 C |
 M06 :                         814F C | *MACEXP :                         7 - |
 MAXCNT :                       400 D | *MOMCPU :                      8086 - |
*MOMCPUNAME :                "8086" - |  MSGOE :                       85F5 C |
 MSGOUT :                      85E8 C |  NEED_XON :                    8B27 C |
*NESTMAX :                      100 - |  NFNC1 :                       86FF C |
 NFNC2 :                       870A C |  NFNC3 :                       8717 C |
*NFNC31 :                      8726 C |  NFNC4 :                       8716 C |
*NMIMSG :                      88CC C |  NOBRKP :                      87DE C |
 OPNMSG :                      87E3 C |  OVFMSG :                      88DA C |
*PADDING :                        1 - |  PROMPT :                      8816 C |
 PSPEC :                        51D D |  RAMSEG :                         0 - |
 RBFCNT :                       406 D |  RBFRDP :                       404 D |
 RBFWTP :                       405 D |  RBLOW :                         0A - |
 RD0 :                         8538 C |  RD1 :                         8550 C |
 RDF1 :                        856D C |  RDF2 :                        8571 C |
 RDHEX :                       86BE C |  RDSAX :                       8921 C |
 RDSBP :                       8953 C |  RDSBX :                       8925 C |
 RDSCS :                       8939 C |  RDSCX :                       892A C |
 RDSDI :                       895D C |  RDSDS :                       893E C |
 RDSDX :                       892F C |  RDSES :                       8948 C |
 RDSF :                        8934 C |  RDSIP :                       8962 C |
 RDSSI :                       8958 C |  RDSSP :                       894D C |
 RDSSS :                       8943 C |  RDTAB :                       88E5 C |
 RDUMP :                       8535 C |  REC1 :                        8B84 C |
 RECBUF :                       409 D |  RECTYP :                       51E D |
 REG :                         84A8 C |  REGAX :                        520 D |
 REGBP :                        52C D |  REGBX :                        522 D |
 REGCS :                        534 D |  REGCX :                        524 D |
 REGDI :                        530 D |  REGDS :                        536 D |
 REGDX :                        526 D |  REGES :                        53A D |
 REGF :                         528 D |  REGIP :                        532 D |
 REGSI :                        52E D |  REGSP :                        52A D |
 REGSS :                        538 D |  REG_B :                        520 D |
 REG_E :                        53C D | *RELAXED :                        0 - |
 RG0 :                         84B9 C |  RG1 :                         84BC C |
 RG2 :                         84CE C |  RG3 :                         84E2 C |
 RG4 :                         850B C |  RG5 :                         8510 C |
 RG6 :                         852D C |  RG7 :                         852F C |
 RGE :                         8532 C |  RGR :                         852F C |
 RH0 :                         86C5 C |  RH1 :                         86DC C |
 RHE :                         86ED C |  RNAH :                        8A5E C |
 RNAL :                        8A61 C |  RNAX :                        8A5B C |
 RNBH :                        8A67 C |  RNBL :                        8A6A C |
 RNBP :                        8A6D C |  RNBX :                        8A64 C |
 RNCH :                        8A73 C |  RNCL :                        8A76 C |
 RNCS :                        8A79 C |  RNCX :                        8A70 C |
 RNDH :                        8A7F C |  RNDI :                        8A85 C |
 RNDL :                        8A82 C |  RNDS :                        8A88 C |
 RNDX :                        8A7C C |  RNES :                        8A8B C |
 RNF :                         8A8E C |  RNIP :                        8A90 C |
 RNSI :                        8A93 C |  RNSP :                        8A96 C |
 RNSS :                        8A99 C |  RNTAB :                       897D C |
 RNTABA :                      89B3 C |  RNTABB :                      89CB C |
 RNTABC :                      89E9 C |  RNTABD :                      8A07 C |
*RNTABE :                      8A2B C |  RNTABI :                      8A37 C |
 RNTABS :                      8A43 C |  ROMSEG :                         0 - |
 ROM_B :                       8000 - |  RX_XFLG :                      407 D |
 SADDR :                        51A D |  SETM :                        8322 C |
 SHEMSG :                      8826 C |  SKIPSP :                      86A9 C |
 SM0 :                         833C C |  SM1 :                         8349 C |
 SM2 :                         8386 C |  SM3 :                         8391 C |
 SM4 :                         8398 C |  SME :                         83A9 C |
*SRECER :                      8850 C |  SSR :                         86B2 C |
 STACK :                        600 - |  STPMSG :                      88C5 C |
 STROE :                       8602 C |  STROUT :                      85F6 C |
 SV_RDPTR :                    8B00 C |  SV_WTPTR :                    8B97 C |
 T0 :                          859D C |  T1 :                          85A4 C |
*TARGET :                    "8088" - |  TBIT_OFF :                    0ED6 - |
 TBIT_ON_ :                     100 - |  TE :                          85AA C |
*TIME :                   "17:5:23" - |  TO_GO :                       85AD C |
 TRACE :                       8583 C | *TRUE :                           1 - |
 TSH :                          401 D |  TX_XFLG :                      408 D |
 UPPER :                       86B3 C |  UPR :                         86BD C |
 USARTC :                         1 - |  USARTD :                         0 - |
 USE_IDENT :                      1 - |  U_STACK :                      700 - |
 VECSIZ :                       100 - | *VERSION :                     142F - |
 WORK_B :                       400 - |  WSTART :                      8110 C |
 XOFF :                          13 - |  XON :                           11 - |

    307 symbols
     29 unused symbols

 AS V1.42 Beta [Bld 227] - Source File unimon_8086_INTR.asm - Page 3 - 3/4/2023 17:5:23


  Code Pages:
  ----------

STANDARD (0 changed characters)

1 code page

0.03 seconds assembly time

   1738 lines source file
      3 passes
      0 errors
      0 warnings
